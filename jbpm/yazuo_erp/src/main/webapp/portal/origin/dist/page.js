//From origin\page\backend\customerservice\customer\customer.js
define('originpagebackendcustomerservicecustomercustomerjs',['avalon','util','moment','json','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs'],function(a,c){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(o,e,n){function p(e,f,g){var a=JSON.stringify(e);d.pageData=[],c.c2s({url:b.BASE_PATH+f,type:'post',contentType:'application/json',data:a,success:g});}function q(b){var a;b.flag&&(a=b.data,d.merchantData=a,console.log(a));}var i=e+'-add-Question-dialog',f=e+'-add-Question-form',j=e+'-schedule',h=e+'-active-select',g=e+'-active-form',k=e+'-active-dialog',l=e+'-active-uploader',m=b.getAppData('user'),d=a.define(e,function(e){e.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/study/coursemanage'},{text:'test'}],e.pageUserId=b.getAppData('user').id,e.merchantId=parseInt(n.params.id),e.createData={},e.options1=[],e.options2=[],e.stepData={},e.merchantData={},e.$addQuestionDialogOpts={dialogId:i,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f);b.reset(),b.title='',b.description='';},submit:function(l){var e,h=a.getVm(i),g=a.getVm(f);if(g.validate()){e=g.getFormData();var k=a.getVm(j).selectedValue;e.merchantId=d.merchantId,e.problemType=k,e.problemStatus=1,e=JSON.stringify(e),console.log(e),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:e,success:function(a){a.flag==1&&h.close();}});}}},e.openAdd=function(){var d=a.getVm(j);e.options1.length?d.setOptions(e.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,e.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),d.setOptions(e.options1));}});var g=a.getVm(i),h=a.getVm(f);g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},e.$addQuestionFormOpts={formId:f,field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},e.$scheduleOpts={selectId:j,options:[],selectedIndex:1},e.createActive=function(){var d=a.getVm(k),f=a.getVm(g),i=a.getVm(h);e.options2.length?i.setOptions(e.options2):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,e.options2=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),i.setOptions(e.options2));}}),d.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',f.activityTitle='',f.description='',d.open();},e.$activeUploaderOpts={uploaderId:l,uploadifyOpts:{uploader:b.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:m.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=JSON.parse(a),a.flag){var b=a.data;d.createData.$model.attachmentName=b.attachmentName,d.createData.$model.originalFileName=b.originalFileName,d.createData.$model.fileSize=b.fileSize;}}},e.$createActiveDialogOpts={dialogId:k,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(g);b.reset(),b.activityTitle='',b.description='';},submit:function(m){var f,j=a.getVm(k),i=a.getVm(g),l=a.getVm(h);if(i.validate()){f=i.getFormData(),d.createData.$model.merchantId=d.merchantId,d.createData.$model.activityTitle=f.activityTitle,d.createData.$model.description=f.description,d.createData.$model.activityType=l.selectedValue,d.createData.$model.attachmentId=0;var e=JSON.stringify(d.createData.$model);console.log(e),c.c2s({url:b.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:e,success:function(a){console.log(e),a.flag==1&&j.close();}});}}},e.$createActiveFormOpts={formId:g,field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},e.$activeOpts={selectId:h,options:[],selectedIndex:1};});a.scan(o[0]),p({merchantId:d.merchantId},'synMerchant/getMerchantInfoByOrder.do',q);},$remove:function(a,b){}}),d;});

//From origin\page\backend\customerservice\customerservice.js
define('originpagebackendcustomerservicecustomerservicejs',['avalon','util','originwidgetpaginationpaginationjs','originwidgetformselectjs'],function(avalon,util){var win=this,erp=win.erp,pageMod={},tempWidgetIdStore=[];return _.extend(pageMod,{$init:function(pageEl,pageName){function updateList(b,c,d){var a=JSON.stringify(b);pageVm.pageData=[],util.c2s({url:erp.BASE_PATH+c,type:'post',contentType:'application/json',data:a,success:d});}function merchantCallBack(responseData){responseData=eval(responseData);var data,paginationVm=avalon.getVm(getTypeId('paginationId'));responseData.flag&&(data=responseData.data,paginationVm.total=data.totalSize,pageVm.pageDataMerchant=data.rows);}function backlogCallBack(b){var a,c=avalon.getVm(getTypeId('paginationId'));b.flag&&(a=b.data,c.total=a.totalSize,pageVm.pageDataBacklog=a.rows);}function backlogCallBackValue(a){var b;a.flag&&(b=a.data,pageVm.dotolen=b.rows.length);}var getTypeId=function(b){var a=pageName+b;return tempWidgetIdStore.push(a),a;},pageVm=avalon.define(pageName,function(a){a.pageUserId=erp.getAppData('user').id,a.pageStatus=1,a.pageDataMerchant={},a.pageDataBacklog={},a.options1=[],a.dotolen=0,a.distributionFd={},a.backlog={userId:a.pageUserId,inputItemTypes:['01','02','04'],merchantName:'',pageNumber:1,pageSize:10,businessTypes:['9','10','11','3','7','12','13']},a.requestData={merchantStatus:'200',userId:'',pageSize:10,pageNumber:1,merchantName:'',merchantStatusType:0},a.localHref=function(a){util.jumpPage(a);},a.permission={end_attachment_mag:util.hasPermission('end_attachment_mag'),end_email_temp:util.hasPermission('end_email_temp'),end_complaint_mag:util.hasPermission('end_complaint_mag'),end_merchant_mag:util.hasPermission('end_merchant_mag'),end_custom_service_todolist:util.hasPermission('end_custom_service_todolist')},a.changePageStatus=function(b){var c=avalon.getVm(getTypeId('paginationId'));c.currentPage=1,a.pageStatus=b,b==1?(pageVm.requestData.merchantName='',pageVm.requestData.pageNumber=1,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack)):b==2&&(pageVm.backlog.merchantName='',pageVm.backlog.pageNumber=1,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack));},a.distributionFd={},a.distribution=function(){var b=avalon.getVm(getTypeId('distributionDialogId')),d=avalon.getVm(getTypeId('fdId')),c={remark:'end_custom_service'};c=JSON.stringify(c),this.$vmodel.$model.el.listAssistantUsers.length?a.distributionFd.$model.userId=this.$vmodel.$model.el.listAssistantUsers[0].id:a.distributionFd.$model.userId='',a.distributionFd.$model.merchantId=this.$vmodel.$model.el.merchantId,a.options1.length?(d.setOptions(a.options1),b.title='\u5206\u914D\u8D1F\u8D23\u4EBA',b.open()):util.c2s({url:erp.BASE_PATH+'user/getAllUsersByResourceCode.do',type:'post',contentType:'application/json',data:c,success:function(c){var e;c.flag&&(e=c.data,a.options1=_.map(e,function(a){return{text:a.userName,value:a.id};}),d.setOptions(a.options1),b.title='\u5206\u914D\u8D1F\u8D23\u4EBA',b.open());}});},a.$scheduleOpts={selectId:getTypeId('fdId'),options:[],selectedIndex:1},a.$distributionDialogOpts={dialogId:getTypeId('distributionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){},submit:function(d){var a=avalon.getVm(getTypeId('distributionDialogId')),b=avalon.getVm(getTypeId('fdId')),c;pageVm.distributionFd.$model.newUserId=b.selectedValue,c=JSON.stringify(pageVm.distributionFd.$model),util.c2s({url:erp.BASE_PATH+'fesOnlineProcess/saveSysAssistantMerchant.do',type:'post',contentType:'application/json',data:c,success:function(b){b.flag==1&&(a.close(),updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack));}});}},a.changeStatus=function(c){var b=avalon.getVm(getTypeId('paginationId'));b.currentPage=1,a.requestData.pageNumber=1,a.requestData.merchantStatus=c,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},a.search=function(){updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},a.showProgressTip=function(){var d=this.$vmodel.$model,e=d.el.stepText,b=pageName+'-progress-tip',f=$(this),a=$('#'+b),c=f.offset();a.length||(a=$('<div id="'+b+'" class="grid-tip"></div>'),a.html('<span class="text-content"></span><span class="icon-arrow"></span>'),a.hide().appendTo('body')),$('.text-content',a).text(e),a.css({top:c.top-a.height()-20,left:c.left-a.width()/2-11}).show();},a.hideProgressTip=function(){$('#'+pageName+'-progress-tip').hide();},a.backlogSearch=function(){var a=avalon.getVm(getTypeId('paginationId'));a.currentPage=1,pageVm.backlog.pageNumber=1,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack);},a.doToStatus=function(b){var a=avalon.getVm(getTypeId('paginationId'));a.currentPage=1,pageVm.backlog.pageNumber=1,pageVm.backlog.inputItemTypes=b,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack);},a.$paginationOpts={paginationId:getTypeId('paginationId'),total:0,onJump:function(b,c){var a=avalon.getVm(getTypeId('paginationId'));pageVm.pageStatus==0||pageVm.pageStatus==1?(pageVm.requestData.pageNumber=a.currentPage,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack)):pageVm.pageStatus==2&&(pageVm.backlog.pageNumber=a.currentPage,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack));}};});avalon.scan(pageEl[0]),updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBackValue),updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},$remove:function(a,b){_.each(tempWidgetIdStore,function(b){var a=avalon.getVm(b);a&&$(a.widgetElement).remove();}),tempWidgetIdStore.length=0;}}),pageMod;});

//From origin\page\backend\customerservice\linewaiting\linewaiting.js
define('originpagebackendcustomerservicelinewaitinglinewaitingjs',['avalon','util','moment','json','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs'],function(a,c){var f=this,b=f.erp,e={},d=[];return _.extend(e,{$init:function(k,j,l){function g(d,e,f){var a=JSON.stringify(d);c.c2s({url:b.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function m(h){var c;if(h.flag){c=h.data;var a={};a.productList=c.productList,a.userMerchantList=c.userMerchantList,a.filePath=c.filePath;var f=c.merchantInfo;for(var b in c){var d=c.hasOwnProperty(b);d&&typeof c[b]!='object'&&(a[b]=c[b]);}for(var b in f){var d=f.hasOwnProperty(b);d&&(a[b]=f[b]);}a.attachment_name?a.imgUrl=e.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=e.path+'portal/origin/asset/image/merchant-default-logo.jpg',e.merchantData=a;var j=i.id;if(a.userMerchantList)for(var g=0;g<a.userMerchantList.length;g++)if(j==a.userMerchantList[g].userId){e.promise=!0;return;}else e.promise=!1;}}function h(g){var a;if(g.flag){var a=g.data,c=[];for(var b=0;b<a.length;b++)if(a[b].fesStep.stepName=='\u8425\u9500\u6D3B\u52A8\u521B\u5EFA'){var d=a[b].fesMarketingActivitys;for(var f=0;f<d.length;f++)d[f].fesStep={stepName:'\u8425\u9500\u6D3B\u52A8\u521B\u5EFA'};c=d;}else c.push(a[b]);e.stepData=c;}}var f=function(b){var a=j+b;return d.push(a),a;},i=b.getAppData('user'),e=a.define(j,function(d){function j(c,f){var h=[];if(c instanceof Array)for(var d=0;d<c.length;d++){var e={};for(var b in c[d]){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}else{var e={};for(var b in c){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}return h;}d.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/backend/customerservice'},{text:'\u5F85\u529E\u4E8B\u9879'}],d.pageUserId=b.getAppData('user').id,d.merchantId=parseInt(l.params.id),d.pageStatus=1,d.path=b.BASE_PATH,d.merchantData={productList:[],filePath:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',online_time:'',format_name:'',attachment_name:'',attachment_path:''},d.stepData=[],d.changePageStatus=function(a,b){d.pageStatus=a,a==2&&d.cardFn();},d.responseCardData=[{card_count:0,card_price:0,card_type:'',merchant_type:'',is_sold_card:!1,merchant_name:'',merchant_id:0,cardtype_id:0,description:'',card_name:''}],d.cardFn=function(){c.c2s({url:b.BASE_PATH+'synMembershipCard/listSynMembershipCards.do',type:'post',data:{pageNumber:1,pageSize:10000,merchantId:e.merchantId},success:function(a){if(a.flag){var b=a.data.rows,c=['card_count','card_price','card_type','merchant_type','is_sold_card','merchant_name','cardtype_id','description','card_name'];e.responseCardData=j(b,c);}}});},d.options1=[],d.$addQuestionDialogOpts={dialogId:f('addQuestionDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('addQuestionForm'));b.reset(),b.title='',b.description='';},submit:function(j){var d,h=a.getVm(f('addQuestionDialog')),g=a.getVm(f('addQuestionForm'));if(g.validate()){d=g.getFormData();var i=a.getVm(f('addQuestionSelect')).selectedValue;d.merchantId=e.merchantId,d.problemType=i,d.problemStatus=1,d=JSON.stringify(d),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&h.close();}});}}},d.openAdd=function(){var e=a.getVm(f('addQuestionSelect'));d.options1.length?e.setOptions(d.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),e.setOptions(d.options1));}});var g=a.getVm(f('addQuestionDialog')),h=a.getVm(f('addQuestionForm'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},d.$addQuestionFormOpts={formId:f('addQuestionForm'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},d.$scheduleOpts={selectId:f('addQuestionSelect'),options:[],selectedIndex:1},d.accessSwitch=1,d.step9AccessId=0,d.acessRequestData={},d.accessSwitchFn=function(a){d.accessSwitch=a;},d.step9Access=function(h){var k=a.getVm(f('addAccessForm')),g=a.getVm(f('addAccessDialog')),j;if(h=='add'){d.step9AccessId=0;var i=JSON.stringify([{documentType:'2'},{documentType:'3'}]);j='sysQuestion/listMutiSysQuestions.do';}else if(h=='edit'){d.step9AccessId=1;var i=JSON.stringify({merchantId:e.merchantId});j='sysDocument/getSysDocumentByMerchantId.do';}c.c2s({url:b.BASE_PATH+j,type:'post',contentType:'application/json',data:i,success:function(c){function f(c){var d=[];for(var a=0;a<c.length;a++){var b={};b.optionContent=c[a].optionContent,b.isSelected=c[a].isSelected,b.isOpenTextarea=c[a].isOpenTextarea,b.tip=c[a].tip,b.isOpenTextarea=c[a].isOpenTextarea,c[a].comment?b.comment=c[a].comment:b.comment='',d.push(b);}return d;}function e(b){var d=[];for(var a=0;a<b.length;a++){var c={};c.questionId=b[a].id,c.questionType=b[a].question_type,c.title=b[a].title,c.tip=b[a].tip,b[a].comment?c.comment=b[a].comment:c.comment='',b[a].sysQuestionOptionList&&(c.sysDocumentDtlOptionList=f(b[a].sysQuestionOptionList)),d.push(c);}return d;}if(c.flag==1)if(h=='add'){var b=c.data,a={};a.data1=e(b[2]),a.data2=e(b[3]),d.acessRequestData=a,g.title='\u56DE\u8BBF\u5355',g.open();}else if(h=='edit'){var b=c.data,a={};a.data1=b[0].sysDocumentDtlList,a.data2=b[1].sysDocumentDtlList,d.acessRequestData=a,g.title='\u56DE\u8BBF\u5355',g.open();}}});},d.radioBox=function(c){var b=c.sysDocumentDtlOptionList;for(var a=0;a<b.length;a++)b[a].isSelected='0',b[a].comment='';this.$vmodel.$model.el.isSelected='1',$(this).closest('li').find('textarea').removeClass('valid-error-field'),$(this).closest('li').find('.ff-value-tip').hide();},d.checkBox=function(){var a=this.$vmodel.$model.el;a.isSelected=='1'?a.isSelected='0':a.isSelected='1';},d.$addAccessDialogOpts={dialogId:f('addAccessDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="close">\u5173&nbsp;\u95ED</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},width:660,readonly:!1,onOpen:function(){},onClose:function(){var b=a.getVm(f('addAccessForm'));b.reset();},submit:function(n){var k=a.getVm(f('addAccessDialog')),l=a.getVm(f('addAccessForm')),d=[],i={},j={},m;l.testVal()&&(m='sysDocument/saveDocumentAndUpdateStatusAfterStep10.do',i.documentType=2,i.merchantId=e.merchantId,j.documentType=3,j.merchantId=e.merchantId,i.sysDocumentDtlList=e.acessRequestData.data1.$model,j.sysDocumentDtlList=e.acessRequestData.data2.$model,d.push(i),d.push(j),d=JSON.stringify(d),c.c2s({url:b.BASE_PATH+m,type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&(k.close(),g({merchantId:e.merchantId},'fesOnlineProcess/listFesOnlineProcesssAfterOnline.do',h));}}));}},d.$addAccessFormOpts={formId:f('addAccessForm'),testVal:function(){var d=!0,h=a.getVm(f('addAccessForm')),i=h.widgetElement,e=$('.questions',$(i));for(var c=0;c<e.length;c++){var b=$(e[c]);if(!_.str.trim(b.val())){b.blur(function(){var b=_.str.trim($(this).val());if(!b){$(this).addClass('valid-error-field');var a=$(this).next('.ff-value-tip');a?a.addClass('valid-error').html('\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01').show():$(this).parent().append("<div class='ff-value-tip valid-error'>\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A</div>");}else $(this).removeClass('valid-error-field'),$(this).next('.ff-value-tip').hide();}),b.addClass('valid-error-field');var g=b.next('.ff-value-tip');g?g.addClass('valid-error').html('\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01').show():b.parent().append("<div class='ff-value-tip valid-error'>\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A</div>"),d=!1;}}return d;},questions:''},d.$step9AttachUploaderOpts={uploaderId:f('lineAttachUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'sysDocument/uploadRecordAndSaveSysDocumentAfterOnline.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:i.sessionId,inputSysDocuments:JSON.stringify([{merchantId:e.merchantId,documentType:2},{merchantId:e.merchantId,documentType:3}])};},width:110,height:30},onSuccessResponseData:function(a,b){a=JSON.parse(a),a.flag&&g({merchantId:e.merchantId},'fesOnlineProcess/listFesOnlineProcesssAfterOnline.do',h);}},d.disposeOpen=function(){c.confirm({content:'\u4F60\u786E\u8BA4\u5DF2\u7ECF\u56DE\u8BBF\u4E86\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'sysDocument/closeToDoListsAfterViste.do',type:'post',data:{merchantId:e.merchantId},success:function(a){a.flag&&g({merchantId:e.merchantId},'fesOnlineProcess/listFesOnlineProcesssAfterOnline.do',h);}});}});},d.activeReqData={activityId:'',status:'',reason:''},d.activeSelect=function(d,j){if(d=='2'){var k='\u60A8\u786E\u5B9A\u6D3B\u52A8\u7533\u8BF7\u5DF2\u7ECF\u521B\u5EFA\u4E86\u5417\uFF1F';c.confirm({content:k,onSubmit:function(){c.c2s({url:b.BASE_PATH+'activity/updateActivityStatus.do',type:'post',data:{activityId:j,status:d},success:function(a){a.flag&&g({merchantId:e.merchantId},'fesOnlineProcess/listFesOnlineProcesssAfterOnline.do',h);}});}});}else if(d=='3'){e.activeReqData.activityId=j,e.activeReqData.status=d;var i=a.getVm(f('activeDialogId'));i.title='\u5173\u95ED\u7533\u8BF7',i.open();}},d.$activeDisposeOpts={dialogId:f('activeDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){var b=a.getVm(f('activeform'));b.reason='';},submit:function(k){var j=a.getVm(f('activeDialogId')),i=a.getVm(f('activeform'));if(i.validate()){var d=e.activeReqData.$model;c.c2s({url:b.BASE_PATH+'activity/updateActivityStatus.do',type:'post',data:{activityId:d.activityId,status:d.status,reason:d.reason},success:function(a){a.flag==1&&(j.close(),i.reason='',g({merchantId:e.merchantId},'fesOnlineProcess/listFesOnlineProcesssAfterOnline.do',h));}});}}},d.$activeformOpts={formId:f('activeform'),field:[{selector:'.reason',name:'reason',rule:['noempty',function(a,b){return a.length>250?'\u5185\u5BB9\u4E0D\u80FD\u8D85\u8FC7250\u4E2A\u5B57\uFF01':b[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]};});a.scan(k[0]),g({merchantId:e.merchantId},'synMerchant/getMerchantInfoByOrder.do',m),g({merchantId:e.merchantId},'fesOnlineProcess/listFesOnlineProcesssAfterOnline.do',h);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\backend\customerservice\waiting\waiting.js
define('originpagebackendcustomerservicewaitingwaitingjs',['avalon','util','moment','json','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs'],function(a,b){var f=this,c=f.erp,e={},d=[];return _.extend(e,{$init:function(k,j,l){function h(d,e,f){var a=JSON.stringify(d);b.c2s({url:c.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function m(e){var b;if(e.flag){b=e.data;var a={};a.productList=b.productList,a.filePath=b.filePath;var c=b.merchantInfo;for(var d in c){var g=c.hasOwnProperty(d);g&&(a[d]=c[d]);}a.attachment_name?a.imgUrl=f.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=f.path+'portal/origin/asset/image/merchant-default-logo.jpg',f.merchantData=a,f.navCrumbs[1].text=a.merchant_name;}}function i(h){var c,g=a.getVm(e('step63Uploder'));if(h.flag){g&&$(g.widgetElement).remove(),c=h.data;var d=[];for(var b=0;b<c.length;b++)c[b].stepNum=='micro_message'&&d.push(c[b]),c[b].stepNum=='final_program'&&d.push(c[b]),c[b].stepNum=='entity_cards'&&d.push(c[b]),c[b].stepNum=='background_set'&&d.push(c[b]),c[b].stepNum=='train'&&d.push(c[b]);f.pageData=d;}}var e=function(b){var a=j+b;return d.push(a),a;},g=c.getAppData('user'),f=a.define(j,function(d){function p(b){for(var a=0;a<d.pageData.length;a++)if(d.pageData[a].stepNum==b)return d.pageData[a].id;}d.navCrumbs=[{text:'\u540E\u7AEF\u5BA2\u670D',href:'#/backend/customerservice'},{text:'test'}],d.path=c.BASE_PATH,d.pageUserId=c.getAppData('user').id,d.merchantId=parseInt(l.params.id),d.pageData={};var j=function(){d.merchantData={productList:[],filePath:'',merchant_id:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',format_name:'',attachment_name:'',attachment_path:''};};j();var k=function(){d.options1=[],d.$addQuestionDialogOpts={dialogId:e('addQuestionDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('addQuestionForm'));b.reset(),b.title='',b.description='';},submit:function(j){var d,h=a.getVm(e('addQuestionDialog')),g=a.getVm(e('addQuestionForm'));if(g.validate()){d=g.getFormData();var i=a.getVm(e('addQuestionSelect')).selectedValue;d.merchantId=f.merchantId,d.problemType=i,d.problemStatus=1,d=JSON.stringify(d),b.c2s({url:c.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&h.close();}});}}},d.openAdd=function(){var f=a.getVm(e('addQuestionSelect'));d.options1.length?f.setOptions(d.options1):b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),f.setOptions(d.options1));}});var g=a.getVm(e('addQuestionDialog')),h=a.getVm(e('addQuestionForm'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},d.$addQuestionFormOpts={formId:e('addQuestionForm'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},d.$scheduleOpts={selectId:e('addQuestionSelect'),options:[],selectedIndex:1};};k(),d.removeAttach=function(a,d){b.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u6587\u6863\u5417\uFF1F',onSubmit:function(){b.c2s({url:c.BASE_PATH+'fesOnlineProcess/deleteAttachment/'+a+'/'+d+'.do',type:'get',success:function(a){a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}});}});};var m=function(){d.removeWeixin=function(e,j){var a={id:j,processId:e,merchantId:f.merchantId},d=JSON.stringify(a);b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u5FAE\u4FE1\u7533\u8BF7\u5417\uFF1F',onSubmit:function(){b.c2s({url:c.BASE_PATH+'applySetting/deleteRemark.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}});}});},d.addWeixin=function(){var b=a.getVm(e('addWeixinDialog'));b.weixinId=this.$vmodel.$model.el.id,b.title='\u5907\u6CE8',b.open();},d.$addWeixinDialogOpts={dialogId:e('addWeixinDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('addWeixinForm'));b.reset();},submit:function(m){var d=a.getVm(e('addWeixinForm')),k=a.getVm(e('addWeixinDialog'));if(d.validate()){d.description.length>250&&b.confirm({content:'\u5185\u5BB9\u4E0D\u80FD\u8D85\u8FC7250\u4E2A\u5B57\uFF01'});var j=d.getFormData();j.processId=k.weixinId,j.merchantId=f.merchantId;var l=JSON.stringify(j);b.c2s({url:c.BASE_PATH+'applySetting/addRemark.do',type:'post',contentType:'application/json',data:l,success:function(a){a.flag==1&&(k.close(),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i));}});}}},d.$addWeixinFormOpts={formId:e('addWeixinForm'),field:[{selector:'.description',name:'remark',rule:['noempty',function(a,b){return a.length>250?'\u5185\u5BB9\u4E0D\u80FD\u8D85\u8FC7250\u4E2A\u5B57\uFF01':b[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],description:''};};m(),d.addAfter=function(){var b=a.getVm(e('addAfterDialog'));b.id=this.$vmodel.$model.el.id,b.title='\u66F4\u65B0\u72B6\u6001',b.open();},d.removeAfter=function(e,j){var a={id:j,processId:e,merchantId:f.merchantId},d=JSON.stringify(a);b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u540E\u53F0\u8BBE\u7F6E\u5417\uFF1F',onSubmit:function(){b.c2s({url:c.BASE_PATH+'fesOnlineProcess/deleteBackGroundContent.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}});}});},d.$addSetDialogOpts={dialogId:e('addAfterDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('addAfterFormlog'));b.reset();},submit:function(m){var j=a.getVm(e('addAfterFormlog')),k=a.getVm(e('addAfterDialog'));if(j.validate()){j.description.length>250&&b.confirm({content:'\u5185\u5BB9\u4E0D\u80FD\u8D85\u8FC7250\u4E2A\u5B57\uFF01'});var d=j.getFormData();d.id=k.id,d.merchantId=f.merchantId,d.onlineProcessStatus='03';var l=JSON.stringify(d);b.c2s({url:c.BASE_PATH+'fesOnlineProcess/saveBackGroundContent.do',type:'post',contentType:'application/json',data:l,success:function(a){a.flag==1&&(k.close(),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i));}});}}},d.$addSetFormOpts={formId:e('addAfterFormlog'),field:[{selector:'.set-description',name:'remark',rule:['noempty',function(a,b){return a.length>250?'\u5185\u5BB9\u4E0D\u80FD\u8D85\u8FC7250\u4E2A\u5B57\uFF01':b[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],description:''},d.$step63UploaderOpts={uploaderId:e('step63Uploder'),uploadifyOpts:{uploader:c.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:g.sessionId,processId:p('entity_cards'),typeId:12};},width:120,height:30,progressData:'speed'},onSuccessResponseData:function(a,b){a=JSON.parse(a),a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}};var n=function(){d.carRequestData={processId:0,merchantId:d.merchantId,fesOpenCardApplicationDtls:[{cardName:'',cardAmount:'',validityTerm:1,isContainFour:'0',isContainSeven:'0'}]},d.openCard=function(c){var b=a.getVm(e('cardDialog'));b.title='\u5F00\u5361\u7533\u8BF7',d.carRequestData.processId=c,b.open();},d.changeRedio4=function(a){this.$vmodel.$model.el.isContainFour=a;},d.changeRedio7=function(a){this.$vmodel.$model.el.isContainSeven=a;},d.$addCardDialogOpts={dialogId:e('cardDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button ms-if="save" type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},save:1,width:530,onClose:function(){var b=a.getVm(e('cardForm'));b.reset(),b.cardName='',b.cardAmount='',b.validityTerm='';},submit:function(n){var k,l=a.getVm(e('cardDialog')),m=a.getVm(e('cardForm'));if(m.validate()){var j=f.carRequestData.$model.fesOpenCardApplicationDtls;for(var d=0;d<j.length;d++)j[d].cardAmount=Number(j[d].cardAmount),j[d].validityTerm=Number(j[d].validityTerm);k=JSON.stringify(f.carRequestData.$model),b.c2s({url:c.BASE_PATH+'applySetting/saveOpenCardApply.do',type:'post',contentType:'application/json',data:k,success:function(a){a.flag==1&&(l.close(),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i));}});}}},d.$addCardFormOpts={formId:e('cardForm'),field:[{selector:'.cardName',rule:['noempty',function(b,a){return a[0]!==!0?'\u5361\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.cardAmount',rule:['noempty',function(b,c){if(c[0]!==!0)return'\u5F00\u5361\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A';else{var a=/^[0-9]\d*$/;return a.test(b)?!0:'\u5F00\u5361\u6570\u91CF\u5FC5\u987B\u4E3A\u6570\u5B57';}}]}],cardName:'',cardAmount:'',validityTerm:''},d.readCard=function(g){b.c2s({url:c.BASE_PATH+'fesOnlineProcess/getFesOpenCardApplicationsAndDtls.do',type:'post',contentType:'application/json',data:JSON.stringify({processId:g}),success:function(b){if(b.flag==1){f.carRequestData=b.data[0];var c=a.getVm(e('cardDialog'));c.save=0,d.openCard();}}});},d.addCarList=function(){var a={cardName:'',cardAmount:'',validityTerm:1,isContainFour:0,isContainSeven:'0'};d.carRequestData.fesOpenCardApplicationDtls.push(a);},d.removeCarList=function(){d.carRequestData.fesOpenCardApplicationDtls.pop();};};n();var o=function(){d.step9AccessId=0,d.acessRequestData=[],d.step9Access=function(g,j,k){var l=a.getVm(e('addAccessForm')),f=a.getVm(e('addAccessDialog')),i;if(g=='add'){d.step9AccessId=0;var h=JSON.stringify({documentType:'1'});i='sysQuestion/listSysQuestions.do';}else if(g=='edit'){d.step9AccessId=j;var h=JSON.stringify({id:j});i='sysDocument/querySysDocumentById.do';}b.c2s({url:c.BASE_PATH+i,type:'post',contentType:'application/json',data:h,success:function(c){function h(c){var d=[];for(var a=0;a<c.length;a++){var b={};b.optionContent=c[a].optionContent,b.isSelected=c[a].isSelected,b.isOpenTextarea=c[a].isOpenTextarea,b.tip=c[a].tip,b.isOpenTextarea=c[a].isOpenTextarea,c[a].comment?b.comment=c[a].comment:b.comment='',d.push(b);}return d;}function i(b){var d=[];for(var a=0;a<b.length;a++){var c={};c.questionId=b[a].id,c.questionType=b[a].question_type,c.title=b[a].title,c.tip=b[a].tip,b[a].comment?c.comment=b[a].comment:c.comment='',b[a].sysQuestionOptionList&&(c.sysDocumentDtlOptionList=h(b[a].sysQuestionOptionList)),d.push(c);}return d;}function j(){var c=a.getVm(e('addAccessDialog')),d=a.getVm(e('addAccessForm'));c.readonly=!0;var b=d.widgetElement,f=$('input',$(b)).attr('disabled','disabled'),g=$('textarea',$(b)).attr('disabled','disabled');}if(c.flag==1)if(g=='add'){var b=c.data;b=i(b),d.acessRequestData=b,f.title='\u56DE\u8BBF\u5355',f.open();}else if(g=='edit'){var b=c.data.sysDocumentDtlList;d.acessRequestData=b,f.title='\u56DE\u8BBF\u5355',k=='04'&&j(),f.open();}}});},d.radioBox=function(c){var b=c.sysDocumentDtlOptionList;for(var a=0;a<b.length;a++)b[a].isSelected='0',b[a].comment='';this.$vmodel.$model.el.isSelected='1',$(this).closest('li').find('textarea').removeClass('valid-error-field'),$(this).closest('li').find('.ff-value-tip').hide();var d=this.name,e=this.$vmodel.$model.el.optionContent;},d.checkBox=function(){var a=this.$vmodel.$model.el;a.isSelected=='1'?a.isSelected='0':a.isSelected='1';},d.$addAccessDialogOpts={dialogId:e('addAccessDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="close">\u5173&nbsp;\u95ED</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},width:600,readonly:!1,onOpen:function(){},onClose:function(){var b=a.getVm(e('addAccessDialog')),c=a.getVm(e('addAccessForm'));c.reset(),b.readonly=!1;},submit:function(m){var j=a.getVm(e('addAccessDialog')),l=a.getVm(e('addAccessForm')),d={},k;l.testVal()&&(f.step9AccessId?(d.id=f.step9AccessId,k='sysDocument/saveDocumentAndUpdateStatusForStep9.do'):k='sysDocument/saveDocumentAndUpdateStatusForStep9.do',d.documentType=1,d.merchantId=f.merchantId,d.sysDocumentDtlList=f.acessRequestData.$model,d=JSON.stringify(d),b.c2s({url:c.BASE_PATH+k,type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&(j.close(),j.readonly=!1,h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i));}}));}},d.$addAccessFormOpts={formId:e('addAccessForm'),testVal:function(){var d=!0,h=a.getVm(e('addAccessForm')),i=h.widgetElement,f=$('.questions',$(i));for(var c=0;c<f.length;c++){var b=$(f[c]);if(!_.str.trim(b.val())){b.blur(function(){var b=_.str.trim($(this).val());if(!b){$(this).addClass('valid-error-field');var a=$(this).next('.ff-value-tip');a?a.addClass('valid-error').html('\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01').show():$(this).parent().append("<div class='ff-value-tip valid-error'>\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A</div>");}else $(this).removeClass('valid-error-field'),$(this).next('.ff-value-tip').hide();}),b.addClass('valid-error-field');var g=b.next('.ff-value-tip');g?g.addClass('valid-error').html('\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01').show():b.parent().append("<div class='ff-value-tip valid-error'>\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A</div>"),d=!1;}}return d;},questions:''};};o(),d.$step9AttachUploaderOpts={uploaderId:e('attachUploaderId'),uploadifyOpts:{uploader:c.BASE_PATH+'sysDocument/uploadRecordAndSaveSysDocumentForStep9.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:g.sessionId,inputSysDocument:JSON.stringify({merchantId:f.merchantId,documentType:1})};},width:110,height:30},onSuccessResponseData:function(a,b){a=JSON.parse(a),a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}},d.stepEnd=function(g,a,h,i){var e={id:g,onlineProcessStatus:a},f=JSON.stringify(e);b.confirm({content:h,onSubmit:function(){b.c2s({url:c.BASE_PATH+'fesOnlineProcess/updateFesOnlineProcessStatus.do',type:'post',contentType:'application/json',data:f,success:function(c){if(c.flag)for(var b=0;b<d.pageData.length;b++)d.pageData[b].stepNum==i&&(d.pageData[b].onlineProcessStatus=a,d.pageData[b].listAttachmentAndOperateLog.push(c.data));}});}});};});a.scan(k[0]),h({merchantId:f.merchantId},'synMerchant/getMerchantInfoByOrder.do',m),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',i);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\backend\distribution\distribution.js
define('originpagebackenddistributiondistributionjs',['avalon','util','originwidgetpaginationpaginationjs'],function(a,f){var e=this,c=e.erp,d={},b=[];return _.extend(d,{$init:function(j,i){function g(b,e,g){var a=JSON.stringify(b);d.pageData=[],f.c2s({url:c.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:g});}function h(c){var b,f=a.getVm(e('paginationId'));c.flag&&(b=c.data,f.total=b.totalSize,d.pageData=b.rows,d.backlog.merchantName='');}var e=function(c){var a=i+c;return b.push(a),a;},d=a.define(i,function(b){b.pageUserId=c.getAppData('user').id,b.logItemStatus='01',b.pageData={},b.backlog={userId:b.pageUserId,inputItemTypes:['01'],merchantName:'',pageNumber:1,pageSize:10,businessTypes:['8']},b.changeStatus=function(a){b.backlog.inputItemTypes=a,g(d.backlog.$model,'myHomePage/getComplexSysToDoLists.do',h);},b.$paginationOpts={paginationId:e('paginationId'),total:0,onJump:function(c,f){var b=a.getVm(e('paginationId'));d.backlog.pageNumber=b.currentPage,g(d.backlog.$model,'myHomePage/getComplexSysToDoLists.do',h);}};});a.scan(j[0]),g(d.backlog.$model,'myHomePage/getComplexSysToDoLists.do',h);},$remove:function(c,d){_.each(b,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),b.length=0;}}),d;});

//From origin\page\backend\distribution\waiting\waiting.js
define('originpagebackenddistributionwaitingwaitingjs',['avalon','util','moment','json','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs'],function(a,c){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(i,f,j){function g(d,e,f){var a=JSON.stringify(d);c.c2s({url:b.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function k(f){var b;if(f.flag){b=f.data;var a={};a.productList=b.productList,a.filePath=b.filePath;var c=b.merchantInfo;for(var d in c){var g=c.hasOwnProperty(d);g&&(a[d]=c[d]);}a.attachment_name?a.imgUrl=e.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=e.path+'portal/origin/asset/image/merchant-default-logo.jpg',e.merchantData=a,e.navCrumbs[1].text=a.merchant_name;}}function l(d){var b;if(d.flag){b=d.data;var c=[];for(var a=0;a<b.length;a++)b[a].stepNum=='equipment_distribution'&&c.push(b[a]);e.pageData=c;}}var d=function(a){return b.arr||(b.arr=[]),b.arr.push(f+a),f+a;},h=b.getAppData('user'),e=a.define(f,function(f){f.navCrumbs=[{text:'\u8BBE\u5907\u914D\u9001',href:'#/backend/distribution'},{text:'test'}],f.path=b.BASE_PATH,f.pageUserId=b.getAppData('user').id,f.merchantId=parseInt(j.params.id),f.pageData={},f.imgUrl='';var g=function(){f.merchantData={productList:[],filePath:'',merchant_id:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',format_name:'',attachment_name:'',attachment_path:'',imgUrl:''};};g();var h=function(){f.options1=[],f.$addQuestionDialogOpts={dialogId:d('addQuestionDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(d('addQuestionForm'));b.reset(),b.title='',b.description='';},submit:function(j){var f,h=a.getVm(d('addQuestionDialog')),g=a.getVm(d('addQuestionForm'));if(g.validate()){f=g.getFormData();var i=a.getVm(d('addQuestionSelect')).selectedValue;f.merchantId=e.merchantId,f.problemType=i,f.problemStatus=1,f=JSON.stringify(f),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:f,success:function(a){a.flag==1&&h.close();}});}}},f.openAdd=function(){var e=a.getVm(d('addQuestionSelect'));f.options1.length?e.setOptions(f.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,f.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),e.setOptions(f.options1));}});var g=a.getVm(d('addQuestionDialog')),h=a.getVm(d('addQuestionForm'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},f.$addQuestionFormOpts={formId:d('addQuestionForm'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},f.$scheduleOpts={selectId:d('addQuestionSelect'),options:[],selectedIndex:1};};h(),f.stepEnd=function(g,a,h,i){var d={id:g,onlineProcessStatus:a},e=JSON.stringify(d);c.confirm({content:h,onSubmit:function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/updateFesOnlineProcessStatus.do',type:'post',contentType:'application/json',data:e,success:function(c){if(c.flag)for(var b=0;b<f.pageData.length;b++)f.pageData[b].stepNum==i&&(f.pageData[b].onlineProcessStatus=a,f.pageData[b].listAttachmentAndOperateLog.push(c.data));}});}});};var i=function(){function h(c,d){var e=[];for(var a=0,f=d[c].length;a<f;a++){var b={};b.text=d[c][a].dictionary_value,b.value=d[c][a].dictionary_key,e.push(b);}return e;}f.step8DistriRequestData={processId:198,logisticsCompany:'',logisticsNum:'',contactId:1,fesStowageDtls:[{category:'',amount:1,unitType:''}]};var g={};f.step8Index=-1,f.addCardModel=function(){var b=++f.step8Index,c='<div class="step8-model tep{replace}" ms-controller="model{replace}"><div class="ff-value"><div class="ff-value-box"><span class="schedule card-type" ms-widget="select,$,$selectTypeOpts{replace}"></span><input class="input-text card-number amount2" name="amount2" ms-duplex="amount"><span class="schedule card-unit" ms-widget="select,$,$selectUnitOpts{replace}"></span><span class="card-remove" ms-click="removeCarModel({replace})">-</span></div><div class="ff-value-tip"></div></div></div>';c=c.replace(/{replace}/g,b),$('.step8-dom-parent').eq(0).append(c),g[b]=a.define('model'+b,function(a){a.amount=1,a['$selectTypeOpts'+b]={selectId:d('selectTypeId'+b),options:e.selectType,selectedIndex:0},a['$selectUnitOpts'+b]={selectId:d('selectUnitId'+b),options:e.selectUnit,selectedIndex:0};}),a.scan($('.step8-dom-parent').eq(0)[0],[f]);},f.removeCarModel=function(b){var c=a.getVm(d('selectTypeId'+b)),e=a.getVm(d('selectUnitId'+b));$(c.widgetElement).remove(),$(e.widgetElement).remove(),$('.tep'+b)[0].remove(),delete g[b];},f.step8Distri=function(j){var e=a.getVm(d('step8DistriDialog'));e.processId=j;var g=['00000045','00000083'];g=JSON.stringify(g),c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByTypeList.do',type:'post',contentType:'application/json',data:g,success:function(e){var c;if(e.flag){c=e.data;for(var b in c)b=='00000045'?(f.selectType=h(b,c),a.getVm(d('selectTypeId')).setOptions(f.selectType)):b=='00000083'&&(f.selectUnit=h(b,c),a.getVm(d('selectUnitId')).setOptions(f.selectUnit));}}});var i=JSON.stringify({merchantId:f.merchantId});c.c2s({url:b.BASE_PATH+'contact/queryContact.do',type:'post',contentType:'application/json',data:i,success:function(h){if(h.flag){var c=h.data,g=[];for(var b=0;b<c.length;b++){var f={};f.value=c[b].id,f.text=c[b].name,g.push(f);}a.getVm(d('selectMessId')).setOptions(g),e.title='\u786E\u8BA4\u8BBE\u5907\u914D\u9001',e.open();}}});},f.$addDistriDialogOpts={dialogId:d('step8DistriDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},width:500,onClose:function(){var b=a.getVm(d('step8DistriForm'));b.reset(),b.logisticsNum='',b.logisticsCompany='';},submit:function(p){var j=a.getVm(d('step8DistriDialog')),l=a.getVm(d('step8DistriForm')),m=a.getVm(d('selectTypeId')),n=a.getVm(d('selectUnitId')),o=a.getVm(d('selectMessId'));if(l.validate()){e.step8DistriRequestData.$model.processId=j.processId,e.step8DistriRequestData.$model.contactId=o.selectedValue,e.step8DistriRequestData.$model.fesStowageDtls[0].category=m.selectedValue,e.step8DistriRequestData.$model.fesStowageDtls[0].unitType=n.selectedValue;for(var h in g){var i={};console.log(a.getVm(d('selectTypeId'+h))),i.category=a.getVm(d('selectTypeId'+h)).selectedValue,i.unitType=a.getVm(d('selectUnitId'+h)).selectedValue,i.amount=parseInt(g[h].amount),e.step8DistriRequestData.$model.fesStowageDtls.push(i);}var k=JSON.stringify(e.step8DistriRequestData.$model);c.c2s({url:b.BASE_PATH+'applySetting/saveFesStowage.do',type:'post',contentType:'application/json',data:k,success:function(b){if(console.log(k),b.flag==1){j.close();for(var a=0;a<f.pageData.length;a++)f.pageData[a].stepNum=='equipment_distribution'&&(f.pageData[a].onlineProcessStatus='04',f.pageData[a].listAttachmentAndOperateLog.push(b.data));}}});}}},f.$addDistriFormOpts={formId:d('step8DistriForm'),field:[{selector:'.logisticsNum',rule:['noempty',function(b,a){return a[0]!==!0?'\u5FEB\u70B9\u5355\u53F7\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.logisticsCompany',rule:['noempty',function(b,a){return a[0]!==!0?'\u7269\u6D41\u516C\u53F8\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.amount',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BBE\u5907\u4E2A\u6570\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],logisticsNum:'',logisticsCompany:'',amount:''},f.$selectTypeOpts={selectId:d('selectTypeId'),options:[],selectedIndex:0},f.$selectUnitOpts={selectId:d('selectUnitId'),options:[],selectedIndex:0},f.$selectMessOpts={selectId:d('selectMessId'),options:[{text:'X\u5C55\u67B6',value:7}],selectedIndex:0};};i();});a.scan(i[0]),g({merchantId:e.merchantId},'synMerchant/getMerchantInfoByOrder.do',k),g({merchantId:e.merchantId,userId:h.id,resourceRemark:'end_delivery_service'},'fesOnlineProcess/listFesOnlineProcesss.do',l);},$remove:function(e,f){for(var c=0;c<b.arr.length;c++){var d=a.getVm(b.arr[c]);d&&$(d.widgetElement).remove();}b.arr.length=0;}}),d;});

//From origin\page\backend\home\home.js
define('originpagebackendhomehomejs',['avalon','util','json','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetgridgridjs'],function(a,e,g){var f=this,c=f.erp,d={},b=[];return _.extend(d,{$init:function(g,f){var d=function(c){var a=f+c;return b.push(a),a;},h=a.define(f,function(b){b.pageUserId=c.getAppData('user').id,b.pageStatus=1,b.localHref=function(a){e.jumpPage(a);},b.permission={},b.changePageStatus=function(c){b.pageStatus=c,c==1?a.getVm(d('-tabs1-grid')).load():c==2||c==3;},b.$gridTab1Opts={gridId:d('-tabs1-grid'),disableCheckAll:!1,disableCheckbox:!1,getTemplate:function(d){var a=d.split('MS_OPTION_TBAR'),b=a[1].split('MS_OPTION_MAIN')[0],c='<div class="ui-grid-bbar fn-clear"><div class="grid-action fn-left"><button type="button" class="check-all-btn main-btn" ms-click="scCheckAll">\u5168\u9009</button>&nbsp;<button type="button" class="batch-remove-btn main-btn">\u6279\u91CF\u6307\u6D3E</button></div><div class="pagination fn-right" ms-widget="pagination,$,$paginationOpts"></div></div>';return'<div class="ui-grid-search"><input type="text" class="input-text" placeholder="\u9700\u6C42\u6807\u9898"><button type="button" class="query-btn main-btn" ms-click="search">\u641C\u7D22</button></div>MS_OPTION_TBAR'+b+c;},columns:[{dataIndex:'course_name',text:'\u5168\u90E8',html:!0,hideable:!1,renderer:function(){},headerWidget:{type:'select',widgetConfig:{selectId:'test1',options:[]}}},{dataIndex:'time_limit',text:'\u9700\u6C42\u6807\u9898'},{dataIndex:'time_limit',text:'\u5168\u90E8\u7C7B\u578B',html:!0,hideable:!1,headerWidget:{type:'select',widgetConfig:{selectId:'test2',options:[]}}},{dataIndex:'operation',text:'\u6765\u6E90'},{dataIndex:'operation',text:'\u64CD\u4F5C'}],onLoad:function(a,b){e.c2s({url:c.BASE_PATH+'course/getCourseInfo.do',data:a,success:function(a){var c;a.flag&&(c=a.data,b.call(this,c));}});}};});a.scan(g[0]),a.getVm(d('-tabs1-grid')).load(),function(){alert(1);}();},$remove:function(c,d){_.each(b,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),b.length=0;}}),d;});

//From origin\page\backend\monthlycheck\monthlycheck.js
define('originpagebackendmonthlycheckmonthlycheckjs',['avalon','util','json','moment','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetgridgridjs'],function(a,d,f,h){var g=this,b=g.erp,e={},c=[];return _.extend(e,{$init:function(m,k){var e=function(b){var a=k+b;return c.push(a),a;},l=a.define(k,function(c){c.permission={},c.pageUserId=b.getAppData('user').id,c.$yearSelectOpts={selectId:e('-year'),options:[{value:'2014',text:'2014\u5E74'},{value:'2015',text:'2015\u5E74'}]},c.$monthSelectOpts={selectId:e('-month'),options:[{value:'01',text:'1\u6708\u6708\u62A5'},{value:'02',text:'2\u6708\u6708\u62A5'},{value:'03',text:'3\u6708\u6708\u62A5'},{value:'04',text:'4\u6708\u6708\u62A5'},{value:'05',text:'5\u6708\u6708\u62A5'},{value:'06',text:'6\u6708\u6708\u62A5'},{value:'07',text:'7\u6708\u6708\u62A5'},{value:'08',text:'8\u6708\u6708\u62A5'},{value:'09',text:'9\u6708\u6708\u62A5'},{value:'10',text:'10\u6708\u6708\u62A5'},{value:'11',text:'11\u6708\u6708\u62A5'},{value:'12',text:'12\u6708\u6708\u62A5'}]},c.$fdSelectOpts={selectId:e('-fd'),options:[{value:0,text:'\u5168\u90E8\u524D\u7AEF'}]},c.$checkSelectOpts={selectId:e('-check'),options:[{value:'',text:'\u5168\u90E8\u5546\u6237'},{value:'1',text:'\u660E\u5929\u8981\u8BB2\u89E3\u6708\u62A5'}],selectedIndex:1},c.$statusSelectOpts={selectId:e('-status'),options:[{value:'',text:'\u5168\u90E8\u72B6\u6001'}]},c.keyword='',c.search=function(){a.getVm(e('-grid')).load();},d.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000101',success:function(c){var d,f=a.getVm(e('-status'));if(c.flag){d=c.data;var b=_.map(d,function(a){return{text:a.dictionary_value,value:a.dictionary_key};});b.unshift({value:'',text:'\u5168\u90E8\u72B6\u6001'}),f.setOptions(b);}}}),d.c2s({url:b.BASE_PATH+'user/getAllUsersByResourceCode.do',contentType:'application/json',type:'post',data:f.stringify({remark:'fes_my_main_page'}),success:function(c){var d,f=a.getVm(e('-fd'));if(c.flag){d=c.data;var b=_.map(d,function(a){return{text:a.userName,value:a.id};});b.unshift({value:0,text:'\u5168\u90E8\u524D\u7AEF'}),f.setOptions(b);}}}),c.keyword='',c.$gridOpts={gridId:e('-grid'),disableCheckAll:!0,disableCheckbox:!0,getTemplate:function(b){var a=b.split('MS_OPTION_TBAR');return'<div class="ui-grid-tbar fn-clear"><div class="fn-left">\u5171<span class="num">{{gridTotalSize}}</span>\u4E2A\u5546\u6237</div></div>MS_OPTION_TBAR'+a[1];},columns:[{dataIndex:'merchant_name',text:'\u5546\u6237',html:!0,renderer:function(a,b){return'<div style="text-align: left">{{$outer.el.merchant_name}}</div>';}},{dataIndex:'front_user_name',text:'\u524D\u7AEF'},{dataIndex:'open_number',text:'\u5F00\u53F0\u6570',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.open_number == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.open_number == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'job_overview',text:'\u5DE5\u4F5C\u6982\u8FF0',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.job_overview == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.job_overview == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'effect_and_suggestion',text:'\u6548\u679C\u53CA\u5EFA\u8BAE',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.effect_and_suggestion == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.effect_and_suggestion == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'membership_development',text:'\u4F1A\u5458\u53D1\u5C55',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.membership_development == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.membership_development == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'member_consumption',text:'\u4F1A\u5458\u6D88\u8D39',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.member_consumption == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.member_consumption == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'membership_value',text:'\u4F1A\u5458\u50A8\u503C',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.membership_value == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.membership_value == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'affiliate_marketing',text:'\u4F1A\u5458\u8425\u9500',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.affiliate_marketing == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.affiliate_marketing == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'population_quality',text:'\u7FA4\u4F53\u8D28\u91CF',html:!0,renderer:function(a,b){return'<span ms-visible="$outer.el.population_quality == 0">\u672A\u586B\u5199</span><span class="end" ms-visible="$outer.el.population_quality == 1">\u5DF2\u586B\u5199</span>';}},{dataIndex:'monthly_check_state',text:'\u72B6\u6001',html:!0,renderer:function(a,b){return'<span class="warn" ms-visible="$outer.el.monthly_check_state == 0">\u672A\u5B8C\u6210</span><span class="through" ms-visible="$outer.el.monthly_check_state == 1">\u5DF2\u5B8C\u6210</span>';}}],onLoad:function(c,g){c=_.extend(c,{reportTime:h(a.getVm(e('-year')).selectedValue+'-'+a.getVm(e('-month')).selectedValue)/1,merchantName:_.str.trim(l.keyword),frontUserId:a.getVm(e('-fd')).selectedValue,monthlyCheckState:a.getVm(e('-status')).selectedValue,isCheck:a.getVm(e('-check')).selectedValue}),d.c2s({url:b.BASE_PATH+'besMonthlyCheck/queryBesMonthlyCheckList.do',contentType:'application/json',data:f.stringify(c),success:function(a){var b;a.flag&&(b=a.data,g.call(this,b));}});}};});a.scan(m[0]);var i=new Date(),j=i.getFullYear(),g=i.getMonth();g==0&&(g=12,j-=1),a.getVm(e('-year')).selectValue(j),a.getVm(e('-month')).selectValue(g),a.getVm(e('-grid')).load();},$remove:function(b,d){_.each(c,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),c.length=0;}}),e;});

//From origin\page\databank\list\addedit\addedit.js
define('originpagedatabanklistaddeditaddeditjs',['avalon','util','json','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetuploaderuploaderjs'],function(b,a,e){var g=this,c=g.erp,f={},d=[];return _.extend(f,{$init:function(j,h,i){function k(d,f,g){var b=e.stringify(d);a.c2s({url:c.BASE_PATH+f,type:'post',contentType:'application/json',data:b,success:g});}function l(k){var a;if(k.flag){a=k.data,f.requestData={title:a.title,description:a.description,applyCrowdType:a.apply_crowd_type,sysAttachment:{originalFileName:a.sysAttachment.originalFileName,attachmentName:a.sysAttachment.attachmentName,attachmentSize:a.sysAttachment.attachmentSize,attachmentSuffix:a.sysAttachment.attachmentSuffix}},f.fileName=a.sysAttachment.originalFileName;var i=a.apply_crowd_type,h=f.personType.$model;for(var e=0;e<i.length;e++)for(var d=0;d<h.length;d++)i[e]==h[d].value&&(f.personType[d].isSelect='1');var l=a.data_type,j=f.$dataTypeOpts.options,m=b.getVm(g('dataTypeOpts'));for(var c=0;c<j.length;c++)j[c].value==l&&m.setOptions([{text:'\u6848\u4F8B\u7C7B',value:'1'},{text:'\u5236\u5EA6\u7C7B',value:'2'},{text:'\u9500\u552E\u5DE5\u5177\u7C7B',value:'3'},{text:'\u57F9\u8BAD\u6750\u6599\u7C7B',value:'4'},{text:'\u5BA2\u6237\u56DE\u9988',value:'5'},{text:'\u884C\u4E1A\u8D44\u8BAF',value:'6'},{text:'\u5E02\u573A\u6D3B\u52A8',value:'7'},{text:'Q&A',value:'8'},{text:'\u5176\u5B83',value:'9'}],c);}}var g=function(b){var a=h+b;return d.push(a),a;},f=b.define(h,function(d){d.navCrumbs=[{text:'\u8D44\u6599\u5E93',href:'#/databank/list'},{text:'\u4E0A\u4F20\u8D44\u6599'}],d.titleType='\u4E0A\u4F20\u8D44\u6599',d.pageType=parseInt(i.params.type),d.fileId=parseInt(i.params.id),d.pageType||(d.titleType='\u4FEE\u6539\u8D44\u6599',d.navCrumbs[1].text='\u4FEE\u6539\u8D44\u6599');var h=c.getAppData('user');d.searchData={pageSize:10,pageNumber:1,id:d.fileId},d.fileName='',d.personType=[{text:'\u5BA2\u670D\u7ECF\u7406',value:1,isSelect:'0'},{text:'\u9500\u552E',value:2,isSelect:'0'}],d.$dataTypeOpts={selectId:g('dataTypeOpts'),options:[{text:'\u6848\u4F8B\u7C7B',value:'1'},{text:'\u5236\u5EA6\u7C7B',value:'2'},{text:'\u9500\u552E\u5DE5\u5177\u7C7B',value:'3'},{text:'\u57F9\u8BAD\u6750\u6599\u7C7B',value:'4'},{text:'\u5BA2\u6237\u56DE\u9988',value:'5'},{text:'\u884C\u4E1A\u8D44\u8BAF',value:'6'},{text:'\u5E02\u573A\u6D3B\u52A8',value:'7'},{text:'Q&A',value:'8'},{text:'\u5176\u5B83',value:'9'}],selectedIndex:0},d.requestData={id:'',title:'',description:'',applyCrowdType:[],dataType:'',sysAttachment:{originalFileName:'',attachmentName:'',attachmentSize:'',attachmentSuffix:''}},d.personTypeSele=function(){var c=this.value;if(this.checked)f.requestData.applyCrowdType.push(c);else{var a=f.requestData.applyCrowdType;for(var b=0;b<a.length;b++)a[b]==c&&a.splice(b,1);}var a=f.requestData.applyCrowdType;a.length?f.isType=1:f.isType=0;},d.isData=1,d.isType=1,d.saveData=function(){var l=$('.add-edit-content')[0],j,i,k,h=b.getVm(g('dataUploaderId'));i=a.testing(l),f.requestData.sysAttachment.attachmentSize||(d.isData=0,i=0);var m=f.requestData.applyCrowdType;m.length==0&&(d.isType=0,i=0),f.requestData.$model.dataType=b.getVm(g('dataTypeOpts')).selectedValue,f.fileId?(j='sysDatabase/updateSysDatabase.do',f.requestData.$model.id=f.fileId):j='sysDatabase/saveSysDatabase.do',i&&(k=function(){a.c2s({url:c.BASE_PATH+j,type:'post',contentType:'application/json',data:e.stringify(f.requestData.$model),success:function(b){b.flag&&a.alert({content:'\u64CD\u4F5C\u6210\u529F\uFF01',iconType:'success',onSubmit:function(){window.location.href=c.BASE_PATH+'#!/databank/list';}});}});},h.uploading?(a.showGlobalMask(),h.$unwatch('uploading'),h.$watch('uploading',function(b){b||(a.hideGlobalMask(),k(),h.$unwatch('uploading'));})):k());},d.$dataUploaderOpts={uploaderId:g('dataUploaderId'),uploadifyOpts:{uploader:c.BASE_PATH+'sysDatabase/uploadFiles.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.pdf;*.rar;*.zip',formData:function(){return{sessionId:h.sessionId};},width:80,height:30,progressData:'speed'},onSuccessResponseData:function(c,h){if(c=e.parse(c),c.flag){f.isData=1;var b=c.data[0],d=b.originalFileName.lastIndexOf('.'),g=b.originalFileName.substr(d+1);f.requestData.sysAttachment.originalFileName=b.originalFileName,f.requestData.sysAttachment.attachmentName=b.fileName,f.requestData.sysAttachment.attachmentSize=b.fileSize,f.requestData.sysAttachment.attachmentSuffix=g,f.fileName=b.originalFileName;}else a.alert({content:responseData.message,iconType:'error'});}};});b.scan(j[0]),f.pageType||k(f.searchData.$model,'sysDatabase/querySysDatabaseById.do',l);},$remove:function(a,c){_.each(d,function(c){var a=b.getVm(c);a&&$(a.widgetElement).remove();}),d.length=0;}}),f;});

//From origin\page\databank\list\info\info.js
define('originpagedatabanklistinfoinfojs',['avalon','util','json','moment','originwidgetpaginationpaginationjs','originwidgetformselectjs'],function(b,f,g){var e=this,a=e.erp,c={},d=[];return _.extend(c,{$init:function(h,i,j){function d(c,d,e){var b=g.stringify(c);f.c2s({url:a.BASE_PATH+d,type:'post',contentType:'application/json',data:b,success:e});}function e(e){var d;if(e.flag){d=e.data;var b=d.sysAttachmentUserList.rows;for(var a=0;a<b.length;a++)b[a].insert_time=moment(b[a].insert_time).format('YYYY-MM-DD');c.responseData=d;}}var c=b.define(i,function(b){b.navCrumbs=[{text:'\u8D44\u6599\u5E93',href:'#/databank/list'},{text:'\u8D44\u6599\u8BE6\u60C5'}],b.path=a.BASE_PATH,b.pageUserId=a.getAppData('user').id,b.fileId=parseInt(j.params.id),b.userImgPath=a.appData.user.userImagePath,b.requestData={pageSize:1000,pageNumber:1,id:b.fileId},b.responseData={},b.downFile=function(b){var a=c.responseData.databaseFilePath+'/'+c.responseData.sysAttachment.attachmentPath+'/'+c.responseData.sysAttachment.attachmentName;window.location=c.path+'sysDatabase/download.do?relPath='+a+'&userId='+c.pageUserId+'&attachmentId='+b,setTimeout(function(){d(c.requestData.$model,'sysDatabase/querySysDatabaseById.do',e);},500);};});b.scan(h[0]),d(c.requestData.$model,'sysDatabase/querySysDatabaseById.do',e);},$remove:function(a,c){_.each(d,function(c){var a=b.getVm(c);a&&$(a.widgetElement).remove();}),d.length=0;}}),c;});

//From origin\page\databank\list\list.js
define('originpagedatabanklistlistjs',['avalon','util','json','originwidgetpaginationpaginationjs','originwidgetformselectjs'],function(b,a,f){var g=this,c=g.erp,e={},d=[];return _.extend(e,{$init:function(k,j){function h(d,e,g){var b=f.stringify(d);a.c2s({url:c.BASE_PATH+e,type:'post',contentType:'application/json',data:b,success:g});}function i(c){var a,d=b.getVm(g('paginationPage'));c.flag&&(a=c.data,e.sum=a.totalSize,e.responseDataList=a.rows,d.total=a.totalSize);}var g=function(b){var a=j+b;return d.push(a),a;},e=b.define(j,function(d){d.permission={data_upload:a.hasPermission('data_upload'),data_update:a.hasPermission('data_update'),data_delete:a.hasPermission('data_delete'),data_download:a.hasPermission('data_download'),data_review:a.hasPermission('data_review')},d.pageUserId=c.getAppData('user').id,d.path=c.BASE_PATH,d.localHref=function(b){a.jumpPage(b);},d.responseData={pageSize:10,pageNumber:1,attachmentSuffix:'',applyCrowdType:'',title:'',dataType:''},d.sum=0,d.responseDataList=[],d.$personTypeOpts={selectId:g('personTypeOpts'),options:[],selectedIndex:0},d.$layoutTypeOpts={selectId:g('layoutTypeOpts'),options:[{text:'\u5168\u90E8\u683C\u5F0F',value:''},{text:'doc',value:'doc'},{text:'docx',value:'docx'},{text:'xls',value:'xls'},{text:'xlsx',value:'xlsx'},{text:'ppt',value:'ppt'},{text:'pptx',value:'pptx'},{text:'pdf',value:'pdf'},{text:'rar',value:'rar'},{text:'zip',value:'zip'}],selectedIndex:0},d.$dataTypeOpts={selectId:g('dataTypeOpts'),options:[],selectedIndex:0},a.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000094',success:function(c){var d,e=b.getVm(g('personTypeOpts'));if(c.flag){d=c.data;var a=_.map(d,function(a){return{text:a.dictionary_value,value:a.dictionary_key};});a.unshift({text:'\u5168\u90E8\u4EBA\u7FA4',value:''}),e.setOptions(a);}}}),a.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000095',success:function(c){var d,e=b.getVm(g('dataTypeOpts'));if(c.flag){d=c.data;var a=_.map(d,function(a){return{text:a.dictionary_value,value:a.dictionary_key};});a.unshift({text:'\u5168\u90E8\u7C7B\u578B',value:''}),e.setOptions(a);}}}),d.search=function(){var a=b.getVm(g('personTypeOpts')).selectedValue,c=b.getVm(g('layoutTypeOpts')).selectedValue,d=b.getVm(g('dataTypeOpts')).selectedValue;e.responseData.attachmentSuffix=c,e.responseData.applyCrowdType=a,e.responseData.dataType=d;var f=b.getVm(g('paginationPage'));e.responseData.pageNumber=1,f.currentPage=1,h(e.responseData.$model,'sysDatabase/querySysDatabase.do',i);},d.removeFile=function(b){a.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F',onSubmit:function(){a.c2s({url:c.BASE_PATH+'sysDatabase/deleteSysDatabase.do',type:'post',contentType:'application/json',data:f.stringify({id:b}),success:function(b){b.flag&&(a.alert({content:'\u5DF2\u5220\u9664',iconType:'success'}),h(e.responseData.$model,'sysDatabase/querySysDatabase.do',i));}});}});},d.toInfo=function(c){var b='#/databank/list/info/'+c;e.permission.data_review?a.jumpPage(b):a.alert({content:'\u60A8\u6CA1\u6709\u67E5\u770B\u8BE6\u60C5\u7684\u6743\u9650\uFF01',iconType:'info'});},d.downFile=function(c){var a=this.$vmodel.$model.el,b=a.databaseFilePath+'/'+a.attachment_path+'/'+a.attachment_name;window.location=e.path+'sysDatabase/download.do?relPath='+b+'&userId='+e.pageUserId+'&attachmentId='+c;},d.$paginationOpts={paginationId:g('paginationPage'),total:0,onJump:function(c,d){var a=b.getVm(g('paginationPage'));e.responseData.pageNumber=a.currentPage,h(e.responseData.$model,'sysDatabase/querySysDatabase.do',i);}};});b.scan(k[0]),h(e.responseData.$model,'sysDatabase/querySysDatabase.do',i);},$remove:function(a,c){_.each(d,function(c){var a=b.getVm(c);a&&$(a.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\datamonitor\allstatistics\allstatistics.js
define('originpagedatamonitorallstatisticsallstatisticsjs',['avalon','util','moment','highcharts','originwidgetformselectjs','originwidgetcalendarcalendarjs'],function(a,d,b,c){var g=this,e=g.erp,f={};return _.extend(f,{$init:function(p,f){var u=f+'-ub-dot-user',t=f+'-ub-dot-brand',m=f+'-ub-range-user',s=f+'-ub-range-rd',v=f+'-calendar-1',x=f+'-calendar-2',j=f+'-calendar-3',k=f+'-ub-chart-holder',n=f+'-fun-chart-holder',r=f+'-fun-cate',q=f+'-fun-hb',o=f+'fun-send',i=f+'fun-gt',g=new Date(),w=$('.range-date-calendar',p),l=$('.date-range-selector .selector-panel',p),A=$('.ub-section .chart-box .chart-panel',p),z=$('.fun-section .chart-box .chart-panel',p),h={chart:{style:{fontFamily:'tahoma,arial,"Hiragino Sans GB","\u5FAE\u8F6F\u96C5\u9ED1","Microsoft YaHei","WenQuanYi Micro Hei","\x05b8b\x04f53"',fontSize:'14px',color:'#666666'}},credits:{enabled:!1},exporting:{enabled:!1},colors:['#e0769b','#e0ad76','#dae076','#66ccb5','#76cae0','#76a9e0','#7678e0'],title:{style:{color:'#666666',fontSize:'14px'}},legend:{itemStyle:{color:'#666666',fontSize:'14px',fontWeight:'normal'}},labels:{style:{color:'#666666',fontSize:'14px'}},tooltip:{style:{color:'#666666',fontSize:'14px',fontWeight:'normal'},headerFormat:'<span style="font-weight:bold;">{point.key}</span><br/>'},plotOptions:{pie:{dataLabels:{style:{color:'#666666',fontSize:'14px'}},showInLegend:!0}},yAxis:{plotLines:[{value:0,width:1,color:'#666666'}]}},y=a.define(f,function(f){f.$skipArray=['ubChart'],f.statisticsState='dot',f.showRangeCalendar=function(){l.show();},f.$calendar1Opts={calendarId:v,disableYearMonthPanel:!0,focusDate:b().subtract('months',2)._d,focusChangeWithClick:!1,onClickDate:function(a){f.selectDateRange(a);}},f.$calendar2Opts={calendarId:x,disableYearMonthPanel:!0,focusDate:b().subtract('months',1)._d,focusChangeWithClick:!1,onClickDate:function(a){f.selectDateRange(a);}},f.$calendar3Opts={calendarId:j,disableYearMonthPanel:!0,focusDate:new Date(),maxDate:g,onClickDate:function(a){f.selectDateRange(a);}},f.isCurrentDate=!0,f.startDate=null,f.endDate=null,f.startDateStr='',f.endDateStr='',f.selectedRangeDateStr='',f.selectDateRange=function(a){!f.startDate||f.endDate?(f.endDate=null,f.startDate=a):b(a).isBefore(f.startDate,'day')?d.alert({iconType:'info',content:'\u9009\u62E9\u7ED3\u675F\u65F6\u95F4\u8981\u5927\u4E8E\u5F00\u59CB\u65F6\u95F4'}):f.endDate=a;},f.rangeDateCb=function(){var a=$('.ui-calendar-date-panel td',w);a.removeClass('is-start-date is-end-date is-range-date'),f.startDate||f.endDate?(a.each(function(){var a=$(this),c=a.data('date'),d=b(c,'YYYY-MM-DD');f.endDate&&c==b(f.endDate).format('YYYY-MM-DD')&&a.addClass('is-end-date'),f.startDate&&c==b(f.startDate).format('YYYY-MM-DD')&&a.addClass('is-start-date'),f.startDate&&f.endDate&&!d.isBefore(f.startDate,'day')&&!d.isAfter(f.endDate,'day')&&a.addClass('is-range-date');}),f.startDateStr=f.startDate?b(f.startDate).format('YYYY-MM-DD'):'',f.endDateStr=f.endDate?b(f.endDate).format('YYYY-MM-DD'):'',f.startDate&&f.endDate?f.selectedRangeDateStr=b(f.startDate).format('YYYY.MM.DD')+' - '+b(f.endDate).format('YYYY.MM.DD'):f.selectedRangeDateStr=''):(f.startDateStr='',f.selectedRangeDateStr='');},f.getCurrentFirstDate=function(){var a=$('.ui-calendar-date-panel td',w);return b(a.first().data('date'),'YYYY-MM-DD')._d;},f.$watch('startDate',function(a){f.rangeDateCb();}),f.$watch('endDate',function(a){f.rangeDateCb();}),f.formatInputDate=function(d){d=d.replace(/\s+/g,'');var b=d.split(''),c='';for(var a=0,e=b.length;a<e;a++){if(a>9)break;/[\d|-]/.test(b[a])&&(a==4&&b[4]!='-'&&(c+='-'),a==7&&b[7]!='-'&&(c+='-'),c+=b[a]);}return c;},f.$watch('startDateStr',function(c){var a;f.startDateStr=f.formatInputDate(c),f.startDateStr.length===10&&(a=b(f.startDateStr,'YYYY-MM-DD'),a.isValid()&&(f.startDate=a._d));}),f.$watch('endDateStr',function(e){var c,d=a.getVm(j);f.endDateStr=f.formatInputDate(e),f.endDateStr.length===10&&(c=b(f.endDateStr,'YYYY-MM-DD'),c.isValid()&&!c.isBefore(f.startDate,'day'))&&(b(c._d).isBefore(f.getCurrentFirstDate())&&(d.focusDate=c._d),f.endDate=c._d);}),f.navToNextYear=function(){var d=a.getVm(j),c=b(d.focusDate);c=c.add('years',1),c.isAfter(g,'month')?(d.focusDate=g,f.isCurrentDate=!0):(d.focusDate=c._d,f.isCurrentDate=!1),f.$fire('startDate',f.startDate),f.$fire('endDate',f.endDate);},f.navToPrevYear=function(){var d=a.getVm(j),c=b(d.focusDate);c=c.subtract('years',1),d.focusDate=c._d,f.isCurrentDate=!1,f.$fire('startDate',f.startDate),f.$fire('endDate',f.endDate);},f.navToNextMonth=function(){var d=a.getVm(j),c=b(d.focusDate);c=c.add('months',1),c.isAfter(g,'month')?(d.focusDate=g,f.isCurrentDate=!0):(d.focusDate=c._d,f.isCurrentDate=!1),f.$fire('startDate',f.startDate),f.$fire('endDate',f.endDate);},f.navToPrevMonth=function(){var d=a.getVm(j),c=b(d.focusDate);c=c.subtract('months',1),d.focusDate=c._d,f.isCurrentDate=!1,f.$fire('startDate',f.startDate),f.$fire('endDate',f.endDate);},f.confirmRangeDate=function(){if(!(f.endDate&&f.startDate)){d.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u6709\u6548\u7684\u65F6\u95F4\u6BB5'});return;}b(f.endDate).isBefore(f.startDate,'day')?d.alert({iconType:'error',content:'\u8BF7\u8BBE\u7F6E\u5F00\u59CB\u65F6\u95F4\u5C0F\u4E8E\u7ED3\u675F\u65F6\u95F4'}):b(f.endDate).isSame(f.startDate,'day')&&b(f.endDate).isSame(g,'day')?(f.statisticsState='dot',f.startDate=null,f.endDate=null,l.hide(),f.refreshPage()):(f.statisticsState='range',l.hide(),f.refreshPage());},f.closeCalendarPanel=function(){l.hide();},f.switchToToday=function(){f.statisticsState='dot',f.startDate=null,f.endDate=null,f.refreshPage();},f.ubState='user',f.totalUserNum=0,f.addedUserNum=0,f.totalBrandNum=0,f.addedBrandNum=0,f.totalMerchantNum=0,f.addedMerchantNum=0,f.userStatisticsData=[],f.businessStatisticsData=[],f.ubChartBoxTitle='\u7528\u6237\u5206\u5E03\u56FE\u8868',f.$ubDotUserOpts={selectId:u,options:[{text:'\u603B\u7528\u6237',value:!1},{text:'\u65B0\u589E\u7528\u6237',value:!0}],selectedIndex:0,onSelect:function(){f.fetchUbData('chart',function(a){f.redrawUbChart(a);});}},f.$ubDotBrandOpts={selectId:t,options:[{text:'\u603B\u54C1\u724C',value:!1},{text:'\u65B0\u589E\u54C1\u724C',value:!0}],selectedIndex:0,onSelect:function(){f.fetchUbData('chart',function(a){f.redrawUbChart(a);});}},f.$ubRangeUserOpts={selectId:m,options:[{text:'\u65B0\u589E\u7528\u6237',value:'newUser'},{text:'\u767B\u5F55\u4EBA\u6570',value:'loginUser'},{text:'\u767B\u5F55\u6B21\u6570',value:'loginTimes'}],selectedIndex:0,onSelect:function(){f.fetchUbData('chart',function(a){f.redrawUbChart(a);});}},f.$ubRangeRdOpts={selectId:s,options:[{text:'\u89D2\u8272\u5360\u6BD4',value:'role'},{text:'\u65F6\u95F4\u5206\u5E03',value:'date'}],selectedIndex:0,onSelect:function(){f.fetchUbData('chart',function(a){f.redrawUbChart(a);});}},f.switchUbState=function(){f.ubState=a(this).data('ubState');},f.$watch('ubState',function(){f.fetchUbData('grid',function(a){f.reRenderUbGrid(a);}),f.fetchUbData('chart',function(a){f.redrawUbChart(a);});}),f.ubChart=null,f.fetchUbData=function(i,j){var h,c={};f.ubState=='user'?i=='grid'?h='new/superReport/userTableData.do':i=='chart'&&(h='new/superReport/userChartData.do',f.statisticsState=='dot'&&(c.isNew=a.getVm(u).selectedValue),f.statisticsState=='range'&&(c.queryType=a.getVm(m).selectedValue,c.queryFlag=a.getVm(s).selectedValue)):f.ubState=='business'&&(i=='grid'?h='new/superReport/brandTableData.do':i=='chart'&&(h='new/superReport/brandChartData.do',f.statisticsState=='dot'&&(c.isNew=a.getVm(t).selectedValue))),f.statisticsState=='dot'?c.beginDate=c.endDate=b(g).unix():f.statisticsState=='range'&&(c.beginDate=b(f.startDate).unix(),c.endDate=b(f.endDate).unix()),d.c2s({url:e.BASE_PATH+h,data:c,success:function(a){a.flag&&j&&j.call(f,a.data);}});},f.reRenderUbGrid=function(d){var a=d.total,c=d.statistics;f.statisticsState=='dot'?(f.totalUserNum=a.userCount,f.addedUserNum=a.newUserCount,f.totalBrandNum=a.brandCount,f.addedBrandNum=a.newBrandCount,f.totalMerchantNum=a.faceShopCount,f.addedMerchantNum=a.newFaceShopCount,f.ubState=='user'?f.userStatisticsData=_.map(c,function(a){return a.cate=='hisMax'&&_.each(['loginNumHisMaxDate','loginTimesHisMaxDate','newNumHisMaxDate'],function(c){a[c]=b.unix(a[c]).format('YYYY-MM-DD');}),a;}):f.ubState=='business'&&(f.businessStatisticsData=_.map(c,function(a){return a.cate=='hisMax'&&_.each(['newBrandHisMaxDate','activeBrandNumHisMaxDate','newMerchantHisMaxDate','activeMerchantNumHisMaxDate'],function(c){a[c]=b.unix(a[c]).format('YYYY-MM-DD');}),a;}))):f.statisticsState=='range'&&(f.addedUserNum=a.newUserCount,f.addedBrandNum=a.newBrandCount,f.addedMerchantNum=a.newFaceShopCount,f.ubState=='user'?f.userStatisticsData=c:f.ubState=='business'&&(f.businessStatisticsData=c));},f.redrawUbChart=function(d){var i=f.statisticsState,e=f.ubState;f.ubChart&&f.ubChart.destroy(),A.html('<div id="'+k+'"></div>'),i=='dot'?e=='user'?f.ubChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:k,type:'pie'},title:{text:b(g).format('YYYY-MM-DD')+a.getVm(u).selectedText+'\u6570\u91CF'},legend:{align:'right',verticalAlign:'middle',width:200,layout:'vertical',borderWidth:1,borderColor:'#e9e9e9',backgroundColor:'#e9e9e9',padding:20,itemMarginBottom:10},plotOptions:{pie:{dataLabels:{format:'{point.userCount}<br/>\u5360{point.percentage:.1f} %'}}},series:[{name:'\u5360\u6BD4',data:_.map(d,function(a){return{name:a.role,y:a.ratio,userCount:a.userCount};})}]})):e=='business'&&(f.ubChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:k,type:'column'},title:{text:'\u8FD17\u65E5'+a.getVm(t).selectedText+'\u6570\u91CF\u5BF9\u6BD4'},xAxis:{categories:d.categories},yAxis:{min:0,title:{text:'\u603B\u6570'}},tooltip:{headerFormat:'<span>{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0">&nbsp;<span>{point.y}</span></td></tr>',footerFormat:'</table>',shared:!0,useHTML:!0},series:d.series}))):i=='range'&&(e=='user'?a.getVm(s).selectedValue=='date'?f.ubChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:k,type:'line'},title:{text:b.unix(d.categories[0]).format('YYYY-MM-DD')+' \u81F3 '+b.unix(d.categories[d.categories.length-1]).format('YYYY-MM-DD')+' '+a.getVm(m).selectedText},xAxis:{categories:_.map(d.categories,function(a){return b.unix(a).format('YYYY-MM-DD');}),labels:{rotation:d.categories.length>10?45:0}},yAxis:{title:{text:a.getVm(m).selectedValue=='loginTimes'?'\u6B21\u6570':'\u4EBA\u6570'}},tooltip:{valueSuffix:''},series:d.series})):f.ubChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:k,type:'pie'},title:{text:b(f.startDate).format('YYYY-MM-DD')+' \u81F3 '+b(f.endDate).format('YYYY-MM-DD')+' '+a.getVm(m).selectedText+'\u6570\u91CF'},legend:{align:'right',verticalAlign:'middle',width:200,layout:'vertical',borderWidth:1,borderColor:'#e9e9e9',backgroundColor:'#e9e9e9',padding:20,itemMarginBottom:10},plotOptions:{pie:{dataLabels:{format:'{point.userCount}<br/>\u5360{point.percentage:.1f} %'}}},series:[{name:'\u5360\u6BD4',data:_.map(d,function(a){return{name:a.role,y:a.ratio,userCount:a.userCount};})}]})):e=='business'&&(f.ubChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:k,type:'line'},title:{text:b.unix(d.categories[0]).format('YYYY-MM-DD')+' \u81F3 '+b.unix(d.categories[d.categories.length-1]).format('YYYY-MM-DD')+' \u54C1\u724C\u5206\u5E03\u56FE\u8868'},xAxis:{categories:_.map(d.categories,function(a){return b.unix(a).format('YYYY-MM-DD');}),labels:{rotation:d.categories.length>10?45:0}},yAxis:{title:{text:'\u54C1\u724C'}},tooltip:{valueSuffix:''},series:d.series}))));},f.$funCateOpts={selectId:r,options:[{text:'\u5168\u90E8\u529F\u80FD',value:''},{text:'\u53D1\u9001\u65E5\u62A5',value:'SEND_REPORT'},{text:'\u67E5\u770B\u65E5\u62A5',value:'VIEW_REPORT'},{text:'\u67E5\u770B\u6708\u62A5',value:'VIEW_MONTHREPORT'},{text:'\u6708\u62A5\u5BFC\u51FA',value:'EXPORT_REPORT'},{text:'\u6570\u636E\u7EDF\u8BA1',value:'VIEW_STATISTICS'},{text:'\u53D1\u9001\u8BC4\u8BBA',value:'SEND_COMMENT'},{text:'\u67E5\u770B\u8BC4\u8BBA',value:'VIEW_COMMENT'},{text:'\u53D1\u9001\u901A\u77E5',value:'SEND_NOTICE'},{text:'\u67E5\u770B\u901A\u77E5',value:'VIEW_NOTICE'},{text:'\u6807\u6CE8',value:'VIEW_MARK'}],selectedIndex:0,onSelect:function(){f.fetchFunData('chart',function(a){f.redrawFunChart(a);});}},f.$funHbOpts={selectId:q,options:[{text:'\u5168\u90E8\u56FE\u8868',value:''},{text:'\u65E5\u73AF\u6BD4\u56FE',value:'CHART_DAY'},{text:'\u6708\u540C\u6BD4\u56FE',value:'CHART_MONTH'}],selectedIndex:0,onSelect:function(){f.fetchFunData('chart',function(a){f.redrawFunChart(a);});}},f.$funSendOpts={selectId:o,options:[{text:'\u5168\u90E8\u6570\u636E',value:''},{text:'\u53D1\u9001\u65E5\u62A5',value:'SEND_REPORT'},{text:'\u53D1\u9001\u901A\u77E5',value:'SEND_NOTICE'}],selectedIndex:0,onSelect:function(b){b?a.getVm(i).setOptions([{text:'\u529F\u80FD\u5360\u6BD4',value:'function'},{text:'\u65F6\u95F4\u5206\u5E03',value:'date'}]):a.getVm(i).setOptions([{text:'\u65F6\u95F4\u5206\u5E03',value:'date'}]),f.fetchFunData('chart',function(a){f.redrawFunChart(a);});}},f.$funGtOpts={selectId:i,options:[{text:'\u529F\u80FD\u5360\u6BD4',value:'function'},{text:'\u65F6\u95F4\u5206\u5E03',value:'date'}],selectedIndex:0,onSelect:function(){f.fetchFunData('chart',function(a){f.redrawFunChart(a);});}},f.funStatisticsData=[],f.funState='user',f.switchFunState=function(){f.funState=a(this).data('funState');},f.$watch('funState',function(b){b=='sending'&&!a.getVm(o).selectedValue?a.getVm(i).setOptions([{text:'\u65F6\u95F4\u5206\u5E03',value:'date'}]):a.getVm(i).setOptions([{text:'\u529F\u80FD\u5360\u6BD4',value:'function'},{text:'\u65F6\u95F4\u5206\u5E03',value:'date'}]),f.fetchFunData('grid',function(a){f.reRenderFunGrid(a);}),f.fetchFunData('chart',function(a){f.redrawFunChart(a);});}),f.funChart=null,f.fetchFunData=function(j,k){var h,c={};j=='grid'?h='new/superReport/functionTableData.do':j=='chart'&&(h='new/superReport/functionChartData.do',f.funState=='user'||f.funState=='times'?c.path=a.getVm(r).selectedValue:f.funState=='clicks'?c.path=a.getVm(q).selectedValue:f.funState=='sending'&&(c.path=a.getVm(o).selectedValue),f.statisticsState=='range'?c.queryFlag=a.getVm(i).selectedValue:c.queryFlag='function'),c.type=f.translateFunState(f.funState),f.statisticsState=='dot'?c.beginDate=c.endDate=b(g).unix():f.statisticsState=='range'&&(c.beginDate=b(f.startDate).unix(),c.endDate=b(f.endDate).unix()),d.c2s({url:e.BASE_PATH+h,data:c,success:function(a){a.flag&&k&&k.call(f,a.data);}});},f.reRenderFunGrid=function(a){f.funStatisticsData=_.map(a,function(a){return _.each(['sendReportCountHisMaxDate','viewReportCountHisMaxDate','viewMonthReportCountHisMaxDate','exportReportCountHisMaxDate','viewStatisticsCountHisMaxDate','sendCommentCountHisMaxDate','viewCommentCountHisMaxDate','sendNoticeCountHisMaxDate','viewNoticeCountHisMaxDate','viewMarkCountHisMaxDate','chartDayCountHisMaxDate','chartMonthCountHisMaxDate'],function(c){a[c]&&(a[c]=b.unix(a[c]).format('YYYY-MM-DD'));}),a;});},f.redrawFunChart=function(d){var j=f.statisticsState,k=f.funState,e;f.funChart&&f.funChart.destroy(),z.html('<div id="'+n+'"></div>'),k=='user'||k=='times'?e=r:f.funState=='clicks'?e=q:f.funState=='sending'&&(e=o),j=='dot'?f.funChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:n,type:'pie'},title:{text:b(g).format('YYYY-MM-DD')+a.getVm(e).selectedText},legend:{align:'right',verticalAlign:'middle',width:200,layout:'vertical',borderWidth:1,borderColor:'#e9e9e9',backgroundColor:'#e9e9e9',padding:20,itemMarginBottom:10},plotOptions:{pie:{dataLabels:{format:'{point.userCount}<br/>\u5360{point.percentage:.1f} %'}}},series:[{name:'\u5360\u6BD4',data:_.map(d,function(a){return{name:a.name,y:a.ratio,userCount:a.count};})}]})):j=='range'&&(a.getVm(i).selectedValue=='date'?f.funChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:n,type:'line'},title:{text:b.unix(d.categories[0]).format('YYYY-MM-DD')+' \u81F3 '+b.unix(d.categories[d.categories.length-1]).format('YYYY-MM-DD')+' '+a.getVm(e).selectedText},xAxis:{categories:_.map(d.categories,function(a){return b.unix(a).format('YYYY-MM-DD');}),labels:{rotation:d.categories.length>10?45:0}},yAxis:{title:{text:'\u603B\u6570'}},tooltip:{valueSuffix:''},series:d.series})):f.funChart=new c.Chart(a.mix(!0,{},h,{chart:{renderTo:n,type:'pie'},title:{text:b(f.startDate).format('YYYY-MM-DD')+' \u81F3 '+b(f.endDate).format('YYYY-MM-DD')+' '+a.getVm(e).selectedText},legend:{align:'right',verticalAlign:'middle',width:200,layout:'vertical',borderWidth:1,borderColor:'#e9e9e9',backgroundColor:'#e9e9e9',padding:20,itemMarginBottom:10},plotOptions:{pie:{dataLabels:{format:'{point.userCount}<br/>\u5360{point.percentage:.1f} %'}}},series:[{name:'\u5360\u6BD4',data:_.map(d,function(a){return{name:a.name,y:a.ratio,userCount:a.count};})}]})));},f.refreshPage=function(){f.fetchUbData('grid',function(a){f.reRenderUbGrid(a);}),f.fetchUbData('chart',function(a){f.redrawUbChart(a);}),f.fetchFunData('grid',function(a){f.reRenderFunGrid(a);}),f.fetchFunData('chart',function(a){f.redrawFunChart(a);});},f.translateFunState=function(b){var a='';switch(b){case'user':a='personCount';break;case'times':a='count';break;case'clicks':a='clickCount';break;case'sending':a='sendCount';break;default:break;}return a;};});a.scan(p[0]),a.nextTick(function(){y.refreshPage();}),a.getVm(j).$watch('focusDate',function(c){a.getVm(x).focusDate=b(c).subtract('months',1)._d,a.getVm(v).focusDate=b(c).subtract('months',2)._d;}),d.regGlobalMdExcept({element:l,handler:function(){y.closeCalendarPanel();}});},$remove:function(o,b){var e=b+'-ub-dot-user',f=b+'-ub-dot-brand',g=b+'-ub-range-user',n=b+'-ub-range-rd',d=b+'-calendar-1',j=b+'-calendar-2',k=b+'-calendar-3',l=b+'-fun-cate',m=b+'-fun-hb',i=b+'fun-send',h=b+'fun-gt',c=a.getVm(b);$(a.getVm(e).widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),$(a.getVm(g).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(j).widgetElement).remove(),$(a.getVm(k).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),$(a.getVm(m).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(h).widgetElement).remove(),c.ubChart&&c.ubChart.destroy(),c.funChart&&c.funChart.destroy(),c.ubChart=null,c.funChart=null;}}),f;});

//From origin\page\demand\demandboard\demandboard.js
define('originpagedemanddemandboarddemandboardjs',['avalon','util','moment','json','originwidgetpaginationpaginationjs','originwidgetformformjs','originwidgetformselectjs','dialog','originwidgetcalendarcalendarjs'],function(a,c,b,g){var e=this,d=e.erp,f={};return _.extend(f,{$init:function(w,f){function p(k){var f=a.getVm(v),h=a.getVm(t),j=a.getVm(u),e={name:i.demandName,requirementPlanType:a.getVm(r).selectedValue,projectIds:a.getVm(o).selectedValue?[].concat(a.getVm(o).selectedValue):[],requirementStatus:a.getVm(s).selectedValue};j.selectedValue?(e.startPlanTime=+b(h.selectedValue+'-'+j.selectedValue,'YYYY-M'),e.endPlanTime=b(e.startPlanTime).add('months',1).subtract('seconds',1)/1):(e.startPlanTime=+b(h.selectedValue,'YYYY'),e.endPlanTime=+b(h.selectedValue,'YYYY').add('years',1).subtract('seconds',1)/1),k?(e.pageSize=f.perPages,e.pageNumber=1):(e.pageSize=f.perPages,e.pageNumber=f.currentPage),c.c2s({url:d.BASE_PATH+'reqRequirement/listReqRequirements.do',data:g.stringify(e),contentType:'application/json',success:function(c){var a;c.flag&&(a=c.data,f.total=a.totalSize,k&&(f.currentPage=1),i.gridData=_.map(a.rows,function(a){return a.projectNames=_.map(a.reqProjects,function(a){return a.name;}).join(','),a.isOutDateOfPlanEndTime=a.onlineTime?b(a.onlineTime).isAfter(b(a.planEndTime),'day')?!0:!1:!1,a.requirementsReviewTime=a.requirementsReviewTime?b(a.requirementsReviewTime).format('YYYY-MM-DD')+'&nbsp;':'',a.productReviewTime=a.productReviewTime?b(a.productReviewTime).format('YYYY-MM-DD'):'',a.developmentTime=a.developmentTime?b(a.developmentTime).format('YYYY-MM-DD'):'',a.planEndTime=a.planEndTime?b(a.planEndTime).format('YYYY-MM-DD'):'',a.isRequirementsReviewText='<span data-tip="'+a.requirementsReviewOpinion+'" class="'+(a.isRequirementsReview=='0'?'no-passed-flag state-out-date':'')+'">'+y(a.isRequirementsReview)+'</span>',a.isProductReviewText='<span data-tip="'+a.productReviewOpinion+'" class="'+(a.isProductReview=='0'?'no-passed-flag state-out-date':'')+'">'+x(a.isProductReview)+'</span>',a.planTimeText=a.planTime?b(a.planTime).format('YYYY/MM'):'',a.onlineTime=a.onlineTime?b(a.onlineTime).format('YYYY-MM-DD'):'',a;}),i.gridTotalSize=a.totalSize,i.gridAllChecked=!1,i.gridSelected.clear());}});}function z(b){c.c2s({url:d.BASE_PATH+'reqRequirement/getDropDownLists.do',contentType:'application/json',type:'get',success:function(g){var c,d,e,f,i=a.getVm(h);g.flag&&(c=g.data,d=c.planType,e=c.project,f=c.state,a.getVm(r).setOptions([{text:'\u8BA1\u5212\u7C7B\u578B',value:''}].concat(d)),a.getVm(n).setOptions(d),a.getVm(o).setOptions([{text:'\u5168\u90E8\u9879\u76EE',value:''}].concat(e)),a.getVm(s).setOptions([{text:'\u5168\u90E8\u72B6\u6001',value:''}].concat(f)),a.getVm(l).setOptions([{text:'\u5168\u90E8\u72B6\u6001',value:''}].concat(f)),i.projectList=[].concat(e),b&&b.call(this,c));}});}function y(b){var a='';switch(b){case'0':a='\u672A\u901A\u8FC7';break;case'1':a='\u901A\u8FC7';break;case'2':a='\u65E0\u9700\u8BC4\u5BA1';break;default:break;}return a;}function x(b){var a='';switch(b){case'0':a='\u672A\u901A\u8FC7';break;case'1':a='\u901A\u8FC7';break;case'2':a='\u65E0\u9700\u8BC4\u5BA1';break;default:break;}return a;}var v=f+'-pagination',m=f+'-dialog',h=f+'-form',r=f+'plan-type-selector',o=f+'project-selector',s=f+'status-selector',t=f+'year-selector',u=f+'month-selector',n=f+'plan-type-selector-',l=f+'status-selector-',k=f+'year-selector-',j=f+'month-selector-',q=f+'-calendar',i=a.define(f,function(i){i.permission={add:c.hasPermission('requirement_insert'),edit:c.hasPermission('requirement_update'),'delete':c.hasPermission('requirement_delete')},i.demandName='',i.$yearOpts={selectId:t,options:_.map(_.range(b().year(),b().year()-10,-1),function(a){return{text:a+'\u5E74',value:a};}),selectedIndex:0},i.$monthOpts={selectId:u,options:[{text:'\u5168\u90E8',value:0}].concat(_.map(_.range(1,13),function(a){return{text:a+'\u6708',value:a};})),selectedIndex:0},i.$planTypeOpts={selectId:r,options:[{text:'\u8BA1\u5212\u7C7B\u578B',value:''}],selectedIndex:0},i.$projectOpts={selectId:o,options:[{text:'',value:''}],selectedIndex:0},i.$statusOpts={selectId:s,options:[{text:'',value:''}],selectedIndex:0},i.gridTotalSize=0,i.gridData=[],i.gridAllChecked=!1,i.gridSelected=[],i.gridCheckAll=function(){this.checked?i.gridSelected=_.map(i.gridData.$model,function(a){return a.id+'';}):i.gridSelected.clear();},i.scCheckAll=function(){i.gridSelected=_.map(i.gridData.$model,function(a){return a.id+'';});},i.search=function(){p(!0);},i.$paginationOpts={paginationId:v,total:0,perPages:30,onJump:function(a,b){p();}},i.$aeDialogOpts={title:'\u6DFB\u52A0\u9700\u6C42',dialogId:m,width:920,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close" ms-visible="addEditState != \'view\'">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){var c,d=a.getVm(h);(i.addEditState=='edit'||i.addEditState=='view')&&(c=_.find(i.gridData.$model,function(a){return a.id==i.gridSelected[0];}),d.demandName=c.name,d.belongProject=_.map(c.reqProjects,function(a){return a.id+'';}),d.devChargePerson=c.leader,a.getVm(n).selectValue(c.requirementPlanType),a.getVm(k).selectValue(b(c.planTime).year()),a.getVm(j).selectValue(b(c.planTime).month()+1),a.getVm(l).selectValue(c.requirementStatus),d.statusText=c.requirementStatusVal,d.isRequirementsReview=c.isRequirementsReview+'',d.requirementsReviewText=y(c.isRequirementsReview),d.isProductReview=c.isProductReview+'',d.productReviewText=x(c.isProductReview),d.requirementsReviewOpinion=c.requirementsReviewOpinion,d.productReviewOpinion=c.productReviewOpinion,d.demandReviewTime=c.requirementsReviewTime,d.productReviewTime=c.productReviewTime,d.devStartTime=c.developmentTime,d.devEndTime=c.planEndTime,d.planTypeText=c.requirementPlanTypeVal,d.planDateText=b(a.getVm(k).selectedValue+'-'+a.getVm(j).selectedValue,'YYYY-M').format('YYYY\u5E74MM\u6708'),d.remark=c.remark,d.onlineTime=c.onlineTime);},onClose:function(){var b=a.getVm(h);b.reset(),b.demandName='',b.devChargePerson='',b.demandReviewTime='',b.productReviewTime='',b.requirementsReviewOpinion='',b.productReviewOpinion='',b.devStartTime='',b.devEndTime='',a.getVm(n).select(0,!0),a.getVm(k).select(0,!0),a.getVm(j).select(0,!0),a.getVm(l).select(0,!0),b.isRequirementsReview='',b.isProductReview='',b.planTypeText='',b.planDateText='',b.belongProject=[],b.remark='',b.statusText='',b.requirementsReviewText='',b.productReviewText='',b.onlineTime='';},submit:function(o){var e,l=d.BASE_PATH+'reqRequirement/saveReqRequirement.do',j=a.getVm(m),k=a.getVm(h),f=i.addEditState,n;if(f==='view'){j.close();return;}k.validate()&&(e=k.getFormData(),f=='edit'&&(n=i.gridSelected[0],_.extend(e,{id:n})),_.extend(e,{endPlanTime:+b(e.startPlanTime).add('months',1)}),e.projectIds=[].concat(e.projectIds),c.c2s({url:l,type:'post',data:g.stringify(e),contentType:'application/json',success:function(a){a.flag&&(f=='edit'?p():(i.resetQueryFilter(),p(!0)),j.close());}}));}},i.$aeFormOpts={formId:h,field:[{selector:'.demand-name',name:'name',rule:['noempty',function(b,a){return a[0]!==!0?'\u9700\u6C42\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.belong-project',name:'projectIds',rule:function(a){return a.length?!0:'\u6240\u5C5E\u9879\u76EE\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.dev-charge-person',name:'leader',rule:function(a){return a.length?!0:'\u5F00\u53D1\u8D1F\u8D23\u4EBA';}},{selector:'.plan-type',name:'requirementPlanType',getValue:function(){return a.getVm(n).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u4E00\u79CD\u8BA1\u5212\u7C7B\u578B';}},{selector:'.plan-date',name:'startPlanTime',getValue:function(){return+b(a.getVm(k).selectedValue+'-'+a.getVm(j).selectedValue,'YYYY-M');}},{selector:'.status',name:'requirementStatus',getValue:function(){return a.getVm(l).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u4E00\u79CD\u72B6\u6001';}},{selector:'.demand-review-box',name:'isRequirementsReview',getValue:function(){return a.getVm(h).isRequirementsReview;}},{selector:'.demand-no-passed-reason',name:'requirementsReviewOpinion',rule:['maxlength',function(b,a){return a[0]!==!0?'\u539F\u56E0\u4E0D\u80FD\u8D85\u8FC7200\u5B57\u9650\u5236':!0;}]},{selector:'.product-review-box',name:'isProductReview',getValue:function(){return a.getVm(h).isProductReview;}},{selector:'.product-no-passed-reason',name:'productReviewOpinion',rule:['maxlength',function(b,a){return a[0]!==!0?'\u539F\u56E0\u4E0D\u80FD\u8D85\u8FC7200\u5B57\u9650\u5236':!0;}]},{selector:'.demand-review-time',name:'requirementsReviewTime',getValue:function(){var a=_.str.trim($(this).val());return a&&(a=+b(a,'YYYY-MM-DD')),a;}},{selector:'.product-review-time',name:'productReviewTime',getValue:function(){var a=_.str.trim($(this).val());return a&&(a=+b(a,'YYYY-MM-DD')),a;}},{selector:'.dev-start-time',name:'developmentTime',getValue:function(){var a=_.str.trim($(this).val());return a&&(a=+b(a,'YYYY-MM-DD')),a;}},{selector:'.dev-end-time',name:'planEndTime',getValue:function(){var a=_.str.trim($(this).val());return a&&(a=+b(a,'YYYY-MM-DD')),a;}},{selector:'.remark',name:'remark',rule:['maxlength',function(b,a){return a[0]!==!0?'\u5907\u6CE8\u4E0D\u80FD\u8D85\u8FC7200\u5B57\u9650\u5236':!0;}]},{selector:'.online-time',name:'onlineTime',getValue:function(){var a=_.str.trim($(this).val());return a&&(a=+b(a,'YYYY-MM-DD')),a;}}],$planTypeOpts_:{selectId:n,options:[{text:'\u8BA1\u5212\u7C7B\u578B',value:''}],selectedIndex:0},$yearOpts_:{selectId:k,options:_.map(_.range(b().year(),b().year()-10,-1),function(a){return{text:a+'\u5E74',value:a};}),selectedIndex:0},$monthOpts_:{selectId:j,options:_.map(_.range(1,13),function(a){return{text:a+'\u6708',value:a};}),selectedIndex:b().month()},$statusOpts_:{selectId:l,options:[{text:'',value:''}],selectedIndex:0},demandName:'',projectList:[],belongProject:[],devChargePerson:'',demandReviewTime:'',productReviewTime:'',devStartTime:'',devEndTime:'',isRequirementsReview:'',isProductReview:'',planTypeText:'',planDateText:'',requirementsReviewOpinion:'',productReviewOpinion:'',remark:'',statusText:'',requirementsReviewText:'',productReviewText:'',onlineTime:'',formState:'add'},i.$calendarOpts={calendarId:q,bindInputName:'',onClickDate:function(f){var d=a.getVm(h),c=a.getVm(q),e=c.bindInputName;d[e]=b(f).format('YYYY-MM-DD'),$(c.widgetElement).hide();}},i.addEditState='add',i.$watch('addEditState',function(b){a.getVm(h).formState=b;}),i.addDemand=function(){var b=a.getVm(m);i.addEditState='add',b.title='\u6DFB\u52A0\u9700\u6C42',b.open();},i.editGridItem=function(){var b=a.getVm(m),c=this.$vmodel.$model;i.gridSelected=[c.el.id+''],i.addEditState='edit',b.title='\u7F16\u8F91\u9700\u6C42',b.open();},i.viewGridItem=function(){var b=a.getVm(m),c=this.$vmodel.$model;i.gridSelected=[c.el.id+''],i.addEditState='view',b.title='\u67E5\u770B\u9700\u6C42',b.open();},i.getCalendarVm=function(){var d=a.getVm(q),b;return d||(b=$('<div class="demand-calendar fn-hide" ms-widget="calendar,$,$calendarOpts"></div>'),b.appendTo('body'),a.scan(b[0],i),d=a.getVm(q),c.regGlobalMdExcept({element:b,handler:function(){b.hide();}})),d;},i.showCalendar=function(){var a=$(this),g=_.str.trim(a.val()),c=a.offset(),d=i.getCalendarVm(),f=$(d.widgetElement),h=c.top+a.height()+1;c.top+a.height()+1+f.outerHeight()>$(e).scrollTop()+$(e).height()&&(h=c.top-f.outerHeight()),d.bindInputName=a.attr('name'),g?d.focusDate=b(g,'YYYY-MM-DD')._d:d.focusDate=new Date(),f.css({left:c.left,top:h}).show();},i.showNoPassedTip=function(){var e=a(this).data('tip'),c=f+'-no-passed-tip',g=$(this),b=$('#'+c),d=g.offset();b.length||(b=$('<div id="'+c+'" class="grid-tip"></div>'),b.html('<span class="text-content"></span><span class="icon-arrow"></span>'),b.hide().appendTo('body')),$('.text-content',b).text(e),b.css({top:d.top-b.height()-20,left:d.left-b.width()/2}).show();},i.hideNoPassedTip=function(){$('#'+f+'-no-passed-tip').hide();},i.removeGridItem=function(){var a=this.$vmodel.$model;i.gridSelected=[a.el.id+''],i._removeDemand();},i.batchRemoveGridItem=function(){i._removeDemand();},i._removeDemand=function(){var a,b;i.gridSelected.size()===0?c.alert({content:'\u8BF7\u5148\u9009\u4E2D\u9700\u6C42'}):(a=i.gridSelected.$model,b=d.BASE_PATH+'reqRequirement/deleteReqRequirement/'+a[0]+'.do',c.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u9700\u6C42\u5417\uFF1F',onSubmit:function(){c.c2s({url:b,type:'post',dataType:'json',contentType:'application/json',success:function(b){b.flag&&_.each(a,function(b){var a=-1;_.some(i.gridData.$model,function(c,d){c.id==b&&(a=d);}),a!=-1&&i.gridData.removeAt(a);});}});}}));},i.resetQueryFilter=function(){var c=b();i.demandName='',a.getVm(t).selectValue(c.year()),a.getVm(u).selectValue(0),a.getVm(r).select(0),a.getVm(o).select(0),a.getVm(s).select(0);};});a.scan(w[0]),z(function(){p(!0);}),a.getVm(h).$watch('isRequirementsReview',function(c){var b=a.getVm(h);c=='2'&&(b.demandReviewTime='');}),a.getVm(h).$watch('isProductReview',function(c){var b=a.getVm(h);c=='2'&&(b.productReviewTime='');}),w.on('mouseenter','.no-passed-flag',function(a){i.showNoPassedTip.call(this,a);}).on('mouseleave','.no-passed-flag',function(a){i.hideNoPassedTip.call(this,a);});},$remove:function(q,b){var e=b+'-pagination',f=b+'-dialog',g=b+'-form',h=b+'plan-type-selector',i=b+'project-selector',d=b+'status-selector',k=b+'year-selector',l=b+'month-selector',m=b+'plan-type-selector-',n=b+'status-selector-',o=b+'year-selector-',p=b+'month-selector-',j=b+'-calendar',c=a.getVm(j);c&&$(c.widgetElement).remove(),$(a.getVm(p).widgetElement).remove(),$(a.getVm(o).widgetElement).remove(),$(a.getVm(n).widgetElement).remove(),$(a.getVm(m).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),$(a.getVm(k).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(h).widgetElement).remove(),$(a.getVm(g).widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),$(a.getVm(e).widgetElement).remove();}}),f;});

//From origin\page\frontend\home\activesrequest\activesrequest.js
define('originpagefrontendhomeactivesrequestactivesrequestjs',['avalon','util','originwidgetautocompleteautocompletejs','originwidgetpaginationpaginationjs','originwidgetformselectjs','dialog','originwidgetformformjs','originwidgetuploaderuploaderjs'],function(a,c){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(o,e){function g(e){var f=JSON.stringify(e);c.c2s({url:b.BASE_PATH+'/activity/listActivity.do',type:'post',data:e,success:function(b){var c=a.getVm(h);b.flag&&(d.pageDataStatus=b.data.statusList,d.pageData=b.data.rows,c.total=b.data.totalSize);}});}var j=e+'-create-active-dialog',l=e+'-auto-complete-active',f=e+'-create-active-form',i=e+'-schedule',m=e+'-attach-uploader',k=e+'-brandId',h=e+'-pagination',n=b.getAppData('user'),d=a.define(e,function(e){e.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u6D3B\u52A8\u7533\u8BF7'}],e.url=b.BASE_PATH,e.pageData={},e.pageDataStatus={},e.options1=[],e.upfile='',e.createData={merchantId:0,activityTitle:'',activityType:'',attachmentId:0,description:''},e.requestData={merchantName:'',pageNumber:1,pageSize:10,status:''},e.createActive=function(){var d=a.getVm(j),g=a.getVm(f),h=a.getVm(i);e.options1.length?h.setOptions(e.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,e.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),h.setOptions(e.options1));}}),d.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',g.activityTitle='',g.description='',d.open();},e.$brandOpts={autocompleteId:k,placeholder:'\u8BF7\u6307\u5B9A\u5546\u6237',delayTime:300,onChange:function(a,d){a.length?c.c2s({url:b.BASE_PATH+'synMerchant/getSynMerchantInfoByUserId.do',data:{merchantName:a},success:function(a){var b;a.flag&&(b=a.data,d(_.map(b,function(a){return a.text=a.merchant_name||'\u672A\u77E5',a.value=a.merchant_id,a;})));}},{mask:!1}):d([]);},onSelect:function(c){var b=a.getVm(k).getOptionByValue(c);d.createData.$model.merchantId=b.merchant_id;}},e.$attachUploaderOpts={uploaderId:m,uploadifyOpts:{uploader:b.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:n.sessionId};},width:80,height:30,progressData:'speed'},onSuccessResponseData:function(b,c){if(b=JSON.parse(b),b.flag){var a=b.data;d.createData.$model.attachmentName=a.attachmentName,d.createData.$model.originalFileName=a.originalFileName,d.createData.$model.fileSize=a.fileSize,e.upfile=a.originalFileName;}}},e.$createActiveDialogOpts={dialogId:j,autoFocusInput:!1,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f);b.reset(),b.activityTitle='',b.description='',d.complaintsId=0,e.upfile='';},submit:function(q){var h,m=a.getVm(j),k=a.getVm(f),n=a.getVm(i),p=a.getVm(l);if(k.validate()){if(h=k.getFormData(),d.createData.$model.merchantId==0)return c.confirm({content:'\u8BF7\u9009\u62E9\u5546\u6237!',onSubmit:function(){}}),!1;d.createData.$model.activityTitle=h.activityTitle,d.createData.$model.description=h.description,d.createData.$model.activityType=n.selectedValue,d.createData.$model.attachmentId=0;var o=JSON.stringify(d.createData.$model);c.c2s({url:b.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:o,success:function(a){a.flag==1&&(g(e.requestData.$model),m.close(),d.complaintsId=0);}});}}},e.$createActiveFormOpts={formId:f,field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},e.$scheduleOpts={selectId:i,options:[],selectedIndex:1},e.changeStatus=function(b){var c=a.getVm(h);b=''+b,e.requestData.status=b,e.requestData.pageNumber=1,c.currentPage=1,g(e.requestData.$model);},e.search=function(){g(e.requestData.$model);},e.$paginationOpts={paginationId:h,total:0,onJump:function(c,e){var b=a.getVm(h);d.requestData.pageNumber=b.currentPage,g(d.requestData.$model);}};});a.scan(o[0]),g(d.requestData.$model);},$remove:function(a,b){}}),d;});

//From origin\page\frontend\home\attachmentmanage\attachmentmanage.js
define('originpagefrontendhomeattachmentmanageattachmentmanagejs',['avalon','util','originwidgetpaginationpaginationjs'],function(a,f){var e=this,b=e.erp,d={},c=[];return _.extend(d,{$init:function(i,h,j){function g(g){var c=JSON.stringify(g);f.c2s({url:b.BASE_PATH+'mailAndAttachment/listAttachment.do',type:'post',contentType:'application/json',data:c,success:function(c){var b,f=a.getVm(e('paginationId'));c.flag&&(b=c.data,f.total=b.totalSize,d.pageData=b.rows);}});}var e=function(b){var a=h+b;return c.push(a),a;},d=a.define(h,function(c){c.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:''},{text:'\u9644\u4EF6\u7BA1\u7406'}];var f='';switch(j.route){case'/sales/home/attachmentmanage':f='#/sales/home';break;case'/frontend/home/attachmentmanage':f='#/frontend/home';break;case'/backend/attachmentmanage':f='#/backend/customerservice';break;}c.navCrumbs[0].href=f,c.url=b.BASE_PATH,c.pageUserId=b.getAppData('user').id,c.pageData={},c.statusTabs='',c.requestData={merchantId:'',attachmentType:'plan',merchantName:'',pageNumber:1,pageSize:10,userId:c.pageUserId},c.changeStatus=function(c){var b=a.getVm(e('paginationId'));b.currentPage=1,d.requestData.pageNumber=1,d.requestData.attachmentType=c,d.requestData.merchantName='',d.pageData={},g(d.requestData.$model);},c.search=function(){g(d.requestData.$model);},c.$paginationOpts={paginationId:e('paginationId'),total:0,onJump:function(c,f){var b=a.getVm(e('paginationId'));d.requestData.pageNumber=b.currentPage,g(d.requestData.$model);}};});a.scan(i[0]),g(d.requestData.$model);},$remove:function(b,d){_.each(c,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),c.length=0;}}),d;});

//From origin\page\frontend\home\complaintsmanage\complaintsmanage.js
define('originpagefrontendhomecomplaintsmanagecomplaintsmanagejs',['avalon','util','originwidgetautocompleteautocompletejs','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetuploaderuploaderjs'],function(a,c){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(p,e,n){function f(f){var e=JSON.stringify(f);c.c2s({url:b.BASE_PATH+'sysCustomerComplaint/querySysCustomerComplaintList.do',type:'post',contentType:'application/json',data:e,success:function(e){var b,f=a.getVm(g);if(e.flag){b=e.data,f.total=b.totalSize;for(var c=0,h=b.rows.length;c<h;c++)b.rows[c].state=0;d.pageData=b.rows;}}});}var i=e+'-submit-com-dialog',k=e+'-auto-complete-active',h=e+'-submit-com-form',l=e+'-schedule',j=e+'-brandId',m=e+'-attach-uploader',g=e+'-pagination',o=b.getAppData('user'),d=a.define(e,function(e){e.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:''},{text:'\u6295\u8BC9\u7BA1\u7406'}];var p='';switch(n.route){case'/sales/home/complaintsmanage':p='#/sales/home';break;case'/frontend/home/complaintsmanage':p='#/frontend/home';break;case'/backend/complaintsmanage':p='#/backend/customerservice';break;}e.navCrumbs[0].href=p,e.upfile='',e.complaintsId=0,e.merchantId=parseInt(n.params.id),e.url=b.BASE_PATH,e.pageData={},e.options1=[],e.checkBoxArr=[],e.sysAttachment={},e.statusTabs='',e.requestData={merchantId:e.merchantId,merchantName:'',pageNumber:1,pageSize:10,customerComplaintStatus:''},e.changeStatus=function(c){var b=a.getVm(g);d.requestData.customerComplaintStatus=c,e.requestData.pageNumber=1,b.currentPage=1,f(d.requestData.$model);},e.search=function(){f(d.requestData.$model);},e.modStatus=function(a){a=a.toString(),c.c2s({url:b.BASE_PATH+'activity/updateRemind.do',type:'post',data:{id:a},success:function(a){f(d.requestData.$model);}});},e.$paginationOpts={paginationId:g,total:0,onJump:function(c,e){var b=a.getVm(g);d.requestData.pageNumber=b.currentPage,f(d.requestData.$model);}},e.showCon=function(){var a=this.$vmodel.$model.el;a.state=1;},e.hideCon=function(){var a=this.$vmodel.$model.el;a.state=0;},e.submitCom=function(){var d=a.getVm(i),f=a.getVm(h);e.options1.length||c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000049',success:function(a){var b;a.flag&&(b=a.data,e.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}));}}),d.title='\u63D0\u4EA4\u6295\u8BC9',f.complaintTitle='',f.complaintContent='',d.open();},e.addType=function(){var b=this.$vmodel.$model.el.value;if(this.checked)e.checkBoxArr.$model.push(b);else for(var a=0,c=e.checkBoxArr.$model.length;a<c;a++)b==e.checkBoxArr.$model[a]&&e.checkBoxArr.$model.splice(a,1);},e.$submitComDialogOpts={dialogId:i,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(h);b.reset(),d.complaintsId=0,b.complaintTitle='',b.complaintContent='',d.upfile='';},submit:function(p){var g,l=a.getVm(i),j=a.getVm(h),o=a.getVm(k);if(j.validate()){var m=new Date().getTime();if(g=j.getFormData(),g.merchantId=parseInt(d.complaintsId),!g.merchantId)return c.confirm({content:'\u8BF7\u9009\u62E9\u5546\u6237!',onSubmit:function(){}}),!1;g.customerComplaintType=d.checkBoxArr.$model,g.sysAttachment=d.sysAttachment.$model,g.complaintTime=m;var n=JSON.stringify(g);c.c2s({url:b.BASE_PATH+'sysCustomerComplaint/saveSysCustomerComplaint.do',type:'post',contentType:'application/json',data:n,success:function(a){a.flag==1&&(f(e.requestData.$model),l.close(),d.complaintsId=0);}});}}},e.$submitComFormOpts={formId:h,field:[{selector:'.complaintTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.complaintContent',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],complaintTitle:'',complaintContent:''},e.$scheduleOpts={selectId:l,options:[],selectedIndex:1},e.$attachUploaderOpts={uploaderId:m,uploadifyOpts:{uploader:b.BASE_PATH+'sysCustomerComplaint/uploadFiles.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:o.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=JSON.parse(a),a.flag){var b=a.data[0];d.sysAttachment.$model.originalFileName=b.originalFileName,d.sysAttachment.$model.attachmentName=b.fileName,d.sysAttachment.$model.attachmentSize=c.size.toString(),d.sysAttachment.$model.attachmentSuffix=c.type,d.upfile=b.originalFileName;}}},e.$brandOpts={autocompleteId:j,placeholder:'\u8BF7\u6307\u5B9A\u5546\u6237',delayTime:300,onChange:function(a,d){a.length?c.c2s({url:b.BASE_PATH+'synMerchant/getSynMerchantInfoByUserId.do',data:{merchantName:a},success:function(a){var b;a.flag&&(b=a.data,d(_.map(b,function(a){return a.text=a.merchant_name||'\u672A\u77E5',a.value=a.merchant_id,a;})));}},{mask:!1}):d([]);},onSelect:function(c){var b=a.getVm(j).getOptionByValue(c);d.complaintsId=b.merchant_id;}};});a.scan(p[0]),f(d.requestData.$model);},$remove:function(a,b){}}),d;});

//From origin\page\frontend\home\customer\customer.js
define('originpagefrontendhomecustomercustomerjs',['avalon','util','json','moment','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs','originmodulecardrulesettingcardrulesettingjs','originwidgeteditoreditorjs','originmoduleinterviewinterviewjs','originmodulesurveysurveyjs','originmoduleaddressaddressjs'],function(a,c,d){var g=this,b=g.erp,f={},e=[];return _.extend(f,{$init:function(n,l,j){function i(e,f,h){var a=d.stringify(e);g.pageData=[],c.c2s({url:b.BASE_PATH+f,type:'post',contentType:'application/json',data:a,success:h});}function m(e){var b;if(e.flag){b=e.data;var a={};a.productList=b.productList,a.filePath=b.filePath;var c=b.merchantInfo;for(var d in c){var f=c.hasOwnProperty(d);f&&(a[d]=c[d]);}a.attachment_name?a.imgUrl=g.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=g.path+'portal/origin/asset/image/merchant-default-logo.jpg',g.merchantData=a,g.navCrumbs[1].text=a.merchant_name;}}function p(d){var b,c,e=h.id;if(d.flag){b=d.data,g.stepData=b,c=b[0].listUsers;var f=j.params.type;if(f=='sale')return;for(var a=0;a<c.length;a++)if(e==c[a].id){g.promise=!0;return;}else g.promise=!1;}}var f=function(b){var a=l+b;return e.push(a),a;},h=b.getAppData('user'),o=$('.upload-info',n),k=l+'-cardrulesetting',g=a.define(l,function(e){function w(){l.length=0;for(var c=1;c<=8;c++){var a='checkoucon'+c;$('.'+a).blur(function(){_.str.trim($(this).val())&&($(this).removeClass('valid-error-field'),$(this).closest('tr').find('.ff-value-tip').hide());});var d=$('.'+a).prevAll('input');if(d.length){if(d[0].checked==1){var b={selector:'.'+a,rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]};l.push(b);}}else{var b={selector:'.'+a,rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]};l.push(b);}}return l;}function v(b,c){b=$(b);for(var a=0,d=c.length;a<d;a++)$(c[a],b).attr('disabled','disabled');}e.localHref=function(a){c.jumpPage(a+e.merchantId);},e.promise=!1,e.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:''}],e.path=b.BASE_PATH,e.merchantId=parseInt(j.params.id);var p=j.params.type;p=='sale'&&(e.navCrumbs[0].href='#/sales/home'),e.stepData={},e.imgUrl='';var q=function(){e.merchantData={productList:[],filePath:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',format_name:'',attachment_name:'',attachment_path:''};};q(),e.stepEnd=function(h,a,i,j){var f={id:h,onlineProcessStatus:a},g=d.stringify(f);c.confirm({content:i,onSubmit:function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/updateFesOnlineProcessStatus.do',type:'post',contentType:'application/json',data:g,success:function(c){if(c.flag){var b=c.data;e.stepData[b.stepId-1].onlineProcessStatus=b.onlineProcessStatus,e.stepData[b.stepId-1].sysOperationLogVOs.push(b),e.stepData[9].onlineProcessStatus=b.finalStatus,b.stepId-1==3&&(e.stepData[3].onlineProcessStatus=a);}}});}});},e.removeUpload=function(d,f,a){c.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u9644\u4EF6\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/deleteAttachment/'+d+'/'+f+'.do',type:'get',success:function(c){if(c.flag){var b=c.data;b.stepId==9?e.stepData[b.stepId-1].listAttachmentAndOperateLog.splice(a,1):e.stepData[b.stepId-1].fesSysAttachments.splice(a,1),e.stepData[b.stepId-1].onlineProcessStatus=b.onlineProcessStatus;}}});}});},e.$surveyOpts={surveyId:f('-surveyModule'),readonly:'',merchantId:'',callFn:function(b){if(b.flag==1){var a=g.stepData[0].id;function c(a){a.flag&&g.stepData.splice(0,1,a.data[0]);}i({processId:a},'fesOnlineProcess/listFesOnlineProcesss.do',c);}}},e.addSurvey=function(c){var b=a.getVm(f('-surveyModule'));c=='04'||!e.promise?b.readonly=1:b.readonly=0,b.moduleType='fes',b.merchantId=g.merchantId,$(this).attr('data-id')?b.requestData={merchantId:g.merchantId,id:$(this).attr('data-id')}:b.requestData={merchantId:g.merchantId},b.open();},e.removeResearch=function(e,f){var a={id:e,moduleType:'fes',storeId:f};a=d.stringify(a),c.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8C03\u7814\u5355\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'mktShopSurvey/deleteMktShopSurvey.do',type:'post',contentType:'application/json',data:a,success:function(a){if(a.flag==1&&a.flag==1){var b=g.stepData[0].id;function c(a){a.flag&&g.stepData.splice(0,1,a.data[0]);}i({processId:b},'fesOnlineProcess/listFesOnlineProcesss.do',c);}}});}});},e.$interviewOpts={interviewId:f('-interviewModule'),sessionId:'',readonly:'',moduleType:'',merchantId:'',callFn:function(c){function b(a){a.flag&&g.stepData.splice(0,1,a.data[0]);}var a=g.stepData[0].id;i({processId:a},'fesOnlineProcess/listFesOnlineProcesss.do',b),i({merchantId:g.merchantId},'synMerchant/getMerchantInfoByOrder.do',m);}},e.addInterval=function(c){var b=a.getVm(f('-interviewModule'));b.requestData={merchantId:g.merchantId},b.sessionId=h.sessionId,c=='04'||!e.promise?b.readonly=1:b.readonly=0,b.moduleType='fes',b.merchantId=g.merchantId,b.requestData={merchantId:g.merchantId},b.open();},e.$addressOpts={addressId:f('-addressModule'),readonly:'',moduleType:'fes',merchantId:''},e.addCommunication=function(h){var e=a.getVm(f('-addressModule'));e.readonly=0,e.callFn=function(){c.c2s({url:b.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:d.stringify({merchantId:g.merchantId}),success:function(c){var d;if(c.flag){d=c.data.rows;var e=a.getVm(h),b=_.map(d,function(a){return{text:a.name,value:a.id};});b.unshift({text:'\u8BF7\u9009\u62E9',value:''}),e.setOptions(b);}}});},$(this).attr('data-id')?e.requestData={merchantId:g.merchantId,id:$(this).attr('data-id')}:e.requestData={merchantId:g.merchantId},e.open();},e.$step3AttachUploaderOpts={uploaderId:f('step3AttachUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId,processId:e.stepData[2].id};},width:140,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=d.parse(a),a.flag){var b=a.data;e.stepData[2].fesSysAttachments.push(b),e.stepData[b.stepId-1].onlineProcessStatus=b.onlineProcessStatus;}}},e.$step4AttachUploaderOpts={uploaderId:f('step4AttachUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId,processId:e.stepData[3].id};},width:140,height:30,progressData:'speed'},onSuccessResponseData:function(b,c){if(b=d.parse(b),b.flag){var a=b.data;e.stepData[3].fesSysAttachments.length?e.stepData[3].fesSysAttachments.splice(0,1,a):e.stepData[3].fesSysAttachments.push(a),e.stepData[a.stepId-1].onlineProcessStatus=a.onlineProcessStatus;}}};var n=function(){e.messageRequestData={},e.messageData={},e.controlWitch=function(a){if(this.$vmodel.$model.el.isAvail)if(a=='parent'){this.$vmodel.$model.el.isAvail=!1;var b=this.$vmodel.$model.el.child,e=this.$vmodel.$model.el.id;if(b)for(var c=0;c<b.length;c++)b[c].isAvail=!1;$('.input'+e+'>input').attr('checked',!1);}else a=='child'&&(this.$vmodel.$model.el.isAvail=!1);else{var d=this.$vmodel.$model.el;a=='parent'?d.isAvail=!0:a=='child'&&(d.isAvail=!0);}},e.appendValue=function(d){function e(b,c,d){for(var a=0;a<b.length;a++)if(b[a].id==c){b[a].templateTxt=d;return;}else b[a].child&&b[a].child instanceof Array&&e(b[a].child,c,d);}var a='.textarea'+d,b=this.innerHTML,f=$(a).val();if(f.indexOf(b)!=-1)return c.confirm({content:'\u4E0D\u80FD\u91CD\u590D\u6DFB\u52A0\u5185\u5BB9',onSubmit:function(){}}),!1;c.appendTextAtCursor(a,b);var h=$(a).val();e(g.messageData.$model,d,h);},e.openMessageRules=function(i){var h=a.getVm(f('messageRulesId'));i=='04'||!g.promise?h.readonly=!0:h.readonly=!1,c.c2s({url:b.BASE_PATH+'trade/messageTemplate/listMessageTemplates.do',type:'post',data:{merchantId:g.merchantId},success:function(k){if(k.flag==1){var a=k.data,f=[],g=[],j=[];for(var i=0;i<a.length;i++)j.push(a[i].transCode);var l=d.stringify(j);c.c2s({url:b.BASE_PATH+'trade/messageTemplate/listSmsTmpFields.do',type:'post',contentType:'application/json',data:l,success:function(j){if(j.flag==1){var d=j.data;for(var b=0;b<a.length;b++)for(var i in d){var k=d.hasOwnProperty(i);k&&a[b].transCode==i&&(a[b].listType=[],a[b].listType=d[i]);}for(var b=0;b<a.length;b++)a[b].parent?g.push(a[b]):f.push(a[b]);for(var b=0;b<f.length;b++)for(var c=0;c<g.length;c++)g[c].parent==f[b].id&&(f[b].child||(f[b].child=[]),f[b].child.push(g[c]));e.messageData=f,h.title='\u4EA4\u6613\u77ED\u4FE1\u89C4\u5219',h.open();}}});}}});},e.$messageRulesOpts={dialogId:f('messageRulesId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="close">\u786E&nbsp;\u5B9A</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},width:670,readonly:!1,onOpen:function(){},onClose:function(){},submit:function(i){var h=[];c.c2s({url:b.BASE_PATH+'trade/smstmpfeild/listTradeSmsTmpFeilds.do',type:'post',success:function(s){if(s.flag==1){h=s.data;var k=[],m=g.messageData.$model;for(var i=0;i<m.length;i++)k.push(m[i]),m[i].child&&(k=k.concat(m[i].child));for(var i=0;i<k.length;i++){delete k[i].listType,delete k[i].child;var l=k[i].templateTxt.match(/\[([^\]])*\]/g);try{for(var j=0;j<l.length;j++)l[j]=l[j].replace(/]|\[/g,'');var p=[];for(var j=0;j<h.length;j++)for(var o=0;o<l.length;o++)l[o]==h[j].description&&p.push(h[j].fieldName);k[i].templateFeilds=p.join();}catch(a){}for(var j=0;j<h.length;j++){var n=k[i].templateTxt,q=h[j].description;if(n.indexOf('['+q+']')!=-1){var t=RegExp('\\['+q+']','g');n=n.replace(t,h[j].fieldType);}k[i].templateTxt=n;}}for(var i=0;i<k.length;i++)k[i].merchantId=g.merchantId,k[i].messageTemplate=k[i].templateTxt;var r=d.stringify(k);c.c2s({url:b.BASE_PATH+'trade/messageTemplate/saveMessageTemplates.do',type:'post',contentType:'application/json',data:r,success:function(c){if(c.flag==1){var b=c.data,d=a.getVm(f('messageRulesId'));d.close(),e.stepData[4].tradeMessageTemplates.push(b),e.stepData[4].sysOperationLogVOs.push(b),e.stepData[4].onlineProcessStatus=b.onlineProcessStatus;}}});}}});}},e.$messageRulesFormOpts={formId:f('messageRulesFormId'),field:[{selector:'.beginTime',name:'beginTime',rule:[]}]};};n(),e.$cardrulesettingOpts={cardrulesettingId:k,merchantId:j.params.id/1,onUpdateCallback:function(b){if(b.flag){var a=b.data;e.stepData[4].tradeCardtypes.push(a),e.stepData[4].sysOperationLogVOs.push(a),e.stepData[4].onlineProcessStatus=a.onlineProcessStatus;}}},e.openCardRuleDialog=function(b){(b=='04'||!g.promise)&&a.getVm(k).setReadonly(1),a.getVm(k).open();};var s=function(){e.carRequestData={processId:0,merchantId:e.merchantId,fesOpenCardApplicationDtls:[{cardName:'',cardAmount:'',validityTerm:1,isContainFour:'0',isContainSeven:'0'}]},e.openCard=function(c){var b=a.getVm(f('cardDialog'));b.title='\u5F00\u5361\u7533\u8BF7',e.carRequestData.processId=c,b.open();},e.changeRedio4=function(a){this.$vmodel.$model.el.isContainFour=a;},e.changeRedio7=function(a){this.$vmodel.$model.el.isContainSeven=a;},e.$addCardDialogOpts={dialogId:f('cardDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button ms-if="save" type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},save:1,width:530,onClose:function(){var b=a.getVm(f('cardForm'));b.reset(),b.cardName='',b.cardAmount='',b.validityTerm='';},submit:function(n){var k,l=a.getVm(f('cardDialog')),m=a.getVm(f('cardForm'));if(m.validate()){var j=g.carRequestData.$model.fesOpenCardApplicationDtls;for(var e=0;e<j.length;e++)j[e].cardAmount=Number(j[e].cardAmount),j[e].validityTerm=Number(j[e].validityTerm);k=d.stringify(g.carRequestData.$model),c.c2s({url:b.BASE_PATH+'applySetting/saveOpenCardApply.do',type:'post',contentType:'application/json',data:k,success:function(a){a.flag==1&&(l.close(),i({merchantId:g.merchantId,userId:h.id},'fesOnlineProcess/listFesOnlineProcesss.do',listWaiting));}});}}},e.$addCardFormOpts={formId:f('cardForm'),field:[{selector:'.cardName',rule:['noempty',function(b,a){return a[0]!==!0?'\u5361\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.cardAmount',rule:['noempty',function(b,c){if(c[0]!==!0)return'\u5F00\u5361\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A';else{var a=/^[0-9]\d*$/;return a.test(b)?!0:'\u5F00\u5361\u6570\u91CF\u5FC5\u987B\u4E3A\u6570\u5B57';}}]}],cardName:'',cardAmount:'',validityTerm:''},e.readCard=function(h){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/getFesOpenCardApplicationsAndDtls.do',type:'post',contentType:'application/json',data:d.stringify({processId:h}),success:function(d){if(d.flag==1){var b=d.data[0];for(var c=0;c<b.fesOpenCardApplicationDtls.length;c++)b.fesOpenCardApplicationDtls[c].validityTerm||(b.fesOpenCardApplicationDtls[c].validityTerm='');g.carRequestData=b;var h=a.getVm(f('cardDialog'));h.save=0,e.openCard();}}});},e.addCarList=function(){var a={cardName:'',cardAmount:'',validityTerm:1,isContainFour:0,isContainSeven:'0'};e.carRequestData.fesOpenCardApplicationDtls.push(a);},e.removeCarList=function(){e.carRequestData.fesOpenCardApplicationDtls.pop();};};s(),e.setp7ReqData={id:0,processId:0,accessId:1,description:'',fesMaterialRequestDtlVOs:[{materialRequestType:'1',specificationType:'1',description:''},{materialRequestType:'2',specificationType:'1',description:''},{materialRequestType:'3',specificationType:'1',description:''},{materialRequestType:'4',specificationType:'1',description:''},{materialRequestType:'5',specificationType:'1',description:''},{materialRequestType:'6',specificationType:'1',description:''},{materialRequestType:'7',specificationType:'1',description:''}]},e.changeRadioStatus=function(d,g,b){var c=a.getVm(f('step7DialogId'));c.readonly||(e.setp7ReqData.fesMaterialRequestDtlVOs[d].specificationType=g,$(this).children('input:radio')[0].checked=!0,$(this).closest('tr').find('input').removeClass('valid-error-field'),$(this).closest('tr').find('.ff-value-tip').hide(),b&&$('.'+b)[0].focus());},e.$step7AttachUploaderOpts={uploaderId:f('step7AttachUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId,processId:e.stepData[6].id,typeId:15};},width:140,height:30,progressData:'speed'},onSuccessResponseData:function(b,c){if(b=d.parse(b),b.flag){var a=b.data;e.stepData[6].fesSysAttachments.length?e.stepData[6].fesSysAttachments.splice(0,1,a):e.stepData[6].fesSysAttachments.push(a),e.stepData[a.stepId-1].onlineProcessStatus=a.onlineProcessStatus;}}},e.step7Input=function(h){function i(){c.c2s({url:b.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:d.stringify({merchantId:g.merchantId}),success:function(b){if(b.flag==1){var c=b.data.rows,d=a.getVm(f('step7NameSelect')),h=_.map(c,function(a,b){return{text:a.name,value:a.id};});d.setOptions(h),e.title='\u8BBE\u8BA1\u9700\u6C42\u5355',(g.stepData[6].onlineProcessStatus!=18&&g.stepData[6].onlineProcessStatus!=19||!g.promise)&&(e.readonly=1,$('input',e.widgetElement).prop('disabled',!0),$('textarea',e.widgetElement).prop('disabled',!0),$('span',e.widgetElement).off('click')),e.open();}}});}var e=a.getVm(f('step7DialogId')),j=a.getVm(f('step7FormId'));h?c.c2s({url:b.BASE_PATH+'fesOnlineProcess/getFesMaterialRequestById.do',type:'post',contentType:'application/json',data:d.stringify({id:h}),success:function(a){a.flag==1&&(g.setp7ReqData=a.data,i());}}):i();},e.$step7DialogOpts={dialogId:f('step7DialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u5173&nbsp;\u95ED</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},readonly:0,onOpen:function(){},onClose:function(){g.setp7ReqData={id:0,processId:0,accessId:1,description:'',fesMaterialRequestDtlVOs:[{materialRequestType:'',specificationType:'',description:''},{materialRequestType:'',specificationType:'',description:''},{materialRequestType:'',specificationType:'',description:''},{materialRequestType:'',specificationType:'',description:''},{materialRequestType:'',specificationType:'',description:''},{materialRequestType:'',specificationType:'',description:''},{materialRequestType:'',specificationType:'',description:''}]};var b=a.getVm(f('step7DialogId'));c.testCancel($(b.widgetElement)[0]);},width:600,submit:function(j){var e=a.getVm(f('step7DialogId')),h=a.getVm(f('step7FormId'));if(w(),h.validate()){g.setp7ReqData.processId=g.stepData[6].id,g.setp7ReqData.accessId=a.getVm(f('step7NameSelect')).selectedValue;var i=d.stringify(g.setp7ReqData.$model);c.c2s({url:b.BASE_PATH+'fesOnlineProcess/saveFesMaterialRequestAndDtls.do',type:'post',contentType:'application/json',data:i,success:function(a){if(a.flag==1){var b=a.data;g.stepData.splice(6,1,b),e.close();}}});}}};var l=[];e.$step7FormOpts={formId:f('step7FormId'),field:l},e.$step7NameSelectOpts={selectId:f('step7NameSelect'),options:[],selectedIndex:1},e.$addEditDialogOpts={dialogId:f('addEditDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('addEditFormId'));b.reset(),b.beginTime='',b.endTime='',b.address='',b.trainer='',b.content='';},submit:function(m){var g,k,l=a.getVm(f('addEditDialogId')),i=a.getVm(f('addEditFormId')),h=e.step9AddEditState,j=e.stepData.$model[8].id;i.validate()&&(g=i.getFormData(),k=b.BASE_PATH+'fesOnlineProcess/saveFesTrainPlan.do',h=='edit'?(g.processId=j,g.id=e.stepData.$model[8].fesTrainPlans[0].id):h=='add'&&(g.processId=j),g.beginTime=moment(g.beginTime,'YYYY-MM-DD'),g.endTime=moment(g.endTime,'YYYY-MM-DD'),g=d.stringify(g),c.c2s({url:k,type:'post',contentType:'application/json',data:g,success:function(b){if(b.flag==1){var a=b.data;h=='edit'?(e.stepData[8].fesTrainPlans[0].beginTime=a.beginTime,e.stepData[8].fesTrainPlans[0].endTime=a.endTime,e.stepData[8].fesTrainPlans[0].address=a.address,e.stepData[8].fesTrainPlans[0].trainer=a.trainer,e.stepData[8].fesTrainPlans[0].content=a.content):h=='add'&&e.stepData[8].fesTrainPlans.push(a),l.close();}}}));}},e.$addEditFormOpts={formId:f('addEditFormId'),field:[{selector:'.beginTime',name:'beginTime',rule:['noempty',function(b,a){return a[0]!==!0?'\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.endTime',name:'endTime',rule:['noempty',function(b,a){return a[0]!==!0?'\u7ED3\u675F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.address',name:'address',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BF7\u586B\u5199\u57F9\u8BAD\u5730\u70B9':!0;}]},{selector:'.trainer',name:'trainer',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BF7\u586B\u5199\u53C2\u4E0E\u4EBA\u5458':!0;}]},{selector:'.content',name:'content',rule:['noempty',function(b,a){return a[0]!==!0?'\u57F9\u8BAD\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],beginTime:'',endTime:'',address:'',trainer:'',content:''},e.openEditStep9=function(){var d=a.getVm(f('addEditDialogId')),b=a.getVm(f('addEditFormId')),c=this.$vmodel.$model.el.fesTrainPlans[0];d.title='\u57F9\u8BAD\u8BA1\u5212',b.beginTime=moment(c.beginTime).format('YYYY-MM-DD'),b.endTime=moment(c.endTime).format('YYYY-MM-DD'),b.address=c.address,b.trainer=c.trainer,b.content=c.content,e.step9AddEditState='edit',d.open();},e.openAddStep9=function(){var b=a.getVm(f('addEditDialogId')),c=a.getVm(f('addEditFormId'));b.title='\u57F9\u8BAD\u8BA1\u5212',e.step9AddEditState='add',b.open();},e.$startDateOpts={calendarId:f('startDateCalendarId'),minDate:new Date(),onClickDate:function(c){var b=a.getVm(f('addEditFormId'));b.beginTime=moment(c).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},e.openStartDateCalendar=function(){var g=a.getVm(f('addEditFormId')),h=$(this),b=a.getVm(f('startDateCalendarId')),d,i=h.offset();b?d=$(b.widgetElement):(d=$('<div ms-widget="calendar,$,$startDateOpts"></div>'),d.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(d[0],[e]),b=a.getVm(f('startDateCalendarId')),c.regGlobalMdExcept({element:d,handler:function(){d.hide();}})),g.beginTime?b.focusDate=moment(g.beginTime,'YYYY-MM-DD')._d:b.focusDate=new Date(),g.endTime&&(b.maxDate=moment(g.endTime,'YYYY-MM-DD')._d),d.css({top:i.top+h.outerHeight()-1,left:i.left}).show();},e.$endDateOpts={calendarId:f('endDateCalendarId'),minDate:new Date(),onClickDate:function(c){var b=a.getVm(f('addEditFormId'));b.endTime=moment(c).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},e.openEndDateCalendar=function(){var g=a.getVm(f('addEditFormId')),h=$(this),b=a.getVm(f('endDateCalendarId')),d,i=h.offset();b?d=$(b.widgetElement):(d=$('<div ms-widget="calendar,$,$endDateOpts"></div>'),d.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(d[0],[e]),b=a.getVm(f('endDateCalendarId')),c.regGlobalMdExcept({element:d,handler:function(){d.hide();}})),g.endTime?b.focusDate=moment(g.endTime,'YYYY-MM-DD')._d:b.focusDate=new Date(),g.beginTime&&(b.minDate=moment(g.beginTime,'YYYY-MM-DD')._d),d.css({top:i.top+h.outerHeight()-1,left:i.left}).show();},e.$step9AttachUploaderOpts={uploaderId:f('attachUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId,processId:e.stepData[8].id,typeId:'5'};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(b,c){if(b=d.parse(b),b.flag){var a=b.data;e.stepData[a.stepId-1].listAttachmentAndOperateLog.push(a),e.stepData[a.stepId-1].onlineProcessStatus=a.onlineProcessStatus;}}};var u=function(){e.step9AccessId=0,e.acessRequestData=[],e.step9Access=function(h,k,m){var l=a.getVm(f('addAccessForm')),g=a.getVm(f('addAccessDialog')),j;if(v(l.widgetElement,['input','textarea']),h=='add'){e.step9AccessId=0;var i=d.stringify({documentType:'1'});j='sysQuestion/listSysQuestions.do';}else if(h=='edit'){e.step9AccessId=k;var i=d.stringify({id:k});j='sysDocument/querySysDocumentById.do';}c.c2s({url:b.BASE_PATH+j,type:'post',contentType:'application/json',data:i,success:function(c){function d(c){var d=[];for(var a=0;a<c.length;a++){var b={};b.optionContent=c[a].optionContent,b.isSelected=c[a].isSelected,b.isOpenTextarea=c[a].isOpenTextarea,b.tip=c[a].tip,b.isOpenTextarea=c[a].isOpenTextarea,c[a].comment?b.comment=c[a].comment:b.comment='',d.push(b);}return d;}function i(b){var e=[];for(var a=0;a<b.length;a++){var c={};c.questionId=b[a].id,c.questionType=b[a].question_type,c.title=b[a].title,c.tip=b[a].tip,b[a].comment?c.comment=b[a].comment:c.comment='',b[a].sysQuestionOptionList&&(c.sysDocumentDtlOptionList=d(b[a].sysQuestionOptionList)),e.push(c);}return e;}function j(){var c=a.getVm(f('addAccessDialog')),d=a.getVm(f('addAccessForm'));c.readonly=!0;var b=d.widgetElement,e=$('input',$(b)).attr('disabled','disabled'),g=$('textarea',$(b)).attr('disabled','disabled');}if(c.flag==1)if(h=='add'){var b=c.data;b=i(b),e.acessRequestData=b,g.title='\u56DE\u8BBF\u5355',g.open();}else if(h=='edit'){var b=c.data.sysDocumentDtlList;e.acessRequestData=b,g.title='\u56DE\u8BBF\u5355',m=='04'&&j(),g.open();}}});},e.radioBox=function(c){var b=c.sysDocumentDtlOptionList;for(var a=0;a<b.length;a++)b[a].isSelected='0',b[a].comment='';this.$vmodel.$model.el.isSelected='1',$(this).closest('li').find('textarea').removeClass('valid-error-field'),$(this).closest('li').find('.ff-value-tip').hide();},e.checkBox=function(){var a=this.$vmodel.$model.el;a.isSelected=='1'?a.isSelected='0':a.isSelected='1';},e.$addAccessDialogOpts={dialogId:f('addAccessDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u5173&nbsp;\u95ED</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},width:600,readonly:!0,onOpen:function(){},onClose:function(){var b=a.getVm(f('addAccessDialog')),c=a.getVm(f('addAccessForm'));c.reset(),b.readonly=!1;},submit:function(m){var j=a.getVm(f('addAccessDialog')),l=a.getVm(f('addAccessForm')),e={},k;l.testVal()&&(g.step9AccessId?(e.id=g.step9AccessId,k='sysDocument/saveDocumentAndUpdateStatusForStep9.do'):k='sysDocument/saveDocumentAndUpdateStatusForStep9.do',e.documentType=1,e.merchantId=g.merchantId,e.sysDocumentDtlList=g.acessRequestData.$model,e=d.stringify(e),c.c2s({url:b.BASE_PATH+k,type:'post',contentType:'application/json',data:e,success:function(a){a.flag==1&&(j.close(),j.readonly=!1,i({merchantId:g.merchantId,userId:h.id,resourceRemark:'end_custom_service'},'fesOnlineProcess/listFesOnlineProcesss.do',listWaiting));}}));}},e.$addAccessFormOpts={formId:f('addAccessForm'),testVal:function(){var d=!0,h=a.getVm(f('addAccessForm')),i=h.widgetElement,e=$('.questions',$(i));for(var c=0;c<e.length;c++){var b=$(e[c]);if(!_.str.trim(b.val())){b.blur(function(){var b=_.str.trim($(this).val());if(!b){$(this).addClass('valid-error-field');var a=$(this).next('.ff-value-tip');a?a.addClass('valid-error').html('\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01').show():$(this).parent().append("<div class='ff-value-tip valid-error'>\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A</div>");}else $(this).removeClass('valid-error-field'),$(this).next('.ff-value-tip').hide();}),b.addClass('valid-error-field');var g=b.next('.ff-value-tip');g?g.addClass('valid-error').html('\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01').show():b.parent().append("<div class='ff-value-tip valid-error'>\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A</div>"),d=!1;}}return d;},questions:''};};u();var o=function(){e.linkMan={data:[],flag:0},e.mailModel={data:[],flag:0},e.mailTo='',e.mailRequestData={id:'',onlineProcessStatus:'04',email:{sendAddress:h.userName,to:[],context:'',subject:''}},e.$editorOpts={editorId:f('editorId'),ueditorOptions:{UEDITOR_HOME_URL:b.WIDGET_PATH+'editor/ueditor/',serverUrl:b.BASE_PATH,toolbars:[['fullscreen','source','|','undo','redo','|','bold','italic','underline','fontborder','strikethrough','superscript','subscript','removeformat','formatmatch','autotypeset','blockquote','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','selectall','cleardoc','|','rowspacingtop','rowspacingbottom','lineheight','|','customstyle','paragraph','fontfamily','fontsize','|','directionalityltr','directionalityrtl','indent','|','justifyleft','justifycenter','justifyright','justifyjustify','|','touppercase','tolowercase','|','link','unlink','anchor','|','imagenone','imageleft','imageright','imagecenter']]}},e.onLineMail=function(){e.mailRequestData.id=this.$vmodel.$model.el.id;var b=a.getVm(f('onLineMailDialogId'));b.title='\u53D1\u9001\u300A\u542F\u52A8\u670D\u52A1\u901A\u77E5\u51FD\u300B',b.open();},e.addLinkman=function(){$(document).on('click',function(b){var a=b.target;a.id!='addLinkMan'&&(g.linkMan.flag=0),a.id!='addMailModel'&&(g.mailModel.flag=0);}),c.c2s({url:b.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:d.stringify({merchantId:g.merchantId}),success:function(a){a.flag==1&&(g.linkMan.flag=1,g.linkMan.data=a.data.rows);}});},e.addPut=function(){var a=this.$vmodel.$model.el.mail;if(g.mailTo.length){var c=g.mailTo.split(';');for(var b=0;b<c.length;b++)c[b]!=a&&(g.mailTo+=';'+a);}else g.mailTo+=a;g.linkMan.flag=0;},e.addMailModel=function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/getEmailTemplates.do',type:'post',contentType:'application/json',data:d.stringify({mailTemplateType:'001'}),success:function(a){a.flag==1&&(g.mailModel.data=a.data.rows,g.mailModel.flag=1);}});},e.addPutEmailModel=function(){var b=this.$vmodel.$model.el.content,c=a.getVm(f('editorId'));c.core.setContent(b),g.mailModel.flag=0,g.mailRequestData.email.subject=this.$vmodel.$model.el.title;},e.$onLineMailDialogOpts={dialogId:f('onLineMailDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('addQuestionFormId'));b.reset();},width:700,submit:function(k){var h=a.getVm(f('onLineMailDialogId')),i=a.getVm(f('onLineMailFormId')),j=a.getVm(f('editorId'));i.validate()&&(g.mailRequestData.email.context=j.core.getContent(),g.mailRequestData.email.to=g.mailTo.split(';'),c.c2s({url:b.BASE_PATH+'fesOnlineProcess/updateOnlineStatusAndSendEmail.do',type:'post',contentType:'application/json',data:d.stringify(g.mailRequestData.$model),success:function(b){if(b.flag==1){var a=b.data;e.stepData[a.stepId-1].onlineProcessStatus=a.onlineProcessStatus,e.stepData[a.stepId-1].sysOperationLogVOs.push(a),e.stepData[9].onlineProcessStatus=a.finalStatus,h.close();}}}));}},e.$onLineMailFormOpts={formId:f('onLineMailFormId'),field:[{selector:'.mail-to',rule:['noempty',function(b,a){return a[0]!==!0?'\u6536\u4EF6\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mail-subject',rule:['noempty',function(b,a){return a[0]!==!0?'\u90AE\u4EF6\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mail-name-fa',rule:['noempty',function(b,a){return a[0]!==!0?'\u53D1\u4EF6\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]};};o();var t=function(){e.options1=[],e.$addQuestionDialogOpts={dialogId:f('addQuestionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('addQuestionFormId'));b.reset(),b.title='',b.description='';},submit:function(k){var e,i=a.getVm(f('addQuestionDialogId')),h=a.getVm(f('addQuestionFormId'));if(h.validate()){e=h.getFormData();var j=a.getVm(f('scheduleId')).selectedValue;e.merchantId=g.merchantId,e.problemType=j,e.problemStatus=1,e=d.stringify(e),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:e,success:function(a){a.flag==1&&i.close();}});}}},e.openAdd=function(){var d=a.getVm(f('scheduleId'));e.options1.length?d.setOptions(e.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,e.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),d.setOptions(e.options1));}});var g=a.getVm(f('addQuestionDialogId')),h=a.getVm(f('addQuestionFormId'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},e.$addQuestionFormOpts={formId:f('addQuestionFormId'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},e.$scheduleOpts={selectId:f('scheduleId'),options:[],selectedIndex:1};};t();var r=function(){e.createData={},e.options2=[],e.createActive=function(){var d=a.getVm(f('createActiveDialogId')),g=a.getVm(f('createActiveFormId')),h=a.getVm(f('activeId'));e.options2.length?h.setOptions(e.options2):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,e.options2=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),h.setOptions(e.options2));}}),d.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',g.activityTitle='',g.description='',d.open();},e.$activeUploaderOpts={uploaderId:f('activeUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=d.parse(a),a.flag){var b=a.data;g.createData.$model.attachmentName=b.attachmentName,g.createData.$model.originalFileName=b.originalFileName,g.createData.$model.fileSize=b.fileSize;}}},e.$createActiveDialogOpts={dialogId:f('createActiveDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('createActiveFormId'));b.reset(),b.activityTitle='',b.description='';},submit:function(l){var e,i=a.getVm(f('createActiveDialogId')),h=a.getVm(f('createActiveFormId')),j=a.getVm(f('activeId'));if(h.validate()){e=h.getFormData(),g.createData.$model.merchantId=g.merchantId,g.createData.$model.activityTitle=e.activityTitle,g.createData.$model.description=e.description,g.createData.$model.activityType=j.selectedValue,g.createData.$model.attachmentId=0;var k=d.stringify(g.createData.$model);c.c2s({url:b.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:k,success:function(a){a.flag==1&&i.close();}});}}},e.$createActiveFormOpts={formId:f('createActiveFormId'),field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},e.$activeOpts={selectId:f('activeId'),options:[],selectedIndex:1};};r();});a.scan(n[0]),i({merchantId:g.merchantId},'synMerchant/getMerchantInfoByOrder.do',m),i({merchantId:g.merchantId},'fesOnlineProcess/listFesOnlineProcesss.do',p);},$remove:function(b,c){_.each(e,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),e.length=0;}}),f;});

//From origin\page\frontend\home\customerline\customerline.js
define('originpagefrontendhomecustomerlinecustomerlinejs',['avalon','util','moment','json','originwidgetformselectjs','dialog','originwidgetformformjs','originwidgetuploaderuploaderjs','originmodulescheduleschedulejs','originwidgeteditoreditorjs'],function(a,b,e,d){var h=this,c=h.erp,g={},f=[];return _.extend(g,{$init:function(s,k,l){function t(c,f){var h=[];if(c instanceof Array)for(var d=0;d<c.length;d++){var e={};for(var b in c[d]){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}else{var e={};for(var b in c){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}return h;}function p(a){b.c2s({url:c.BASE_PATH+'user/isExistSysUserMerchant.do',type:'post',contentType:'application/json',data:d.stringify({merchantId:g.merchantId,userId:h.id}),success:function(b){b.flag&&a&&a(b.data);}},{mask:!1});}function i(e,f,g){var a=d.stringify(e);b.c2s({url:c.BASE_PATH+f,type:'post',contentType:'application/json',data:a,success:g});}function r(i){var c;if(i.flag){c=i.data;var a={};a.productList=c.productList,a.userMerchantList=c.userMerchantList,a.filePath=c.filePath;var e=c.merchantInfo;for(var b in c){var d=c.hasOwnProperty(b);d&&typeof c[b]!='object'&&(a[b]=c[b]);}for(var b in e){var d=e.hasOwnProperty(b);d&&(a[b]=e[b]);}a.attachment_name?a.imgUrl=g.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=g.path+'portal/origin/asset/image/merchant-default-logo.jpg',g.merchantData=a;var j=h.id;for(var f=0;f<a.userMerchantList.length;f++)if(j==a.userMerchantList[f].userId){g.promise=!0;return;}else g.promise=!1;}}function m(a){var b;a.flag&&(b=a.data,g.healthResponseData=b);}function n(a){var b;a.flag&&(b=a.data,g.reportResponseData=b.merchantMonthSum);}function q(){var b=$('#warn>li').length,a=0;setInterval(function(){a++,a>=b&&(a=0),$('#warn').animate({top:40*-a});},5000);}var h=c.getAppData('user'),j=new Date(),o=k+'-schedule',g=a.define(k,function(q){var r=function(b){var a=k+b;return f.push(a),a;};q.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u5BA2\u6237\u670D\u52A1\u770B\u677F'}],q.belongToRouteName=l.route.split('/')[1],q.path=c.BASE_PATH,q.merchantId=parseInt(l.params.id),q.pageUserId=c.getAppData('user').id,q.modelType=parseInt(l.params.type),q.pageStatus=1,q.pageData={},q.imgUrl='',q.upfile='',q.promise=!1,q.localHref=function(a){b.jumpPage(a);},q.warn=[{insertTime:'',itemContent:''}];var s=function(){q.merchantData={productList:[],filePath:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',online_time:'',format_name:'',attachment_name:'',attachment_path:''};};s(),q.requestDataDispose={id:0,handledBy:q.pageUserId,handledTime:new Date().getTime(),handledDescription:'',customerComplaintStatus:1},q.changePageStatus=function(a,b){q.pageStatus=a,a==2&&q.cardFn();};var u=function(){q.responseCardData=[{card_count:216481,card_price:0,card_type:'\u7C89\u4E1D\u4F1A\u5458',merchant_type:'\u54C1\u724C',is_sold_card:!1,merchant_name:'\u5317\u4EAC\u65B0\u8FA3\u9053\u9910\u996E\u7BA1\u7406\u6709\u9650\u516C\u53F8',merchant_id:1119,cardtype_id:207,description:'\u6682\u65E0',card_name:'\u79EF\u5206\u5361'}],q.cardFn=function(){b.c2s({url:c.BASE_PATH+'synMembershipCard/listSynMembershipCards.do',type:'post',data:{pageNumber:1,pageSize:10000,merchantId:g.merchantId},success:function(a){if(a.flag){var b=a.data.rows,c=['card_count','card_price','card_type','merchant_type','is_sold_card','merchant_name','cardtype_id','description','card_name'];g.responseCardData=t(b,c);}}});};};u();var v=function(){function d(){var d=new Date();b<=d.getFullYear()&&a<d.getMonth()+1?q.nextHealthBtn=!0:q.nextHealthBtn=!1,c=b+'-'+a,q.healthRequestData.date=c,i(q.healthRequestData.$model,'health/getHealthDegreeByMerchantId.do',m);}var b=j.getFullYear(),a=j.getMonth()+1,c=b+'-'+a;q.healthResponseData=[{actualValue:0,healthDegree:0,targetType:'',targetValue:0}],q.healthRequestData={merchantId:q.merchantId,date:c},q.healthMonth=a,q.nextHealthBtn=!1,q.prevHealth=function(){a--,a<=0&&(a=12,b--),q.healthMonth=a,d();},q.nextHealth=function(){a++,a>12&&(a=1,b++),q.healthMonth=a,d();};};v();var w=function(){function e(){var c=new Date();b<=c.getFullYear()&&a<c.getMonth()+1?q.nextReportBtn=!0:q.nextReportBtn=!1,q.reportMonth=a,a.toString().length==1&&(a=0+a.toString()),d=b+'-'+a,q.reportRequestData.date=d,i(q.reportRequestData.$model,'report/getMonthMerchantSummary.do',n);}var b=j.getFullYear(),a=j.getMonth()+1,d=b+'-'+a;if(a.toString().length==1)var c=b+'-'+0+a.toString();else var c=b+'-'+a;q.reportResponseData={newMember:62,fansMember:43,integralMember:20,storeMember:30,integralMemberRate:0,realcard:12,cardIncome:246,storePay:386851.54,storeConsume:11662.25,integralConsume:1116.8,cash:133789.59,couponAmount:1611,marketingIncome:-462.6,yearMember:1172,totalConsume:146568.64,yearCardInconsume:1068,yearMarketingConsume:1229336,storeBalance:215140265.61,consumedAvg:1093.8,consumedRate:3.01,evaluateWellRate:0,evaluateRate:0},q.reportRequestData={merchantId:q.merchantId,date:c},q.reportMonth=a,q.nextReportBtn=!1,q.prevReport=function(){a--,a<=0&&(a=12,b--),e();},q.nextReport=function(){a++,a>12&&(a=1,b++),e();};};w();var x=function(){q.options1=[],q.$addQuestionDialogOpts={dialogId:r('addQuestionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(r('addQuestionFormId'));b.reset(),b.title='',b.description='';},submit:function(j){var e,h=a.getVm(r('addQuestionDialogId')),f=a.getVm(r('addQuestionFormId'));if(f.validate()){e=f.getFormData();var i=a.getVm(r('scheduleId')).selectedValue;e.merchantId=g.merchantId,e.problemType=i,e.problemStatus=1,e=d.stringify(e),b.c2s({url:c.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:e,success:function(a){a.flag==1&&h.close();}});}}},q.openAdd=function(){var d=a.getVm(r('scheduleIds'));q.options1.length?d.setOptions(q.options1):b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,q.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),d.setOptions(q.options1));}});var e=a.getVm(r('addQuestionDialogId')),f=a.getVm(r('addQuestionFormId'));e.title='\u6DFB\u52A0\u95EE\u9898',f.title='',f.description='',e.open();},q.$addQuestionFormOpts={formId:r('addQuestionFormId'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},q.$scheduleOptss={selectId:r('scheduleIds'),options:[],selectedIndex:1};};x();var y=function(){q.createData={},q.options2=[],q.createActive=function(){var d=a.getVm(r('createActiveDialogId')),e=a.getVm(r('createActiveFormId')),f=a.getVm(r('activeId'));q.options2.length?f.setOptions(q.options2):b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,q.options2=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),f.setOptions(q.options2));}}),d.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',e.activityTitle='',e.description='',d.open();},q.$activeUploaderOpts={uploaderId:r('activeUploaderId'),uploadifyOpts:{uploader:c.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(b,c){if(b=d.parse(b),b.flag){var a=b.data;g.createData.$model.attachmentName=a.attachmentName,g.createData.$model.originalFileName=a.originalFileName,g.createData.$model.fileSize=a.fileSize,g.upfile=a.attachmentName;}}},q.$createActiveDialogOpts={dialogId:r('createActiveDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(r('createActiveFormId'));b.reset(),b.activityTitle='',b.description='',g.upfile='';},submit:function(k){var e,h=a.getVm(r('createActiveDialogId')),f=a.getVm(r('createActiveFormId')),i=a.getVm(r('activeId'));if(f.validate()){e=f.getFormData(),g.createData.$model.merchantId=g.merchantId,g.createData.$model.activityTitle=e.activityTitle,g.createData.$model.description=e.description,g.createData.$model.activityType=i.selectedValue,g.createData.$model.attachmentId=0;var j=d.stringify(g.createData.$model);b.c2s({url:c.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:j,success:function(a){a.flag==1&&h.close();}});}}},q.$createActiveFormOpts={formId:r('createActiveFormId'),field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},q.$activeOpts={selectId:r('activeId'),options:[],selectedIndex:1};};y(),q.linkMan={data:[],flag:0},q.mailModel={data:[],flag:0},q.mailTo='',q.mailRequestData={sendAddress:h.userName,to:[],context:'',subject:''},q.$editorOpts={editorId:r('editorId'),ueditorOptions:{UEDITOR_HOME_URL:c.WIDGET_PATH+'editor/ueditor/',serverUrl:c.BASE_PATH,toolbars:[['fullscreen','source','|','undo','redo','|','bold','italic','underline','fontborder','strikethrough','superscript','subscript','removeformat','formatmatch','autotypeset','blockquote','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','selectall','cleardoc','|','rowspacingtop','rowspacingbottom','lineheight','|','customstyle','paragraph','fontfamily','fontsize','|','directionalityltr','directionalityrtl','indent','|','justifyleft','justifycenter','justifyright','justifyjustify','|','touppercase','tolowercase','|','link','unlink','anchor','|','imagenone','imageleft','imageright','imagecenter']]}},q.onLineMail=function(){var b=a.getVm(r('onLineMailDialogId'));b.title='\u53D1\u9001\u6708\u62A5',b.open();},q.addLinkman=function(){$(document).on('click',function(b){var a=b.target;a.id!='addLinkMan'&&(g.linkMan.flag=0),a.id!='addMailModel'&&(g.mailModel.flag=0);}),b.c2s({url:c.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:d.stringify({merchantId:g.merchantId}),success:function(a){a.flag==1&&(g.linkMan.flag=1,g.linkMan.data=a.data.rows);}});},q.addPut=function(){var a=this.$vmodel.$model.el.mail;g.mailTo.length?g.mailTo+=';'+a:g.mailTo+=a,g.linkMan.flag=0;},q.addMailModel=function(){b.c2s({url:c.BASE_PATH+'fesOnlineProcess/getEmailTemplates.do',type:'post',contentType:'application/json',data:d.stringify({mailTemplateType:'002'}),success:function(a){a.flag==1&&(g.mailModel.data=a.data.rows,g.mailModel.flag=1);}});},q.addPutEmailModel=function(){var b=this.$vmodel.$model.el.content,c=a.getVm(r('editorId'));c.core.setContent(b),g.mailModel.flag=0,g.mailRequestData.subject=this.$vmodel.$model.el.title;},q.$onLineMailDialogOpts={dialogId:r('onLineMailDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(r('addQuestionFormId'));b.reset();},width:700,submit:function(i){var e=a.getVm(r('onLineMailDialogId')),f=a.getVm(r('onLineMailFormId')),h=a.getVm(r('editorId'));f.validate()&&(g.mailRequestData.context=h.core.getContent(),g.mailRequestData.to=g.mailTo.split(';'),b.c2s({url:c.BASE_PATH+'fesOnlineProcess/sendEmail.do',type:'post',contentType:'application/json',data:d.stringify(g.mailRequestData.$model),success:function(a){a.flag==1&&e.close();}}));}},q.$onLineMailFormOpts={formId:r('onLineMailFormId'),field:[{selector:'.mail-to',rule:['noempty',function(b,a){return a[0]!==!0?'\u6536\u4EF6\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mail-subject',rule:['noempty',function(b,a){return a[0]!==!0?'\u90AE\u4EF6\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mail-name-fa',rule:['noempty',function(b,a){return a[0]!==!0?'\u53D1\u4EF6\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'[name="content"]',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]},q.$scheduleOpts={scheduleId:o,onFetchPlan:function(e,a){b.c2s({url:c.BASE_PATH+'fesPlan/queryFesPlanList.do',type:'post',contentType:'application/json',data:d.stringify(_.extend({merchantId:q.merchantId},e)),success:function(b){var c;b.flag?(c=b.data,a(c)):a([]);}});},onClickDateCell:function(i){var f=this.$vmodel.$model,c=f.el.date,a=$(i.target),g=new Date(),d;if(!e(c).isBefore(g,'day'))if(a.is('.plan-item')){if(d=a.data('plan'),q.belongToRouteName==='sales'){d.user_id==h.id&&b.jumpPage('#/'+q.belongToRouteName+'/home/customerline/plan/list/'+e(c)/1+'/'+a.data('planId'));return;}d.user_id==h.id&&a.data('status')=='1'?b.jumpPage('#/'+q.belongToRouteName+'/home/customerline/plan/edit/'+e(c).hour(9)/1+'/'+a.data('planId')):b.jumpPage('#/'+q.belongToRouteName+'/home/customerline/plan/list/'+e(c)/1+'/'+a.data('planId'));}else q.belongToRouteName==='frontend'&&p(function(a){a?b.jumpPage('#/'+q.belongToRouteName+'/home/customerline/plan/add/'+e(c).hour(9)/1):b.alert({content:'\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u65E0\u6743\u9650\u6DFB\u52A0\u8BA1\u5212',iconType:'error'});});else a.is('.plan-item')&&(q.belongToRouteName==='frontend'||q.belongToRouteName==='sales'&&d.user_id==h.id)&&b.jumpPage('#/'+q.belongToRouteName+'/home/customerline/plan/list/'+e(c)/1+'/'+a.data('planId'));}};});a.scan(s[0]),i({merchantId:g.merchantId},'synMerchant/getMerchantInfoByOrder.do',r),i(g.healthRequestData.$model,'health/getHealthDegreeByMerchantId.do',m),i(g.reportRequestData.$model,'report/getMonthMerchantSummary.do',n),b.c2s({url:c.BASE_PATH+'activity/listNoneReadRemind.do',type:'post',data:{merchantId:1763},success:function(a){if(a.flag){var b=a.data;g.warn=b;}q();}});},$remove:function(b,c){_.each(f,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),f.length=0;}}),g;});

//From origin\page\frontend\home\emailtemplate\emailtemplate.js
define('originpagefrontendhomeemailtemplateemailtemplatejs',['avalon','util','originwidgetpaginationpaginationjs','originwidgetformselectjs','dialog','originwidgetformformjs','originwidgeteditoreditorjs'],function(a,c){var f=this,b=f.erp,e={},d=[];return _.extend(e,{$init:function(i,h,j){function g(d){c.c2s({url:b.BASE_PATH+'mailAndAttachment/listMailTemplates.do',type:'post',data:d,success:function(c){var b,d=a.getVm(e('paginationId'));c.flag&&(b=c.data,d.total=b.totalSize,f.pageData=b.rows);}});}var e=function(b){var a=h+b;return d.push(a),a;},f=a.define(h,function(d){d.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:''},{text:'\u90AE\u4EF6\u6A21\u677F'}];var h='';switch(j.route){case'/sales/home/emailtemplate':h='#/sales/home';break;case'/frontend/home/emailtemplate':h='#/frontend/home';break;case'/backend/emailtemplate':h='#/backend/customerservice';break;}d.navCrumbs[0].href=h,d.options1=[],d.url=b.BASE_PATH,d.pageData={},d.requestData={name:'',pageNumber:1,pageSize:10},d.$editorOpts={editorId:e('editorId'),ueditorOptions:{UEDITOR_HOME_URL:b.WIDGET_PATH+'editor/ueditor/',serverUrl:b.BASE_PATH,toolbars:[['fullscreen','source','|','undo','redo','|','bold','italic','underline','fontborder','strikethrough','superscript','subscript','removeformat','formatmatch','autotypeset','blockquote','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','selectall','cleardoc','|','rowspacingtop','rowspacingbottom','lineheight','|','customstyle','paragraph','fontfamily','fontsize','|','directionalityltr','directionalityrtl','indent','|','justifyleft','justifycenter','justifyright','justifyjustify','|','touppercase','tolowercase','|','link','unlink','anchor','|','imagenone','imageleft','imageright','imagecenter']]}},d.addEmailTemplate=function(){var f=a.getVm(e('addEmailDialogId')),g=a.getVm(e('addEmailFormId')),h=a.getVm(e('scheduleId'));d.options1.length?h.setOptions(d.options1):c.c2s({url:b.BASE_PATH+'mailAndAttachment/initType.do',type:'post',data:'dictionaryType=00000060',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.text,value:a.value};}),h.setOptions(d.options1));}}),f.title='\u6DFB\u52A0\u90AE\u4EF6\u6A21\u677F',g.name='',g.title='',f.state=1,f.open();},d.$scheduleOpts={selectId:e('scheduleId'),options:[],selectedIndex:1},d.$addEmilFormOpts={formId:e('addEmailFormId'),field:[{selector:'.name',rule:['noempty',function(b,a){return a[0]!==!0?'\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'[name="content"]',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],name:'',title:''},d.$addEmailDialogOpts={dialogId:e('addEmailDialogId'),width:800,state:0,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit" ms-if="state == 1">\u4FDD&nbsp;\u5B58</button><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit" ms-if="state == 2">\u4FEE&nbsp;\u6539</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('addEmailFormId')),c=a.getVm(e('editorId'));b.reset(),b.title='',b.name='',c.core.setContent('');},submit:function(l){var i=a.getVm(e('addEmailFormId')),j=a.getVm(e('addEmailDialogId')),k=a.getVm(e('scheduleId'));if(i.validate()){var h=i.getFormData();h.mailTemplateType=k.selectedValue,j.state==2&&(h.id=f.editId),h=JSON.stringify(h),c.c2s({url:b.BASE_PATH+'mailAndAttachment/saveMailTemplate.do',type:'post',contentType:'application/json',data:h,success:function(a){a.flag==1&&(g(d.requestData.$model),j.close());}});}}},d.search=function(){g(f.requestData.$model);},d.read=function(){var f=a.getVm(e('addEmailDialogId')),g=a.getVm(e('addEmailFormId')),h=a.getVm(e('scheduleId')),i=a.getVm(e('editorId'));d.options1.length?h.setOptions(d.options1):c.c2s({url:b.BASE_PATH+'mailAndAttachment/initType.do',type:'post',data:'dictionaryType=00000060',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.text,value:a.value};}),h.setOptions(d.options1));}}),f.title='\u67E5\u770B\u90AE\u4EF6\u6A21\u677F',g.name=this.$vmodel.$model.el.name,g.title=this.$vmodel.$model.el.title,i.core.setContent(this.$vmodel.$model.el.content),f.state=0,f.open();},d.edit=function(){var f=a.getVm(e('addEmailDialogId')),g=a.getVm(e('addEmailFormId')),h=a.getVm(e('scheduleId')),i=a.getVm(e('editorId'));d.options1.length?h.setOptions(d.options1):c.c2s({url:b.BASE_PATH+'mailAndAttachment/initType.do',type:'post',data:'dictionaryType=00000060',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.text,value:a.value};}),h.setOptions(d.options1));}}),f.title='\u4FEE\u6539\u90AE\u4EF6\u6A21\u677F',g.name=this.$vmodel.$model.el.name,g.title=this.$vmodel.$model.el.title,i.core.setContent(this.$vmodel.$model.el.content),f.state=2,d.editId=this.$vmodel.$model.el.id,f.open();},d.remove=function(){var a={};a.id=this.$vmodel.$model.el.id,c.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u9009\u62E9\u7684\u6A21\u677F\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'mailAndAttachment/deleteMailTemplate.do',type:'post',data:a,success:function(a){g(f.requestData.$model);}});}});},d.$paginationOpts={paginationId:e('paginationId'),total:0,onJump:function(c,d){var b=a.getVm(e('paginationId'));f.requestData.pageNumber=b.currentPage,g(f.requestData.$model);}};});a.scan(i[0]),g(f.requestData.$model);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\frontend\home\home.js
define('originpagefrontendhomehomejs',['avalon','util','originwidgetpaginationpaginationjs','originwidgetformselectjs'],function(avalon,util){var win=this,erp=win.erp,pageMod={},tempWidgetIdStore=[];return _.extend(pageMod,{$init:function(pageEl,pageName){function updateList(b,c,d){var a=JSON.stringify(b);pageVm.pageData=[],util.c2s({url:erp.BASE_PATH+c,type:'post',contentType:'application/json',data:a,success:d});}function merchantCallBack(responseData){responseData=eval(responseData);var data,paginationVm=avalon.getVm(getTypeId('paginationId'));if(responseData.flag){data=responseData.data;function compare(a,b){return a.stepId>b.stepId?1:-1;}for(var i=0,len=data.rows.length;i<len;i++)data.rows[i].listSteps.sort(compare);for(var i=0,len=data.rows.length;i<len;i++){var healthType=[{index:'1',health:0},{index:'2',health:0},{index:'3',health:0},{index:'4',health:0}],arr=data.rows[i].synHealthDegrees;for(var j=0,lenArr=arr.length;j<lenArr;j++){var obj={};obj.index=arr[j].targetType,arr[j].healthDegree<100?obj.health=0:obj.health=1;for(var m=0,lenArrs=healthType.length;m<lenArrs;m++)healthType[m].index==obj.index&&(healthType[m]=obj);}data.rows[i].healthType=healthType;}paginationVm.total=data.totalSize,pageVm.pageData=data.rows;}}function subordinatesCallBack(b){var a,c=avalon.getVm(getTypeId('paginationId'));b.flag&&(a=b.data,c.total=a.totalSize,pageVm.pageData=a.rows);}function backlogCallBack(b){var a,c=avalon.getVm(getTypeId('paginationId'));b.flag&&(a=b.data,c.total=a.totalSize,pageVm.pageData=a.rows);}function backlogCallBackValue(a){var b;a.flag&&(b=a.data,pageVm.dotolen=b.rows.length);}var getTypeId=function(b){var a=pageName+b;return tempWidgetIdStore.push(a),a;},pageVm=avalon.define(pageName,function(a){a.permission={active:util.hasPermission('fes_act_require'),remaind:util.hasPermission('fes_remaind'),question_mag:util.hasPermission('fes_question_mag'),address:util.hasPermission('fes_address'),attach_mag:util.hasPermission('fes_attach_mag'),email_temp:util.hasPermission('fes_email_temp'),complain:util.hasPermission('fes_complain'),performance:util.hasPermission('fes_performance'),my_mechant:util.hasPermission('fes_performance'),all_mechant:util.hasPermission('fes_all_mechant'),my_subordinate:util.hasPermission('fes_my_subordinate'),homepage_todolist:util.hasPermission('fes_homepage_todolist'),assign_p_incharge:util.hasPermission('fes_assign_p_incharge')},a.localHref=function(a){util.jumpPage(a);},a.userImgPath=erp.appData.user.userImagePath,a.pageUserId=erp.getAppData('user').id,a.pageStatus=1,a.pageData={},a.options1=[],a.dotolen=0,a.distributionFd={},a.subordinates={subUserName:'',baseUserId:a.pageUserId,pageSize:10,pageNumber:1},a.backlog={userId:a.pageUserId,inputItemTypes:['01','02'],merchantName:'',pageNumber:1,pageSize:10,businessTypes:['2']},a.requestData={merchantStatus:'',userId:a.pageUserId,pageSize:10,pageNumber:1,merchantName:'',merchantStatusType:0},a.changePageStatus=function(c,b){a.pageStatus=c;var d=avalon.getVm(getTypeId('paginationId'));d.currentPage=1,b=='requestData'?(c==1?a.requestData.$model.userId=a.pageUserId:a.requestData.$model.userId='',pageVm.requestData.pageNumber=1,pageVm.requestData.merchantName='',updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack)):b=='subordinatesData'?(pageVm.subordinates.pageNumber=1,pageVm.requestData.subUserName='',updateList(pageVm.subordinates.$model,'group/getSubordinateEmployees.do',subordinatesCallBack)):b=='backlog'&&(pageVm.backlog.pageNumber=1,pageVm.requestData.merchantName='',updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack));},a.changeStatus=function(c){a.requestData.merchantStatus=c;var b=avalon.getVm(getTypeId('paginationId'));b.currentPage=1,a.requestData.pageNumber=1,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},a.search=function(){updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},a.showProgressTip=function(){var d=this.$vmodel.$model,e=d.el.stepText,b=pageName+'-progress-tip',f=$(this),a=$('#'+b),c=f.offset();a.length||(a=$('<div id="'+b+'" class="grid-tip"></div>'),a.html('<span class="text-content"></span><span class="icon-arrow"></span>'),a.hide().appendTo('body')),$('.text-content',a).text(e),a.css({top:c.top-a.height()-20,left:c.left-a.width()/2-11}).show();},a.hideProgressTip=function(){$('#'+pageName+'-progress-tip').hide();},a.distribution=function(){var b=avalon.getVm(getTypeId('distributionDialogId')),d=avalon.getVm(getTypeId('fdId')),c={remark:'fes_my_main_page'};c=JSON.stringify(c),this.$vmodel.$model.el.listUsers[0]?a.distributionFd.$model.oldUserId=this.$vmodel.$model.el.listUsers[0].id:a.distributionFd.$model.oldUserId='',a.distributionFd.$model.merchantId=this.$vmodel.$model.el.merchantId,a.options1.length?(d.setOptions(a.options1),b.title='\u5206\u914D\u8D1F\u8D23\u4EBA',b.open()):util.c2s({url:erp.BASE_PATH+'user/getAllUsersByResourceCode.do',type:'post',contentType:'application/json',data:c,success:function(c){var e;c.flag&&(e=c.data,a.options1=_.map(e,function(a){return{text:a.userName,value:a.id};}),d.setOptions(a.options1),b.title='\u5206\u914D\u8D1F\u8D23\u4EBA',b.open());}});},a.$scheduleOpts={selectId:getTypeId('fdId'),options:[],selectedIndex:1},a.$distributionDialogOpts={dialogId:getTypeId('distributionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){},submit:function(d){var a=avalon.getVm(getTypeId('distributionDialogId')),b=avalon.getVm(getTypeId('fdId')),c;pageVm.distributionFd.$model.userId=b.selectedValue,c=JSON.stringify(pageVm.distributionFd.$model),util.c2s({url:erp.BASE_PATH+'myHomePage/assignPersionForMerchant.do',type:'post',contentType:'application/json',data:c,success:function(b){b.flag==1&&(a.close(),updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack));}});}},a.subordinatesSearch=function(){updateList(pageVm.subordinates.$model,'group/getSubordinateEmployees.do',subordinatesCallBack);},a.backlogSearch=function(){updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack);},a.doToStatus=function(b){var a=avalon.getVm(getTypeId('paginationId'));a.currentPage=1,pageVm.backlog.pageNumber=1,pageVm.backlog.inputItemTypes=b,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack);},a.$paginationOpts={paginationId:getTypeId('paginationId'),total:0,onJump:function(b,c){var a=avalon.getVm(getTypeId('paginationId'));pageVm.pageStatus==0||pageVm.pageStatus==1?(pageVm.requestData.pageNumber=a.currentPage,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack)):pageVm.pageStatus==2?(pageVm.subordinates.pageNumber=a.currentPage,updateList(pageVm.subordinates.$model,'group/getSubordinateEmployees.do',subordinatesCallBack)):pageVm.pageStatus==3&&(pageVm.backlog.pageNumber=a.currentPage,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack));}};});avalon.scan(pageEl[0]),updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBackValue),updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},$remove:function(a,b){_.each(tempWidgetIdStore,function(b){var a=avalon.getVm(b);a&&$(a.widgetElement).remove();}),tempWidgetIdStore.length=0;}}),pageMod;});

//From origin\page\frontend\home\marketactivitie\marketactivitie.js
define('originpagefrontendhomemarketactivitiemarketactivitiejs',['avalon','util','originwidgetformselectjs','dialog','originwidgetformformjs','originwidgetuploaderuploaderjs','originwidgeteditoreditorjs'],function(a,c){var f=this,b=f.erp,e={},d=[];return _.extend(e,{$init:function(h,g,i){function j(c,f){var h=[];if(c instanceof Array)for(var d=0;d<c.length;d++){var e={};for(var b in c[d]){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}else{var e={};for(var b in c){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}return h;}function k(d,f,g){var a=JSON.stringify(d);e.pageData=[],c.c2s({url:b.BASE_PATH+f,type:'post',contentType:'application/json',data:a,success:g});}function l(f){var b;if(f.flag){b=f.data;var a={};a.productList=b.productList,a.filePath=b.filePath;var c=b.merchantInfo;for(var d in c){var g=c.hasOwnProperty(d);g&&(a[d]=c[d]);}a.attachment_name?a.imgUrl=e.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=e.path+'portal/origin/asset/image/merchant-default-logo.jpg',e.merchantData=a;}}var f=function(b){var a=g+b;return d.push(a),a;},e=a.define(g,function(d){d.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u8425\u9500\u6D3B\u52A8'}],d.path=b.BASE_PATH,d.pageUserId=b.getAppData('user').id,d.merchantId=parseInt(i.params.id),d.imgUrl='',d.localHref=function(a){c.jumpPage(a);};var g=function(){d.merchantData={productList:['\u7528\u6237\u7BA1\u7406\u5E73\u53F0','CRM2.0','CRM4.0'],filePath:'user-upload-img/merchant/real',merchant_status:'0',merchant_name:'\u6D4B\u8BD5',front_user_name:'admin',sale_user_name:'18610925812',assist_user_name:null,person_avg:'',desk_avg:'',store_number:'',begin_time:1409131953594,plan_online_time:1412761451126,format_name:'',attachment_name:'test_logo',attachment_path:'881'};};g();var h=function(){d.options1=[],d.$addQuestionDialogOpts={dialogId:f('addQuestionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('addQuestionFormId'));b.reset(),b.title='',b.description='';},submit:function(j){var d,h=a.getVm(f('addQuestionDialogId')),g=a.getVm(f('addQuestionFormId'));if(g.validate()){d=g.getFormData();var i=a.getVm(f('scheduleId')).selectedValue;d.merchantId=e.merchantId,d.problemType=i,d.problemStatus=1,d=JSON.stringify(d),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&h.close();}});}}},d.openAdd=function(){var e=a.getVm(f('scheduleIds'));d.options1.length?e.setOptions(d.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),e.setOptions(d.options1));}});var g=a.getVm(f('addQuestionDialogId')),h=a.getVm(f('addQuestionFormId'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},d.$addQuestionFormOpts={formId:f('addQuestionFormId'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},d.$scheduleOptss={selectId:f('scheduleIds'),options:[],selectedIndex:1};};h();var k=function(){d.createData={},d.options2=[],d.createActive=function(){var e=a.getVm(f('createActiveDialogId')),g=a.getVm(f('createActiveFormId')),h=a.getVm(f('activeId'));d.options2.length?h.setOptions(d.options2):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,d.options2=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),h.setOptions(d.options2));}}),e.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',g.activityTitle='',g.description='',e.open();},d.$activeUploaderOpts={uploaderId:f('activeUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:loginUserData.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=JSON.parse(a),a.flag){var b=a.data;e.createData.$model.attachmentName=b.attachmentName,e.createData.$model.originalFileName=b.originalFileName,e.createData.$model.fileSize=b.fileSize;}}},d.$createActiveDialogOpts={dialogId:f('createActiveDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('createActiveFormId'));b.reset(),b.activityTitle='',b.description='';},submit:function(k){var d,h=a.getVm(f('createActiveDialogId')),g=a.getVm(f('createActiveFormId')),i=a.getVm(f('activeId'));if(g.validate()){d=g.getFormData(),e.createData.$model.merchantId=e.merchantId,e.createData.$model.activityTitle=d.activityTitle,e.createData.$model.description=d.description,e.createData.$model.activityType=i.selectedValue,e.createData.$model.attachmentId=0;var j=JSON.stringify(e.createData.$model);c.c2s({url:b.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:j,success:function(a){a.flag==1&&h.close();}});}}},d.$createActiveFormOpts={formId:f('createActiveFormId'),field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},d.$activeOpts={selectId:f('activeId'),options:[],selectedIndex:1};};k();var l=function(){d.responseSalesData=[{active_name:'\u5168\u5E74\u4F18\u60E0\u8425\u9500---11-1',active_begin:'2014-07-01',active_end:'2015-01-01',type_name:'\u5168\u5E74\u4F18\u60E0\u8425\u9500'}],c.c2s({url:b.BASE_PATH+'activeCrm/getActiveExecutiving.do',type:'post',data:{brandId:d.merchantId},success:function(a){if(a.flag){data=a.data;var b=['active_name','active_begin','active_end','type_name'];e.responseSalesData=j(data,b);}}});};l(),d.linkMan={data:[],flag:0},d.mailModel={data:[],flag:0},d.mailTo='',d.mailRequestData={sendAddress:'',to:[],context:'',subject:''},d.$editorOpts={editorId:f('editorId'),ueditorOptions:{UEDITOR_HOME_URL:b.WIDGET_PATH+'editor/ueditor/',serverUrl:b.BASE_PATH,toolbars:[['fullscreen','source','|','undo','redo','|','bold','italic','underline','fontborder','strikethrough','superscript','subscript','removeformat','formatmatch','autotypeset','blockquote','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','selectall','cleardoc','|','rowspacingtop','rowspacingbottom','lineheight','|','customstyle','paragraph','fontfamily','fontsize','|','directionalityltr','directionalityrtl','indent','|','justifyleft','justifycenter','justifyright','justifyjustify','|','touppercase','tolowercase','|','link','unlink','anchor','|','imagenone','imageleft','imageright','imagecenter']]}},d.onLineMail=function(){var b=a.getVm(f('onLineMailDialogId'));b.title='\u53D1\u9001\u6708\u62A5',b.open();},d.addLinkman=function(){$(document).on('click',function(b){var a=b.target;a.id!='addLinkMan'&&(e.linkMan.flag=0),a.id!='addMailModel'&&(e.mailModel.flag=0);}),c.c2s({url:b.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:JSON.stringify({merchantId:e.merchantId}),success:function(a){a.flag==1&&(e.linkMan.flag=1,e.linkMan.data=a.data.rows);}});},d.addPut=function(){var a=this.$vmodel.$model.el.mail;e.mailTo.length?e.mailTo+=';'+a:e.mailTo+=a,e.linkMan.flag=0;},d.addMailModel=function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/getEmailTemplates.do',type:'post',contentType:'application/json',data:JSON.stringify({mailTemplateType:'002'}),success:function(a){a.flag==1&&(e.mailModel.data=a.data.rows,e.mailModel.flag=1);}});},d.addPutEmailModel=function(){var b=this.$vmodel.$model.el.content,c=a.getVm(f('editorId'));c.core.setContent(b),e.mailModel.flag=0;},d.$onLineMailDialogOpts={dialogId:f('onLineMailDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f('addQuestionFormId'));b.reset();},width:700,submit:function(i){var d=a.getVm(f('onLineMailDialogId')),g=a.getVm(f('onLineMailFormId')),h=a.getVm(f('editorId'));g.validate()&&(e.mailRequestData.context=h.core.getContent(),e.mailRequestData.to=e.mailTo.split(';'),c.c2s({url:b.BASE_PATH+'fesOnlineProcess/sendEmail.do',type:'post',contentType:'application/json',data:JSON.stringify(e.mailRequestData.$model),success:function(a){a.flag==1&&d.close();}}));}},d.$onLineMailFormOpts={formId:f('onLineMailFormId'),field:[{selector:'.mail-to',rule:['noempty',function(b,a){return a[0]!==!0?'\u6536\u4EF6\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mail-subject',rule:['noempty',function(b,a){return a[0]!==!0?'\u90AE\u4EF6\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mail-name-fa',rule:['noempty',function(b,a){return a[0]!==!0?'\u53D1\u4EF6\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'[name="content"]',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]};});a.scan(h[0]),k({merchantId:e.merchantId},'synMerchant/getMerchantInfoByOrder.do',l);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\frontend\home\mycommunication\mycommunication.js
define('originpagefrontendhomemycommunicationmycommunicationjs',['avalon','util','json','moment','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetautocompleteautocompletejs'],function(a,c){var f=this,b=f.erp,e={},d=[];return _.extend(e,{$init:function(j,h,i){function g(g){var d=JSON.stringify(g);c.c2s({url:b.BASE_PATH+'contact/listContacts.do',type:'post',contentType:'application/json',data:d,success:function(c){var b,d=a.getVm(e('pagination'));c.flag&&(b=c.data,d.total=b.totalSize,f.pageData=b.rows,f.requestData.pageNumber=1);}});}var e=function(b){var a=h+b;return d.push(a),a;},f=a.define(h,function(d){d.pageUserId=b.getAppData('user').id,d.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:''},{text:'\u901A\u8BAF\u5F55'}];var h='';switch(i.route){case'/sales/home/mycommunication(/:mid)':h='#/sales/home';break;case'/frontend/home/mycommunication(/:mid)':h='#/frontend/home';break;case'/backend/mycommunication(/:mid)':h='#/backend/customerservice';break;}d.navCrumbs[0].href=h,d.url=b.BASE_PATH,d.pageData={};var j='';j||(j=parseInt(i.params.mid)),d.requestData={userId:d.pageUserId,name:'',merchantId:j,merchantName:'',pageNumber:1,pageSize:10},d.search=function(){var b=a.getVm(e('pagination'));f.requestData.pageNumber=1,b.currentPage=1,g(f.requestData.$model);},d.$paginationOpts={paginationId:e('pagination'),total:0,onJump:function(c,d){var b=a.getVm(e('pagination'));f.requestData.pageNumber=b.currentPage,g(f.requestData.$model);}};var k=function(){d.communicationRequestData={moduleType:'fes',merchantId:'',name:'',genderType:1,birthday:'',position:'',mobilePhone:'',telephone:'',roleType:'3',mail:''};var h={moduleType:'fes',merchantId:d.merchantId,name:'',genderType:1,birthday:'',position:'',mobilePhone:'',telephone:'',roleType:'3',mail:''};d.$brandOpts={autocompleteId:e('brandId'),placeholder:'\u8BF7\u6307\u5B9A\u5546\u6237',delayTime:300,onChange:function(a,d){a.length?c.c2s({url:b.BASE_PATH+'synMerchant/getSynMerchantInfo.do',data:{merchantName:a},success:function(a){var b;a.flag&&(b=a.data,d(_.map(b,function(a){return a.text=a.merchant_name||'\u672A\u77E5',a.value=a.merchant_id,a;})));}},{mask:!1}):d([]);},onSelect:function(c){var b=a.getVm(e('brandId')).getOptionByValue(c);f.communicationRequestData.merchantId=b.merchant_id;}},d.addCommunication=function(i){var d=a.getVm(e('addCommunicationDialog')),g=a.getVm(e('addCommunicationForm')),h=a.getVm(e('addCommunicationSelect'));c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000065',success:function(b){var c,a;if(b.flag){c=b.data,a=_.map(c,function(a){return{text:a.dictionary_value,value:a.dictionary_key};});function d(b,c){for(var a=0;a<b.length;a++)if(b[a].value==c)return a;}h.setOptions(a,d(a,f.communicationRequestData.roleType));}}}),d.title='\u6DFB\u52A0\u8054\u7CFB\u4EBA',d.readonly=0,g.beginTime=moment(new Date()).format('YYYY-MM-DD'),d.open();},d.changeSex=function(a){f.communicationRequestData.genderType=a;},d.$addCommunicationOpts={dialogId:e('addCommunicationDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="close">\u786E&nbsp;\u5B9A</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},readonly:0,width:500,onOpen:function(){},onClose:function(){var b=a.getVm(e('addCommunicationForm'));b.reset(),b.beginTime='';},submit:function(j){var h,i=a.getVm(e('addCommunicationDialog')),d=a.getVm(e('addCommunicationForm'));if(f.communicationRequestData.roleType=a.getVm(e('addCommunicationSelect')).selectedValue,f.communicationRequestData.birthday=moment(d.beginTime,'YYYY-MM-DD')._d/1,f.communicationRequestData.moduleType='mkt',h=JSON.stringify(f.communicationRequestData.$model),d.validate()){if(!f.communicationRequestData.merchantId)return c.confirm({content:'\u8BF7\u9009\u62E9\u5546\u6237!',onSubmit:function(){}}),!1;c.c2s({url:b.BASE_PATH+'contact/saveMktContact.do',type:'post',contentType:'application/json',data:h,success:function(a){a.flag==1&&(i.close(),g(f.requestData.$model));}});}}},d.$addCommunicationFormOpts={formId:e('addCommunicationForm'),field:[{selector:'.name',rule:['noempty',function(b,a){return a[0]!==!0?'\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.position',rule:['noempty',function(b,a){return a[0]!==!0?'\u804C\u4F4D\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.mobilePhone',rule:['noempty',function(b,c){if(c[0]!==!0)return'\u624B\u673A\u4E0D\u80FD\u4E3A\u7A7A';else{var a=/^1[0-9]{10}$/;return a.test(b)?!0:'\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\uFF01';}}]},{selector:'.telephone',rule:['noempty',function(b,c){if(c[0]!==!0)return!0;else{var a=/^(\({0,1}\d{3,4})\){0,1}(-){0,1}(\d{7,8})$/;return a.test(b)?!0:'\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u5EA7\u673A\u53F7\uFF01';}}]},{selector:'.email',rule:['noempty',function(b,c){if(c[0]!==!0)return'\u90AE\u7BB1\u4E0D\u80FD\u4E3A\u7A7A';else{var a=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;return a.test(b)?!0:'\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\uFF01';}}]}],beginTime:''},d.$communicationOpts={selectId:e('addCommunicationSelect'),options:[],selectedIndex:1,beginTime:moment(new Date()).format('YYYY-MM-DD')},d.$startDateOpts={calendarId:e('startDateCalendarId'),onClickDate:function(c){var b=a.getVm(e('addCommunicationForm'));b.beginTime=moment(c).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},d.openStartDateCalendar=function(){var g=a.getVm(e('addCommunicationForm')),h=$(this),f=a.getVm(e('startDateCalendarId')),b,i=h.offset();f?b=$(f.widgetElement):(b=$('<div ms-widget="calendar,$,$startDateOpts"></div>'),b.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(b[0],[d]),f=a.getVm(e('startDateCalendarId')),c.regGlobalMdExcept({element:b,handler:function(){b.hide();}})),g.beginTime?f.focusDate=moment(g.beginTime,'YYYY-MM-DD')._d:f.focusDate=new Date(),b.css({top:i.top+h.outerHeight()-1,left:i.left}).show();};};k();});a.scan(j[0]),g(f.requestData.$model);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\frontend\home\questionmanage\questionmanage.js
define('originpagefrontendhomequestionmanagequestionmanagejs',['avalon','util','originwidgetautocompleteautocompletejs','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs'],function(a,b){var f=this,c=f.erp,e={},d=[];return _.extend(e,{$init:function(k,h,i){function g(g){var d=JSON.stringify(g);b.c2s({url:c.BASE_PATH+'sysProblem/listSysProblems.do',type:'post',contentType:'application/json',data:d,success:function(c){var b,d=a.getVm(e('paginationId'));c.flag&&(b=c.data,d.total=b.totalSize,f.pageData=b.rows);}});}var e=function(b){var a=h+b;return d.push(a),a;},f=a.define(h,function(d){d.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:''},{text:'\u95EE\u9898\u7BA1\u7406'}];var h='';switch(i.route){case'/sales/home/questionmanage':h='#/sales/home';break;case'/frontend/home/questionmanage':h='#/frontend/home';break;case'/backend/questionmanage':h='#/backend/customerservice';break;}d.navCrumbs[0].href=h,d.searchId=0,d.url=c.BASE_PATH,d.merchantId=parseInt(i.params.id),d.pageData={},d.options1=[],d.assignedArr=[],d.processClass=0,d.requestDataAssigned={id:0,solveredBy:0,problemStatus:'2',merchantId:'',title:''},d.requestDataDispose={id:0,problemStatus:'3',remark:'',problemType:'5',solvingType:'1'},d.crequestDataNotice={id:0,problemStatus:''},d.requestData={merchantId:d.merchantId,title:'',merchantName:'',pageNumber:1,pageSize:10,problemStatus:''},d.search=function(){g(d.requestData.$model);},d.change=function(c){var b=a.getVm(e('paginationId'));d.requestData.problemStatus=c,d.requestData.pageSize=b.perPages,d.requestData.pageNumber=1,b.currentPage=1,g(d.requestData.$model);},d.$paginationOpts={paginationId:e('paginationId'),total:0,onJump:function(c,d){var b=a.getVm(e('paginationId'));f.requestData.pageNumber=b.currentPage,g(f.requestData.$model);}},d.$brandOpts={autocompleteId:e('brandId'),placeholder:'\u8BF7\u6307\u5B9A\u5546\u6237',delayTime:300,onChange:function(a,d){a.length?b.c2s({url:c.BASE_PATH+'synMerchant/getSynMerchantInfo.do',data:{merchantName:a},success:function(a){var b;a.flag&&(b=a.data,d(_.map(b,function(a){return a.text=a.merchant_name||'\u672A\u77E5',a.value=a.merchant_id,a;})));}},{mask:!1}):d([]);},onSelect:function(c){var b=a.getVm(e('brandId')).getOptionByValue(c);f.searchId=b.merchant_id;}},d.$addQuestionDialogOpts={dialogId:e('addQuestionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('addQuestionFormId'));b.reset(),b.merchantId='',b.title='',b.description='',f.searchId=0;},submit:function(m){var h,j=a.getVm(e('addQuestionDialogId')),i=a.getVm(e('addQuestionFormId')),l=a.getVm(e('searchId'));if(i.validate()){var k=a.getVm(e('scheduleId')).selectedValue;if(h=i.getFormData(),h.merchantId=f.searchId,!h.merchantId)return b.confirm({content:'\u8BF7\u9009\u62E9\u5546\u6237!',onSubmit:function(){}}),!1;h.problemType=k,h.problemStatus=1,h=JSON.stringify(h),b.c2s({url:c.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:h,success:function(a){a.flag==1&&(g(d.requestData.$model),j.close(),f.searchId=0);}});}}},d.addQuestion=function(){var f=a.getVm(e('scheduleId'));d.options1.length?f.setOptions(d.options1):b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),f.setOptions(d.options1));}});var g=a.getVm(e('addQuestionDialogId')),h=a.getVm(e('addQuestionFormId'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},d.$addQuestionFormOpts={formId:e('addQuestionFormId'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},d.$scheduleOpts={selectId:e('scheduleId'),options:[],selectedIndex:1},d.assigned=function(h,i,j){d.requestDataAssigned.id=h,d.requestDataAssigned.merchantId=i,d.requestDataAssigned.title=j;var f={remark:'train_exam'};f=JSON.stringify(f),b.c2s({url:c.BASE_PATH+'user/getAllUsersByResourceCode.do',type:'post',contentType:'application/json',data:f,success:function(a){var b;a.flag&&(b=a.data,d.assignedArr=b);}});var g=a.getVm(e('assignedDialogId'));g.title='\u6307\u6D3E\u5904\u7406\u4EBA',g.open();},d.assignedFn=function(a){d.processClass=a,d.requestDataAssigned.solveredBy=a;},d.$assignedDialogOpts={dialogId:e('assignedDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){f.requestDataAssigned.solveredBy=0,d.processClass=0;},submit:function(j){var h=f.requestDataAssigned.$model.solveredBy;if(!h)return!1;dialogVm=a.getVm(e('assignedDialogId'));var i=JSON.stringify(f.requestDataAssigned.$model);b.c2s({url:c.BASE_PATH+'sysProblem/updateSysProblem.do',type:'post',contentType:'application/json',data:i,success:function(a){a.flag==1&&(dialogVm.close(),g(d.requestData.$model));}});}},d.dispose=function(c){d.requestDataDispose.id=c;var b=a.getVm(e('disposeDialogId'));b.title='\u95EE\u9898\u5904\u7406',b.open();},d.changProblemStatus=function(a){d.requestDataDispose.problemStatus=a;},d.$assignedDisposeOpts={dialogId:e('disposeDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){},submit:function(k){var h=a.getVm(e('disposeDialogId')),i=JSON.stringify(f.requestDataDispose.$model),j=a.getVm(e('assignedform'));j.validate()&&b.c2s({url:c.BASE_PATH+'sysProblem/updateSysProblem.do',type:'post',contentType:'application/json',data:i,success:function(a){a.flag==1&&(h.close(),f.requestDataDispose.remark='',g(d.requestData.$model));}});}},d.$assignedformOpts={formId:e('assignedform'),field:[{selector:'.question-remark',name:'remark',rule:['noempty',function(a,b){return a.length>250?'\u5185\u5BB9\u4E0D\u80FD\u8D85\u8FC7250\u4E2A\u5B57\uFF01':b[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]},d.confirmNotice=function(e){d.crequestDataNotice.id=e,d.crequestDataNotice.problemStatus='4';var a=JSON.stringify(f.crequestDataNotice.$model);b.confirm({content:'\u4F60\u786E\u5B9A\u5DF2\u544A\u77E5\u5BA2\u6237\u4E86\u5417\uFF1F',onSubmit:function(){b.c2s({url:c.BASE_PATH+'sysProblem/updateSysProblem.do',type:'post',contentType:'application/json',data:a,success:function(a){a.flag==1&&g(d.requestData.$model);}});}});},d.again=function(e){d.crequestDataNotice.id=e,d.crequestDataNotice.problemStatus='6';var a=JSON.stringify(f.crequestDataNotice.$model);b.confirm({content:'\u4F60\u786E\u5B9A\u8981\u91CD\u65B0\u6FC0\u6D3B\u95EE\u9898\u5417\uFF1F',onSubmit:function(){b.c2s({url:c.BASE_PATH+'sysProblem/updateSysProblem.do',type:'post',contentType:'application/json',data:a,success:function(a){a.flag==1&&g(d.requestData.$model);}});}});};});a.scan(k[0]);var j={title:'',merchantName:'',pageNumber:1,pageSize:10,problemStatus:''};g(j);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\frontend\home\remind\remind.js
define('originpagefrontendhomeremindremindjs',['avalon','util','json','originwidgetpaginationpaginationjs'],function(a,e,g){var f=this,b=f.erp,d={},c=[];return _.extend(d,{$init:function(j,i,k){function f(f){var c=g.stringify(f);e.c2s({url:b.BASE_PATH+'activity/listRemind.do',type:'post',contentType:'application/json',data:c,success:function(c){var b,e=a.getVm(h('pagination'));c.flag&&(b=c.data,e.total=b.totalSize,d.pageData=b.rows);}});}var h=function(b){var a=i+b;return c.push(a),a;},d=a.define(i,function(c){c.pageUserId=b.getAppData('user').id,c.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:''},{text:'\u63D0\u9192'}];var g='';switch(k.route){case'/sales/home/remind':g='#/sales/home';break;case'/frontend/home/remind':g='#/frontend/home';break;case'/backend/remind':g='#/backend/customerservice';break;}c.navCrumbs[0].href=g,c.url=b.BASE_PATH,c.pageData={},c.statusTabs='',c.requestData={userId:c.pageUserId,merchantName:'',pageNumber:1,pageSize:10,itemStatus:''},c.changeStatus=function(c){var b=a.getVm(h('pagination'));d.requestData.pageNumber=1,b.currentPage=1,d.requestData.itemStatus=c,f(d.requestData.$model);},c.search=function(){f(d.requestData.$model);},c.modStatus=function(a){a=a.toString(),e.c2s({url:b.BASE_PATH+'activity/updateRemind.do',type:'post',data:{id:a},success:function(a){f(d.requestData.$model);}});},c.$paginationOpts={paginationId:h('pagination'),total:0,onJump:function(c,e){var b=a.getVm(h('pagination'));d.requestData.pageNumber=b.currentPage,f(d.requestData.$model);}};});a.scan(j[0]),f(d.requestData.$model);},$remove:function(b,d){_.each(c,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),c.length=0;}}),d;});

//From origin\page\frontend\home\rewardspunishments\rewardspunishments.js
define('originpagefrontendhomerewardspunishmentsrewardspunishmentsjs',['avalon','util','originwidgetpaginationpaginationjs'],function(c,d){var e=this,a=e.erp,b={};return _.extend(b,{$init:function(g,f){function e(e){var c=JSON.stringify(e);d.c2s({url:a.BASE_PATH+'activity/listRemind.do',type:'post',contentType:'application/json',data:c,success:function(a){var c;a.flag&&(c=a.data,b.pageData=c.rows);}});}var h=f+'-pagination',b=c.define(f,function(c){c.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u6211\u7684\u7EE9\u6548'}],c.url=a.BASE_PATH,c.pageData={},c.statusTabs='',c.requestData={merchantName:'',pageNumber:1,pageSize:10,itemStatus:''},c.changeStatus=function(a){b.requestData.itemStatus=a,e(b.requestData.$model);},c.search=function(){e(b.requestData.$model);},c.modStatus=function(c){c=c.toString(),d.c2s({url:a.BASE_PATH+'activity/updateRemind.do',type:'post',data:{id:c},success:function(a){e(b.requestData.$model);}});};});c.scan(g[0]),e(b.requestData.$model);},$remove:function(a,b){}}),b;});

//From origin\page\frontend\home\subordinates\subordinates.js
define('originpagefrontendhomesubordinatessubordinatesjs',['avalon','util','moment','originwidgetpaginationpaginationjs','originmodulescheduleschedulejs'],function(avalon,util,moment){var win=this,erp=win.erp,pageMod={};return _.extend(pageMod,{$init:function(pageEl,pageName,routeData){function updateList(b,c,d){var a=JSON.stringify(b);pageVm.pageData=[],util.c2s({url:erp.BASE_PATH+c,type:'post',contentType:'application/json',data:a,success:d});}function merchantCallBack(responseData){responseData=eval(responseData);var data,paginationVm=avalon.getVm(paginationId);if(responseData.flag){data=responseData.data;function compare(a,b){return a.stepId>b.stepId?1:void 0;}for(var i=0,len=data.rows.length;i<len;i++)data.rows[i].listSteps.sort(compare);for(var i=0,len=data.rows.length;i<len;i++){var healthType=[{index:'1',health:0},{index:'2',health:0},{index:'3',health:0},{index:'4',health:0}],arr=data.rows[i].synHealthDegrees;for(var j=0,lenArr=arr.length;j<lenArr;j++){var obj={};obj.index=arr[j].targetType,arr[j].healthDegree<100?obj.health=0:obj.health=1;for(var m=0,lenArrs=healthType.length;m<lenArrs;m++)healthType[m].index==obj.index&&(healthType[m]=obj);}data.rows[i].healthType=healthType;}paginationVm.total=data.totalSize,pageVm.pageData=data.rows,pageVm.requestData.merchantName='';}}function backlogCallBack(b){var a,c=avalon.getVm(paginationId);b.flag&&(a=b.data,c.total=a.totalSize,pageVm.pageData=a.rows,pageVm.backlog.merchantName='');}var paginationId=pageName+'-pagination',scheduleId=pageName+'-schedule',pageVm=avalon.define(pageName,function(a){a.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u6211\u7684\u4E0B\u5C5E'}],a.subId=parseInt(routeData.params.id),a.url=erp.BASE_PATH,a.pageData={},a.statusTabs=1,a.requestData={merchantStatus:'',merchantStatusType:'0',userId:a.subId,pageSize:10,pageNumber:1,merchantName:''},a.backlog={userId:a.subId,inputItemTypes:['01','02'],merchantName:'',pageNumber:1,pageSize:10},a.changeStatus=function(a){pageVm.statusTabs=a,a==1?(updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack),pageVm.requestData.merchantName=''):a==2&&(updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack),pageVm.requestData.merchantName='');},a.changeMerchantStatus=function(b){a.requestData.merchantStatus=b,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},a.doToStatus=function(a){pageVm.backlog.inputItemTypes=a,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack);},a.$paginationOpts={paginationId:paginationId,total:0,onJump:function(b,c){var a=avalon.getVm(paginationId);pageVm.statusTabs==1?(pageVm.requestData.pageNumber=a.currentPage,updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack)):pageVm.pageStatus==2?(pageVm.backlog.pageNumber=a.currentPage,updateList(pageVm.backlog.$model,'myHomePage/getComplexSysToDoLists.do',backlogCallBack)):pageVm.pageStatus==3;}},a.$scheduleOpts={scheduleId:scheduleId,onFetchPlan:function(c,b){util.c2s({url:erp.BASE_PATH+'fesPlan/queryFesPlanList.do',type:'post',contentType:'application/json',data:JSON.stringify(_.extend({userId:a.subId},c)),success:function(a){var c;a.flag?(c=a.data,b(c)):b([]);}});},onClickDateCell:function(e){var c=this.$vmodel.$model,b=c.el.date,a=$(e.target),d=new Date();moment(b).isBefore(d,'day')?a.is('.plan-item')&&util.jumpPage('#/frontend/home/subordinates/plan/list/'+moment(b)/1+'/'+a.data('planId')):a.is('.plan-item')?util.jumpPage('#/frontend/home/subordinates/plan/list/'+moment(b)/1+'/'+a.data('planId')):util.jumpPage('#/frontend/home/subordinates/assign');}};});avalon.scan(pageEl[0]),updateList(pageVm.requestData.$model,'myHomePage/getComplexSynMerchants.do',merchantCallBack);},$remove:function(a,b){}}),pageMod;});

//From origin\page\frontend\home\waiting\waiting.js
define('originpagefrontendhomewaitingwaitingjs',['avalon','util','originwidgetformselectjs','dialog','originwidgetformformjs','originwidgetuploaderuploaderjs'],function(a,c){var f=this,b=f.erp,e={},d=[];return _.extend(e,{$init:function(j,g,n){function m(c,f){var h=[];if(c instanceof Array)for(var d=0;d<c.length;d++){var e={};for(var b in c[d]){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}else{var e={};for(var b in c){var g=c[d].hasOwnProperty(b);if(g)for(var a=0;a<f.length;a++)b==f[a]&&(e[f[a]]=c[d][b]);}h.push(e);}return h;}function i(d,e,f){var a=JSON.stringify(d);c.c2s({url:b.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function k(g){var c;if(g.flag){c=g.data;var a={};a.productList=c.productList,a.userMerchantList=c.userMerchantList,a.filePath=c.filePath;var f=c.merchantInfo;for(var b in c){var d=c.hasOwnProperty(b);d&&typeof c[b]!='object'&&(a[b]=c[b]);}for(var b in f){var d=f.hasOwnProperty(b);d&&(a[b]=f[b]);}a.attachment_name?a.imgUrl=e.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=e.path+'portal/origin/asset/image/merchant-default-logo.jpg',e.merchantData=a;}}function l(c){var d,a;if(c.flag){d=c.data,a=d.rows;for(var b=0;b<a.length;b++)a[b].end=!1,a[b].end_time='',a[b].end_content='';e.listData=a;}}var f=g+'-dispose-dialog',h=b.getAppData('user'),e=a.define(g,function(i){var j=function(b){var a=g+b;return d.push(a),a;};i.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u5F85\u529E\u4E8B\u9879'}],i.localHref=function(a){c.jumpPage(a);},i.pageUserId=b.getAppData('user').id,i.merchantId=parseInt(n.params.id),i.path=b.BASE_PATH,i.createData={},i.options1=[],i.options2=[],i.pageStatus=1,i.pageData={},i.listData={},i.imgUrl='';var k=function(){i.merchantData={productList:['\u7528\u6237\u7BA1\u7406\u5E73\u53F0','CRM2.0','CRM4.0'],filePath:'user-upload-img/merchant/real',merchant_status:'0',merchant_name:'\u6D4B\u8BD5',front_user_name:'admin',sale_user_name:'18610925812',assist_user_name:null,person_avg:'',desk_avg:'',store_number:'',begin_time:1409131953594,plan_online_time:1412761451126,online_time:1412761451126,format_name:'',attachment_name:'test_logo',attachment_path:'881'};};k(),i.requestDataDispose={id:0,handledBy:i.pageUserId,handledTime:new Date().getTime(),handledDescription:'',customerComplaintStatus:1},i.changePageStatus=function(a,b){i.pageStatus=a,a==2&&i.cardFn();};var l=function(){i.responseCardData=[{card_count:216481,card_price:0,card_type:'\u7C89\u4E1D\u4F1A\u5458',merchant_type:'\u54C1\u724C',is_sold_card:!1,merchant_name:'\u5317\u4EAC\u65B0\u8FA3\u9053\u9910\u996E\u7BA1\u7406\u6709\u9650\u516C\u53F8',merchant_id:1119,cardtype_id:207,description:'\u6682\u65E0',card_name:'\u79EF\u5206\u5361'}],i.cardFn=function(){c.c2s({url:b.BASE_PATH+'synMembershipCard/listSynMembershipCards.do',type:'post',data:{pageNumber:1,pageSize:10000,merchantId:e.merchantId},success:function(a){if(a.flag){var b=a.data.rows,c=['card_count','card_price','card_type','merchant_type','is_sold_card','merchant_name','cardtype_id','description','card_name'];e.responseCardData=m(b,c);}}});};};l();var o=function(){i.options1=[],i.$addQuestionDialogOpts={dialogId:j('addQuestionDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(j('addQuestionFormId'));b.reset(),b.title='',b.description='';},submit:function(i){var d,g=a.getVm(j('addQuestionDialogId')),f=a.getVm(j('addQuestionFormId'));if(f.validate()){d=f.getFormData();var h=a.getVm(j('scheduleId')).selectedValue;d.merchantId=e.merchantId,d.problemType=h,d.problemStatus=1,d=JSON.stringify(d),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&g.close();}});}}},i.openAdd=function(){var d=a.getVm(j('scheduleIds'));i.options1.length?d.setOptions(i.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,i.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),d.setOptions(i.options1));}});var e=a.getVm(j('addQuestionDialogId')),f=a.getVm(j('addQuestionFormId'));e.title='\u6DFB\u52A0\u95EE\u9898',f.title='',f.description='',e.open();},i.$addQuestionFormOpts={formId:j('addQuestionFormId'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},i.$scheduleOptss={selectId:j('scheduleIds'),options:[],selectedIndex:1};};o();var p=function(){i.createData={},i.options2=[],i.createActive=function(){var d=a.getVm(j('createActiveDialogId')),e=a.getVm(j('createActiveFormId')),f=a.getVm(j('activeId'));i.options2.length?f.setOptions(i.options2):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,i.options2=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),f.setOptions(i.options2));}}),d.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',e.activityTitle='',e.description='',d.open();},i.$activeUploaderOpts={uploaderId:j('activeUploaderId'),uploadifyOpts:{uploader:b.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:h.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=JSON.parse(a),a.flag){var b=a.data;e.createData.$model.attachmentName=b.attachmentName,e.createData.$model.originalFileName=b.originalFileName,e.createData.$model.fileSize=b.fileSize;}}},i.$createActiveDialogOpts={dialogId:j('createActiveDialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(j('createActiveFormId'));b.reset(),b.activityTitle='',b.description='';},submit:function(k){var d,g=a.getVm(j('createActiveDialogId')),f=a.getVm(j('createActiveFormId')),h=a.getVm(j('activeId'));if(f.validate()){d=f.getFormData(),e.createData.$model.merchantId=e.merchantId,e.createData.$model.activityTitle=d.activityTitle,e.createData.$model.description=d.description,e.createData.$model.activityType=h.selectedValue,e.createData.$model.attachmentId=0;var i=JSON.stringify(e.createData.$model);c.c2s({url:b.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:i,success:function(a){a.flag==1&&g.close();}});}}},i.$createActiveFormOpts={formId:j('createActiveFormId'),field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},i.$activeOpts={selectId:j('activeId'),options:[],selectedIndex:1};};p(),i.disposeOpen=function(c,d){i.disposeIndex=d,i.requestDataDispose.id=c;var b=a.getVm(f);b.title='\u6295\u8BC9\u5904\u7406',b.open();},i.changProblemStatus=function(a){i.requestDataDispose.customerComplaintStatus=String(a);},i.$assignedDisposeOpts={dialogId:f,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){e.requestDataDispose.handledDescription='';},submit:function(h){var d=a.getVm(f),g=JSON.stringify(e.requestDataDispose.$model);c.c2s({url:b.BASE_PATH+'sysCustomerComplaint/updateSysCustomerComplaint.do',type:'post',contentType:'application/json',data:g,success:function(b){if(b.flag==1){var a=new Date();e.listData[e.disposeIndex].end=!0,e.listData[e.disposeIndex].end_time=a.getTime(),e.listData[e.disposeIndex].end_content='\u6295\u8BC9\u5904\u7406\u5B8C\u6210',console.log(e.listData),d.close(),e.requestDataDispose.handledDescription='';}}});}};});a.scan(j[0]),i({merchantId:e.merchantId},'synMerchant/getMerchantInfoByOrder.do',k),i({merchantId:e.merchantId,pageSize:100,pageNumber:1,customerComplaintStatus:'0'},'sysCustomerComplaint/querySysCustomerComplaintList.do',l);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\frontend\make\customer\customer.js
define('originpagefrontendmakecustomercustomerjs',['avalon','util','moment','json','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs'],function(a,c){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(o,e,n){function p(e,f,g){var a=JSON.stringify(e);d.pageData=[],c.c2s({url:b.BASE_PATH+f,type:'post',contentType:'application/json',data:a,success:g});}function q(b){var a;b.flag&&(a=b.data,d.merchantData=a,console.log(a));}var i=e+'-add-Question-dialog',f=e+'-add-Question-form',j=e+'-schedule',h=e+'-active-select',g=e+'-active-form',k=e+'-active-dialog',l=e+'-active-uploader',m=b.getAppData('user'),d=a.define(e,function(e){e.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/make'},{text:'\u5927\u8FDE\u5F64\u5FB7\u83B1\u9910\u996E\u7BA1\u7406\u6709\u9650\u516C\u53F8'}],e.pageUserId=b.getAppData('user').id,e.merchantId=parseInt(n.params.id),e.createData={},e.options1=[],e.options2=[],e.stepData={},e.merchantData={},e.$addQuestionDialogOpts={dialogId:i,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f);b.reset(),b.title='',b.description='';},submit:function(l){var e,h=a.getVm(i),g=a.getVm(f);if(g.validate()){e=g.getFormData();var k=a.getVm(j).selectedValue;e.merchantId=d.merchantId,e.problemType=k,e.problemStatus=1,e=JSON.stringify(e),console.log(e),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:e,success:function(a){a.flag==1&&h.close();}});}}},e.openAdd=function(){var d=a.getVm(j);e.options1.length?d.setOptions(e.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,e.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),d.setOptions(e.options1));}});var g=a.getVm(i),h=a.getVm(f);g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},e.$addQuestionFormOpts={formId:f,field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},e.$scheduleOpts={selectId:j,options:[],selectedIndex:1},e.createActive=function(){var d=a.getVm(k),f=a.getVm(g),i=a.getVm(h);e.options2.length?i.setOptions(e.options2):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000056',success:function(a){var b;a.flag&&(b=a.data,e.options2=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),i.setOptions(e.options2));}}),d.title='\u8425\u9500\u6D3B\u52A8\u7533\u8BF7',f.activityTitle='',f.description='',d.open();},e.$activeUploaderOpts={uploaderId:l,uploadifyOpts:{uploader:b.BASE_PATH+'activity/uploadFile.do',fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:m.sessionId};},width:110,height:30,progressData:'speed'},onSuccessResponseData:function(a,c){if(a=JSON.parse(a),a.flag){var b=a.data;d.createData.$model.attachmentName=b.attachmentName,d.createData.$model.originalFileName=b.originalFileName,d.createData.$model.fileSize=b.fileSize;}}},e.$createActiveDialogOpts={dialogId:k,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(g);b.reset(),b.activityTitle='',b.description='';},submit:function(m){var f,j=a.getVm(k),i=a.getVm(g),l=a.getVm(h);if(i.validate()){f=i.getFormData(),d.createData.$model.merchantId=d.merchantId,d.createData.$model.activityTitle=f.activityTitle,d.createData.$model.description=f.description,d.createData.$model.activityType=l.selectedValue,d.createData.$model.attachmentId=0;var e=JSON.stringify(d.createData.$model);console.log(e),c.c2s({url:b.BASE_PATH+'activity/saveActivity.do',type:'post',contentType:'application/json',data:e,success:function(a){console.log(e),a.flag==1&&j.close();}});}}},e.$createActiveFormOpts={formId:g,field:[{selector:'.activityTitle',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],activityTitle:'',description:''},e.$activeOpts={selectId:h,options:[],selectedIndex:1};});a.scan(o[0]),p({merchantId:d.merchantId},'synMerchant/getMerchantInfoByOrder.do',q);},$remove:function(a,b){}}),d;});

//From origin\page\frontend\make\make.js
define('originpagefrontendmakemakejs',['avalon','util','originwidgetpaginationpaginationjs'],function(a,f){var e=this,c=e.erp,d={},b=[];return _.extend(d,{$init:function(j,i){function g(b,d,e){var a=JSON.stringify(b);f.c2s({url:c.BASE_PATH+d,type:'post',contentType:'application/json',data:a,success:e});}function h(c){var b,f=a.getVm(e('paginationId'));c.flag&&(b=c.data,f.total=b.totalSize,d.pageData=b.rows,d.backlogNumber=b.rows.length);}var e=function(c){var a=i+c;return b.push(a),a;},d=a.define(i,function(b){b.pageUserId=c.getAppData('user').id,b.pageData={},b.backlogNumber=0,b.backlog={userId:b.pageUserId,inputItemTypes:['01'],merchantName:'',pageNumber:1,pageSize:10,businessTypes:['4','5','6']},b.doToStatus=function(a){d.backlog.inputItemTypes=a,g(d.backlog.$model,'myHomePage/getComplexSysToDoLists.do',h);},b.$paginationOpts={paginationId:e('paginationId'),total:0,onJump:function(c,f){var b=a.getVm(e('paginationId'));d.backlog.pageNumber=b.currentPage,g(d.backlog.$model,'myHomePage/getComplexSysToDoLists.do',h);}};});a.scan(j[0]),g(d.backlog.$model,'myHomePage/getComplexSysToDoLists.do',h);},$remove:function(c,d){_.each(b,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),b.length=0;}}),d;});

//From origin\page\frontend\make\waiting\waiting.js
define('originpagefrontendmakewaitingwaitingjs',['avalon','util','moment','json','originmoduleautocompleteautocompletejs','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs'],function(a,c){var f=this,b=f.erp,e={},d=[];return _.extend(e,{$init:function(k,j,l){function h(d,e,f){var a=JSON.stringify(d);c.c2s({url:b.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function m(e){var b;if(e.flag){b=e.data;var a={};a.productList=b.productList,a.filePath=b.filePath;var c=b.merchantInfo;for(var d in c){var g=c.hasOwnProperty(d);g&&(a[d]=c[d]);}a.attachment_name?a.imgUrl=f.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=f.path+'portal/origin/asset/image/merchant-default-logo.jpg',f.merchantData=a,f.merchantData=a,f.navCrumbs[1].text=a.merchant_name;}}function i(j){var c,g=a.getVm(e('step61Uploder')),h=a.getVm(e('step62Uploder')),i=a.getVm(e('step71Uploder'));if(j.flag){g&&$(g.widgetElement).remove(),h&&$(h.widgetElement).remove(),i&&$(i.widgetElement).remove(),c=j.data;var d=[];for(var b=0;b<c.length;b++)c[b].stepNum=='entity_cards'&&d.push(c[b]),c[b].stepNum=='materials_design'&&d.push(c[b]);f.pageData=d;}}var e=function(b){var a=j+b;return d.push(a),a;},g=b.getAppData('user'),f=a.define(j,function(d){function k(b){for(var a=0;a<d.pageData.length;a++)if(d.pageData[a].stepNum==b)return d.pageData[a].id;}function r(){j.length=0;for(var c=1;c<=8;c++){var a='checkoucon'+c;$('.'+a).blur(function(){_.str.trim($(this).val())&&($(this).removeClass('valid-error-field'),$(this).closest('tr').find('.ff-value-tip').hide());});var d=$('.'+a).prevAll('input');if(d.length){if(d[0].checked==1){var b={selector:'.'+a,rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]};j.push(b);}}else{var b={selector:'.'+a,rule:['noempty',function(b,a){return a[0]!==!0?'\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A':!0;}]};j.push(b);}}return j;}d.navCrumbs=[{text:'\u5236\u5361\u7269\u6599',href:'#/frontend/make'},{text:'test'}],d.path=b.BASE_PATH,d.pageUserId=b.getAppData('user').id,d.merchantId=parseInt(l.params.id),d.pageData={},d.imgUrl='';var m=function(){d.merchantData={productList:[],filePath:'',merchant_id:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',format_name:'',attachment_name:'',attachment_path:''};};m();var n=function(){d.options1=[],d.$addQuestionDialogOpts={dialogId:e('addQuestionDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('addQuestionForm'));b.reset(),b.title='',b.description='';},submit:function(j){var d,h=a.getVm(e('addQuestionDialog')),g=a.getVm(e('addQuestionForm'));if(g.validate()){d=g.getFormData();var i=a.getVm(e('addQuestionSelect')).selectedValue;d.merchantId=f.merchantId,d.problemType=i,d.problemStatus=1,d=JSON.stringify(d),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:d,success:function(a){a.flag==1&&h.close();}});}}},d.openAdd=function(){var f=a.getVm(e('addQuestionSelect'));d.options1.length?f.setOptions(d.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,d.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),f.setOptions(d.options1));}});var g=a.getVm(e('addQuestionDialog')),h=a.getVm(e('addQuestionForm'));g.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',g.open();},d.$addQuestionFormOpts={formId:e('addQuestionForm'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},d.$scheduleOpts={selectId:e('addQuestionSelect'),options:[],selectedIndex:1};};n(),d.$step61UploaderOpts={uploaderId:e('step61Uploder'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:g.sessionId,processId:k('entity_cards'),typeId:3};},width:120,height:30,progressData:'speed'},onSuccessResponseData:function(a,b){a=JSON.parse(a),a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}},d.$step62UploaderOpts={uploaderId:e('step62Uploder'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:g.sessionId,processId:k('entity_cards'),typeId:4};},width:120,height:30,progressData:'speed'},onSuccessResponseData:function(a,b){a=JSON.parse(a),a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}},d.removeAttach=function(a,d){c.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u6587\u6863\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/deleteAttachment/'+a+'/'+d+'.do',type:'get',success:function(a){a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}});}});},d.stepEnd=function(g,a,h,i){var e={id:g,onlineProcessStatus:a},f=JSON.stringify(e);c.confirm({content:h,onSubmit:function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/updateFesOnlineProcessStatus.do',type:'post',contentType:'application/json',data:f,success:function(c){if(c.flag)for(var b=0;b<d.pageData.length;b++)d.pageData[b].stepNum==i&&(d.pageData[b].onlineProcessStatus=a,d.pageData[b].listAttachmentAndOperateLog.push(c.data));}});}});};var o=function(){d.carRequestData={processId:0,merchantId:d.merchantId,fesOpenCardApplicationDtls:[{cardName:'',cardAmount:'',validityTerm:'',isContainFour:'0',isContainSeven:'0'}]},d.openCard=function(c){var b=a.getVm(e('cardDialog'));b.title='\u5F00\u5361\u7533\u8BF7',d.carRequestData.processId=c,b.open();},d.changeRedio4=function(a){this.$vmodel.$model.el.isContainFour=a;},d.changeRedio7=function(a){this.$vmodel.$model.el.isContainSeven=a;},d.$addCardDialogOpts={dialogId:e('cardDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button ms-if="save" type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},save:1,width:530,onClose:function(){var b=a.getVm(e('cardForm'));f.carRequestData={processId:0,merchantId:d.merchantId,fesOpenCardApplicationDtls:[{cardName:'',cardAmount:'',validityTerm:'',isContainFour:'0',isContainSeven:'0'}]},b.reset(),b.cardName='',b.cardAmount='',b.validityTerm='';},submit:function(n){var k,l=a.getVm(e('cardDialog')),m=a.getVm(e('cardForm'));if(m.validate()){var j=f.carRequestData.$model.fesOpenCardApplicationDtls;for(var d=0;d<j.length;d++)j[d].cardAmount=Number(j[d].cardAmount),j[d].validityTerm=Number(j[d].validityTerm);k=JSON.stringify(f.carRequestData.$model),c.c2s({url:b.BASE_PATH+'applySetting/saveOpenCardApply.do',type:'post',contentType:'application/json',data:k,success:function(a){a.flag==1&&(l.close(),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i));}});}}},d.$addCardFormOpts={formId:e('cardForm'),field:[{selector:'.card-name',name:'cardName',getValue:function(){var b=$(this),a=[];return b.each(function(){var b=$(this);a.push(_.str.trim(b.val()));}),a;},rule:function(){var a=$(this),b=!0;return a.each(function(){var a=$(this);return _.str.trim(a.val()).length?void 0:(b=!1,!1);}),{handler:function(c,b){c?a.each(function(e){var a=$(this),c=a.closest('.ff-value'),d=$('.ff-value-tip',c);d.removeClass(b.errorCls).empty(),a.removeClass(b.errorCls+'-field');}):a.each(function(g){var e=$(this).closest('.f-field'),c=$(this),f=$('.ff-value',e),a=$('.ff-value-tip',f),d='';_.str.trim(c.val()).length?(c.removeClass(b.errorCls+'-field'),a.removeClass(b.errorCls),a.empty()):(d='\u5361\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A',c.addClass(b.errorCls+'-field'),a.addClass(b.errorCls),a.text(d));});},isPassed:b};}},{selector:'.card-amount',name:'cardAmount',getValue:function(){var b=$(this),a=[];return b.each(function(){var b=$(this);a.push(_.str.trim(b.val()));}),a;},rule:function(){var b=$(this),a=!0;return b.each(function(){var c=$(this);if(!_.str.trim(c.val()).length){var b=/^[1-9]\d*$/;b.test(c.val())||(a=!1);}else{var b=/^[1-9]\d*$/;b.test(c.val())||(a=!1);}return a?void 0:!1;}),{handler:function(c,a){c?b.each(function(e){var b=$(this),c=b.closest('.ff-value'),d=$('.ff-value-tip',c);d.removeClass(a.errorCls).empty(),b.removeClass(a.errorCls+'-field');}):b.each(function(h){var e=$(this).closest('.f-field'),c=$(this),f=$('.ff-value',e),b=$('.ff-value-tip',f),d='',g=/^[1-9]\d*$/;g.test(c.val())?(c.removeClass(a.errorCls+'-field'),b.removeClass(a.errorCls),b.empty()):(d='\u5F00\u5361\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A\u4E14\u5FC5\u987B\u4E3A\u6570\u5B57',c.addClass(a.errorCls+'-field'),b.addClass(a.errorCls),b.text(d));});},isPassed:a};}},{selector:'.validity-term',name:'validityTerm',getValue:function(){var b=$(this),a=[];return b.each(function(){var b=$(this);a.push(_.str.trim(b.val()));}),a;},rule:function(){var a=$(this),b=!0;return a.each(function(){var a=$(this);if(_.str.trim(a.val()).length){var c=/^[1-9]\d*$/;if(!c.test(a.val()))return b=!1,!1;}}),{handler:function(c,b){c?a.each(function(e){var a=$(this),c=a.closest('.ff-value'),d=$('.ff-value-tip',c);d.removeClass(b.errorCls).empty(),a.removeClass(b.errorCls+'-field');}):a.each(function(h){var e=$(this).closest('.f-field'),a=$(this),f=$('.ff-value',e),c=$('.ff-value-tip',f),d='';if(_.str.trim(a.val()).length){var g=/^[1-9]\d*$/;g.test(a.val())||(d='\u5F00\u5361\u6709\u6548\u671F\u53EA\u80FD\u662F\u6570\u5B57\u6216\u7A7A',a.addClass(b.errorCls+'-field'),c.addClass(b.errorCls),c.text(d));}else a.removeClass(b.errorCls+'-field'),c.removeClass(b.errorCls),c.empty();});},isPassed:b};}}],cardName:'',cardAmount:'',validityTerm:''},d.readCard=function(g){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/getFesOpenCardApplicationsAndDtls.do',type:'post',contentType:'application/json',data:JSON.stringify({processId:g}),success:function(g){if(g.flag==1){var c=g.data[0];for(var b=0;b<c.fesOpenCardApplicationDtls.length;b++)c.fesOpenCardApplicationDtls[b].validityTerm||(c.fesOpenCardApplicationDtls[b].validityTerm='');f.carRequestData=g.data[0],f.carRequestData.read=1;var h=a.getVm(e('cardDialog'));h.save=0,d.openCard();}}});},d.addCarList=function(){var a={cardName:'',cardAmount:'',validityTerm:'',isContainFour:0,isContainSeven:'0'};d.carRequestData.fesOpenCardApplicationDtls.push(a);},d.removeCarList=function(){d.carRequestData.fesOpenCardApplicationDtls.pop();};};o(),d.$step71UploaderOpts={uploaderId:e('step71Uploder'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:function(){return{sessionId:g.sessionId,processId:k('materials_design'),typeId:6};},width:120,height:30,progressData:'speed'},onSuccessResponseData:function(a,b){a=JSON.parse(a),a.flag&&h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i);}};var p=function(){d.sltImg='',d.imgUrl='',d.uploadData={},d.$step72UploaderOpts={uploaderId:e('step72Uploder'),uploadifyOpts:{uploader:b.BASE_PATH+'fesOnlineProcess/uploadTempFiles.do',fileObjName:'myfile',multi:!1,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.jpg; *.png; *.gif',formData:function(){return{sessionId:g.sessionId};},width:120,height:30,progressData:'speed'},onSuccessResponseData:function(d,g){if(d=JSON.parse(d),d.flag){var c=d.data;c.processId=k('materials_design'),c.typeId=a.getVm(e('selectSltId')).selectedValue,f.uploadData=c,f.sltImg=b.BASE_PATH+c.fileFullPath;}}},d.uploaderImgType=function(){var b=a.getVm(e('sltDialog'));b.title='\u4E0A\u4F20\u7F29\u7565\u56FE',b.open();},d.$addsltDialogOpts={dialogId:e('sltDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){d.sltImg='';},submit:function(m){var k=a.getVm(e('sltDialog')),l=JSON.stringify(f.uploadData.$model),d=a.getVm(e('step72Uploder')),j=function(){c.c2s({url:b.BASE_PATH+'fesOnlineProcess/uploadFilesForCommit.do',type:'post',contentType:'application/json',data:l,success:function(a){a.flag==1&&(k.close(),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i));}});};d.uploading?(c.showGlobalMask(),d.$unwatch('uploading'),d.$watch('uploading',function(a){a||(c.hideGlobalMask(),j(),d.$unwatch('uploading'));})):j();}},d.$selectSltOpts={selectId:e('selectSltId'),options:[{text:'X\u5C55\u67B6',value:7},{text:'\u53F0\u5361\u5361\u5FC3',value:8},{text:'\u6613\u62C9\u5B9D',value:9},{text:'\u4E09\u6298\u53F0\u5361',value:10},{text:'\u6D77\u62A5',value:11},{text:'\u684C\u8D34',value:13}],onSelect:function(){},selectedIndex:0};};p();var q=function(){d.stowageCard=function(i){var f=a.getVm(e('stowageDialog')),g=a.getVm(e('selectMessId'));f.processId=i;var h=JSON.stringify({merchantId:d.merchantId});c.c2s({url:b.BASE_PATH+'contact/queryContact.do',type:'post',contentType:'application/json',data:h,success:function(e){if(e.flag){var b=e.data,d=[];for(var a=0;a<b.length;a++){var c={};c.value=b[a].id,c.text=b[a].name,d.push(c);}g.setOptions(d);}}}),f.title='\u5B9E\u4F53\u5361\u914D\u9001',f.open();},d.$stowageDialogOpts={dialogId:e('stowageDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e('stowageForm'));b.reset();},submit:function(j){var f,g=a.getVm(e('stowageDialog')),h=a.getVm(e('stowageForm')),i=a.getVm(e('selectMessId'));h.validate()&&(f=h.getFormData(),f.contactId=i.selectedValue,f.processId=g.processId,f.fesStowageDtls=[{category:'2'}],f=JSON.stringify(f),c.c2s({url:b.BASE_PATH+'applySetting/saveFesStowage.do',type:'post',contentType:'application/json',data:f,success:function(a){a.flag&&(g.close(),d.pageData[0].listAttachmentAndOperateLog.push(a.data),d.pageData[0].onlineProcessStatus=a.dataonlineProcessStatus);}}));}},d.$stowageFormOpts={formId:e('stowageForm'),field:[{selector:'.logisticsNum',rule:['noempty',function(b,a){return a[0]!==!0?'\u5FEB\u9012\u5355\u53F7\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.logisticsCompany',rule:['noempty',function(b,a){return a[0]!==!0?'\u7269\u6D41\u516C\u53F8\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],logisticsNum:'',logisticsCompany:''},d.$selectMessOpts={selectId:e('selectMessId'),options:[{text:'X\u5C55\u67B6',value:7}],selectedIndex:0};};q(),d.setp7ReqData={id:0,processId:0,accessId:1,description:'',fesMaterialRequestDtlVOs:[{materialRequestType:'1',specificationType:'1',description:''},{materialRequestType:'2',specificationType:'1',description:''},{materialRequestType:'3',specificationType:'1',description:''},{materialRequestType:'4',specificationType:'1',description:''},{materialRequestType:'5',specificationType:'1',description:''},{materialRequestType:'6',specificationType:'1',description:''},{materialRequestType:'7',specificationType:'1',description:''}]},d.changeRadioStatus=function(a,b){},d.step7Input=function(g){function h(){c.c2s({url:b.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:JSON.stringify({merchantId:f.merchantId}),success:function(b){if(b.flag==1){var c=b.data.rows,f=a.getVm(e('step7NameSelect')),g=_.map(c,function(a,b){return{text:a.name,value:a.id};});f.setOptions(g),d.title='\u8BBE\u8BA1\u9700\u6C42\u5355',d.readonly=1,$('input',d.widgetElement).prop('disabled',!0),$('textarea',d.widgetElement).prop('disabled',!0),$('span',d.widgetElement).off('click'),d.open();}}});}var d=a.getVm(e('step7DialogId')),i=a.getVm(e('step7FormId'));g?c.c2s({url:b.BASE_PATH+'fesOnlineProcess/getFesMaterialRequestById.do',type:'post',contentType:'application/json',data:JSON.stringify({id:g}),success:function(a){a.flag==1&&(f.setp7ReqData=a.data,h());}}):h();},d.$step7DialogOpts={dialogId:e('step7DialogId'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns" ms-if="!readonly"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div><div class="ui-dialog-btns" ms-if="readonly"><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u5173&nbsp;\u95ED</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},readonly:0,onOpen:function(){},onClose:function(){},width:600,submit:function(i){var d=a.getVm(e('step7DialogId')),g=a.getVm(e('step7FormId'));if(r(),g.validate()){f.setp7ReqData.processId=f.stepData[6].id,f.setp7ReqData.accessId=a.getVm(e('step7NameSelect')).selectedValue;var h=JSON.stringify(f.setp7ReqData.$model);c.c2s({url:b.BASE_PATH+'fesOnlineProcess/saveFesMaterialRequestAndDtls.do',type:'post',contentType:'application/json',data:h,success:function(a){if(a.flag==1){var b=a.data;f.stepData.splice(6,1,b),d.close();}}});}}};var j=[];d.$step7FormOpts={formId:e('step7FormId'),field:j},d.$step7NameSelectOpts={selectId:e('step7NameSelect'),options:[],selectedIndex:1};});a.scan(k[0]),h({merchantId:f.merchantId},'synMerchant/getMerchantInfoByOrder.do',m),h({merchantId:f.merchantId,userId:g.id,resourceRemark:'fes_card_and_materials'},'fesOnlineProcess/listFesOnlineProcesss.do',i);},$remove:function(b,c){_.each(d,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),d.length=0;}}),e;});

//From origin\page\productoperad\list\addedit\addedit.js
define('originpageproductoperadlistaddeditaddeditjs',['avalon','util','json','moment','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetuploaderuploaderjs','originwidgetcalendarcalendarjs','originwidgeteditoreditorjs'],function(b,c,g,a){var h=this,d=h.erp,f={},e=[];return _.extend(f,{$init:function(l,i,j){function m(b,e,f){var a=g.stringify(b);c.c2s({url:d.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function k(d,b,e){for(var c=0;c<d.length;c++)for(var a=0;a<b.length;a++)d[c]==b[a].value&&(b[a].isSelect='1',$('.'+e).val(b[a].value));}function n(d){var c;if(d.flag){c=d.data,f.requestData={id:c.id,title:c.title,content:c.content,productType:c.productType,promotionPlatform:c.promotionPlatform,beginTime:a(c.beginTime).format('YYYY-MM-DD'),endTime:a(c.endTime).format('YYYY-MM-DD'),isOpen:c.isOpen};var e=b.getVm(h('editorId'));setTimeout(function(){e.core.setContent(c.content),$('#edui1').css('z-index',10);},1000),k(c.productType,f.productType,'isProducts'),k(c.promotionPlatform,f.promotionPlatform,'isPromotionPlatform');}}var h=function(b){var a=i+b;return e.push(a),a;},f=b.define(i,function(e){e.navCrumbs=[{text:'\u4EA7\u54C1\u8FD0\u8425',href:'#/productoperad/list'},{text:'\u521B\u5EFA\u8FD0\u8425\u4FE1\u606F'}],e.titleType='\u521B\u5EFA\u8FD0\u8425\u4FE1\u606F',e.pageType=parseInt(j.params.type),e.fileId=parseInt(j.params.id),e.pageType||(e.titleType='\u4FEE\u6539\u8FD0\u8425\u4FE1\u606F',e.navCrumbs[1].text='\u4FEE\u6539\u8FD0\u8425\u4FE1\u606F');var k=d.getAppData('user');e.dateType='',e.isEdit='',e.isProducts='',e.isPromotionPlatform='',e.productType=[{text:'CRM',value:1,isSelect:'0'},{text:'ERP',value:2,isSelect:'0'},{text:'\u8F6FPOS',value:3,isSelect:'0'},{text:'\u8FD0\u8425\u5E73\u53F0',value:4,isSelect:'0'},{text:'\u8D85\u7EA7\u62A5\u8868',value:5,isSelect:'0'},{text:'\u8D85\u7EA7\u9884\u5B9A',value:6,isSelect:'0'},{text:'\u5FAE\u4FE1',value:7,isSelect:'0'},{text:'\u8D85\u7EA7Wifi',value:8,isSelect:'0'}],e.promotionPlatform=[{text:'CRM',value:1,isSelect:'0'},{text:'ERP',value:2,isSelect:'0'},{text:'\u8F6FPOS',value:3,isSelect:'0'}];var i=new Date();e.requestData={id:'',title:'',content:'',productType:[],promotionPlatform:[],beginTime:a(i).format('YYYY-MM-DD'),endTime:a(i).format('YYYY-MM-DD'),isOpen:'1'},e.setChecked=function(d,a){var e=!0;if(this.checked){for(var c=0;c<a.length;c++)a[c]==d&&(e=!1);e&&a.push(d);}else for(var b=0;b<a.length;b++)a[b]==d&&a.splice(b,1);},e.setProducts=function(){var a=this.value,b=f.requestData.productType;f.setChecked.call(this,a,b),b.length?$('.isProducts').val(a):$('.isProducts').val('');var d=$('.add-edit-content')[0],e=$('.isProducts',d);c.testing(d,e);},e.setPlatform=function(){var a=this.value,b=f.requestData.promotionPlatform;f.setChecked.call(this,a,b),b.length?$('.isPromotionPlatform').val(a):$('.isPromotionPlatform').val('');var d=$('.add-edit-content')[0],e=$('.isPromotionPlatform',d);c.testing(d,e);},e.setRadio=function(){var a=this.value;f.requestData.isOpen=a;},e.$dateOpts={calendarId:h('DateCalendarId'),minDate:new Date(),onClickDate:function(b){if(f.dateType=='beginTime'){f.requestData.beginTime=a(b).format('YYYY-MM-DD');var c=a(f.requestData.beginTime)/1,d=a(f.requestData.endTime)/1;d<c&&(f.requestData.endTime=a(b).format('YYYY-MM-DD'));}else f.dateType=='endTime'&&(f.requestData.endTime=a(b).format('YYYY-MM-DD'));$(this.widgetElement).hide();}},e.openDateCalendar=function(){var i=$(this),d=b.getVm(h('DateCalendarId')),g,j=i.offset();f.dateType=i.attr('data-type'),d?g=$(d.widgetElement):(g=$('<div ms-widget="calendar,$,$dateOpts"></div>'),g.css({position:'absolute','z-index':10000}).hide().appendTo('body'),b.scan(g[0],[e]),d=b.getVm(h('DateCalendarId')),c.regGlobalMdExcept({element:g,handler:function(){g.hide();}})),f.dateType=='beginTime'?(f.requestData.beginTime?d.focusDate=a(f.requestData.beginTime,'YYYY-MM-DD')._d:d.focusDate=new Date(),d.minDate=a(a(new Date()).format('YYYY-MM-DD'),'YYYY-MM-DD')._d):f.dateType=='endTime'&&(f.requestData.endTime?d.focusDate=a(f.requestData.endTime,'YYYY-MM-DD')._d:d.focusDate=new Date(),d.minDate=a(f.requestData.beginTime,'YYYY-MM-DD')._d,d.maxDate=''),g.css({top:j.top+i.outerHeight()-1,left:j.left}).show();},e.$editorOpts={editorId:h('editorId'),ueditorOptions:{UEDITOR_HOME_URL:d.WIDGET_PATH+'editor/ueditor/',serverUrl:d.BASE_PATH,toolbars:[['fullscreen','source','|','undo','redo','|','bold','italic','underline','fontborder','strikethrough','superscript','subscript','removeformat','formatmatch','autotypeset','blockquote','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','selectall','cleardoc','|','rowspacingtop','rowspacingbottom','lineheight','|','customstyle','paragraph','fontfamily','fontsize','|','directionalityltr','directionalityrtl','indent','|','justifyleft','justifycenter','justifyright','justifyjustify','|','touppercase','tolowercase','|','link','unlink','anchor','|','imagenone','imageleft','imageright','imagecenter','simpleupload','insertimage']]}},setTimeout(function(){$('#edui1').css('z-index',10);},1000),e.saveData=function(){var i=b.getVm(h('editorId'));$('.isEdit').val(i.core.getContent());var j=$('.add-edit-content')[0];if(c.testing(j)){var e=f.requestData.$model;e.content=i.core.getContent(),e.beginTime=a(f.requestData.$model.beginTime)/1,e.endTime=a(f.requestData.$model.endTime)/1,c.c2s({url:d.BASE_PATH+'sysProductOperation/saveSysProductOperation.do',type:'post',contentType:'application/json',data:g.stringify(e),success:function(a){a.flag&&c.alert({content:'\u64CD\u4F5C\u6210\u529F\uFF01',iconType:'success',onSubmit:function(){window.location.href=d.BASE_PATH+'#!/productoperad/list';}});}});}};});b.scan(l[0]),f.pageType||m({id:f.fileId},'sysProductOperation/getSysProductOperation.do',n);},$remove:function(a,c){_.each(e,function(c){var a=b.getVm(c);a&&$(a.widgetElement).remove();}),e.length=0;}}),f;});

//From origin\page\productoperad\list\info\info.js
define('originpageproductoperadlistinfoinfojs',['avalon','util','json','moment','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetgridgridjs'],function(a,e,g,h){var f=this,b=f.erp,d={},c=[];return _.extend(d,{$init:function(i,f,j){var d=function(b){var a=f+b;return c.push(a),a;},k=a.define(f,function(c){c.navCrumbs=[{text:'\u4EA7\u54C1\u8FD0\u8425',href:'#/productoperad/list'},{text:'\u8D44\u6599\u8BE6\u60C5'}],c.path=b.BASE_PATH,c.pageUserId=b.getAppData('user').id,c.fileId=parseInt(j.params.id),c.keyword='',c.$gridOpts={gridId:d('-grid'),disableCheckAll:!0,disableCheckbox:!0,getTemplate:function(b){var a=b.split('MS_OPTION_TBAR');return'<div class="ui-grid-tbar fn-clear"><div class="fn-left">\u5171<span class="num">{{gridTotalSize}}</span>\u4E2A\u9700\u6C42\u5546</div><div class="ui-grid-search fn-right"><input type="text" class="input-text" placeholder="\u5546\u6237\u540D" ms-duplex="keyword"><button type="button" class="query-btn main-btn" ms-click="search">\u641C\u7D22</button></div></div>MS_OPTION_TBAR'+a[1];},columns:[{dataIndex:'insertTime',text:'\u65E5\u671F',html:!0,renderer:function(b,a){return h(a.insertTime).format('YYYY-MM-DD');}},{dataIndex:'merchantName',text:'\u5546\u6237\u540D'},{dataIndex:'storeName',text:'\u95E8\u5E97\u540D\u79F0'},{dataIndex:'userName',text:'\u59D3\u540D'},{dataIndex:'tel',text:'\u624B\u673A\u53F7'},{dataIndex:'position',text:'\u804C\u4F4D'}],onLoad:function(a,d){a=_.extend(a,{merchantName:_.str.trim(c.keyword),productOperationId:c.fileId}),e.c2s({url:b.BASE_PATH+'sysUserRequirement/listSysUserRequirements.do',contentType:'application/json',data:g.stringify(a),success:function(a){var b;a.flag&&(b=a.data,d.call(this,b));}});},search:function(){console.log(c.keyword),a.getVm(d('-grid')).load();},jump:function(){var a=$(this).attr('data-id');e.jumpPage('#/productoperad/list/info/'+a);}};});a.scan(i[0]),a.getVm(d('-grid')).load();},$remove:function(b,d){_.each(c,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),c.length=0;}}),d;});

//From origin\page\productoperad\list\list.js
define('originpageproductoperadlistlistjs',['avalon','util','json','moment','originwidgetpaginationpaginationjs','originwidgetformselectjs','originwidgetgridgridjs'],function(b,a,g,e){var h=this,c=h.erp,f={},d=[];return _.extend(f,{$init:function(j,h){var f=function(b){var a=h+b;return d.push(a),a;},i=b.define(h,function(d){d.permission={create_oper_info:a.hasPermission('create_oper_info'),modify_oper_info:a.hasPermission('modify_oper_info'),user_req_items:a.hasPermission('user_req_items'),delete_oper_info:a.hasPermission('delete_oper_info')},d.pageUserId=c.getAppData('user').id,d.path=c.BASE_PATH,d.localHref=function(b){a.jumpPage(b);},d.keyword='',d.$gridOpts={gridId:f('-grid'),disableCheckAll:!0,disableCheckbox:!0,getTemplate:function(b){var a=b.split('MS_OPTION_TBAR');return'<div class="ui-grid-tbar fn-clear"><div class="fn-left">\u5171<span class="num">{{gridTotalSize}}</span>\u6761\u63A8\u5E7F\u4FE1\u606F</div><div class="ui-grid-search fn-right"><input type="text" class="input-text" placeholder="\u6807\u9898" ms-duplex="keyword"><button type="button" class="query-btn main-btn" ms-click="search">\u641C\u7D22</button></div></div>MS_OPTION_TBAR'+a[1];},columns:[{dataIndex:'insertTime',text:'\u521B\u5EFA\u65E5\u671F',html:!0,renderer:function(b,a){return e(a.insertTime).format('YYYY-MM-DD');}},{dataIndex:'title',text:'\u8425\u9500\u6807\u9898',html:!0,renderer:function(b,a){return'<a href="javascript:;" ms-data-id ='+a.id+' ms-click="jump">'+a.title+'</a>';}},{dataIndex:'time_limit',text:'\u63A8\u5E7F\u5E73\u53F0',html:!0,renderer:function(e,d){var b=d.dicPlatforms,c='';for(var a=0;a<b.length;a++)c+=c?'\u3001'+b[a].dictionaryValue:b[a].dictionaryValue;return c;}},{dataIndex:'amount',text:'\u9700\u6C42\u91CF',html:!0,renderer:function(b,a){return'<a href="javascript:;" ms-data-id ='+a.id+' ms-click="jump">'+a.amount+'</a>';}},{dataIndex:'beginTime',text:'\u63A8\u5E7F\u5F00\u59CB',html:!0,renderer:function(b,a){return e(a.beginTime).format('YYYY-MM-DD');}},{dataIndex:'endTime',text:'\u63A8\u5E7F\u622A\u6B62',html:!0,renderer:function(b,a){return e(a.endTime).format('YYYY-MM-DD');}},{dataIndex:'isOpen',text:'\u64CD\u4F5C',html:!0,renderer:function(c,a){var b=parseInt(a.isOpen);return b?'<div class="choose"><span ms-if="permission.modify_oper_info"  class="stop" data-id='+a.id+' data-openType="0" ms-click="setOpen"> \u505C\u7528</span>'+'<a ms-if="permission.modify_oper_info" href="javascript:;" data-id='+a.id+' ms-click="openEdit">\u4FEE\u6539</a>'+'<a ms-if="permission.delete_oper_info" href="javascript:;" data-id='+a.id+' ms-click="removeOne">\u5220\u9664</a>'+'</div>':'<div class="choose"><span ms-if="permission.modify_oper_info"  class="start" data-id='+a.id+' data-openType="1" ms-click="setOpen"> \u542F\u7528</span>'+'<a ms-if="permission.modify_oper_info" href="javascript:;" data-id='+a.id+' ms-click="openEdit">\u4FEE\u6539</a>'+'<a ms-if="permission.delete_oper_info" href="javascript:;" data-id='+a.id+' ms-click="removeOne">\u5220\u9664</a>'+'</div>';}}],onLoad:function(b,e){b=_.extend(b,{title:_.str.trim(d.keyword)}),a.c2s({url:c.BASE_PATH+'sysProductOperation/listSysProductOperations.do',contentType:'application/json',data:g.stringify(b),success:function(a){var b;a.flag&&(b=a.data,e.call(this,b));}});},search:function(){b.getVm(f('-grid')).load();},jump:function(){var b=$(this).attr('data-id');i.permission.user_req_items?a.jumpPage('#/productoperad/list/info/'+b):a.alert({content:'\u60A8\u6CA1\u6709\u67E5\u770B\u8BE6\u60C5\u7684\u6743\u9650\uFF01',iconType:'info'});},setOpen:function(){var h=$(this).attr('data-id'),i=$(this).attr('data-openType'),d=b.getVm(f('-grid'));d.selectById(h);var e=d.getSelectedData()[0];a.c2s({url:c.BASE_PATH+'sysProductOperation/saveSysProductOperation.do',contentType:'application/json',data:g.stringify({id:h,isOpen:i}),success:function(a){a.flag&&(d.updateData({id:e.id,isOpen:e.isOpen=='1'?'0':'1'}),d.unselectById(e.id));}});},removeOne:function(){var d=$(this).attr('data-id');a.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u4FE1\u606F\u5417\uFF1F',onSubmit:function(){a.c2s({url:c.BASE_PATH+'sysProductOperation/deleteSysProductOperation/'+d+'.do',success:function(a){a.flag&&b.getVm(f('-grid')).load();}});}});},openEdit:function(){var b=$(this).attr('data-id');a.jumpPage('#/productoperad/list/addedit/0/'+b);}};});b.scan(j[0]),b.getVm(f('-grid')).load();},$remove:function(a,c){_.each(d,function(c){var a=b.getVm(c);a&&$(a.widgetElement).remove();}),d.length=0;}}),f;});

//From origin\page\sales\home\home.js
define('originpagesaleshomehomejs',['avalon','util','json','originwidgetpaginationpaginationjs','originwidgetformselectjs'],function(a,b,g){var f=this,d=f.erp,e={},c=[];return _.extend(e,{$init:function(l,j){function f(c,e,f){var a=g.stringify(c);b.c2s({url:d.BASE_PATH+e,type:'post',contentType:'application/json',data:a,success:f});}function i(r){var j,t=a.getVm(h('paginationPage'));if(r.flag){e.merchantListData=[],j=r.data;function u(a,b){return a.stepId>b.stepId?1:-1;}for(var b=0,m=j.rows.length;b<m;b++)j.rows[b].listSteps.sort(u);for(var b=0,m=j.rows.length;b<m;b++){var o=[{index:'1',health:0},{index:'2',health:0},{index:'3',health:0},{index:'4',health:0}],d=j.rows[b].synHealthDegrees;for(var l=0,p=d.length;l<p;l++){var k={};k.index=d[l].targetType,d[l].healthDegree<100?k.health=0:k.health=1;for(var n=0,q=o.length;n<q;n++)o[n].index==k.index&&(o[n]=k);}j.rows[b].healthType=o;}var d=j.rows;for(var b=0;b<d.length;b++){var g={};for(var c in d[b]){var s=d[b].hasOwnProperty(c);if(s){if(c=='merchantId'&&(g.merchantId=d[b][c]),c=='merchantName'&&(g.merchantName=d[b][c]),c=='merchantStatus'&&(g.merchantStatus=d[b][c]),c=='salesName'){var i=[];if(d[b][c]instanceof Array)i=d[b][c];else{var f={};f.id=0,f.tel=0,f.userName=d[b][c],i.push(f);}g.salesName=i;}if(c=='listUsers'){var i=[];if(d[b][c]instanceof Array)i=d[b][c];else{var f={};f.id=0,f.tel=0,f.userName=d[b][c],i.push(f);}g.listUsers=i;}c=='merchantStatusText'&&(g.merchantStatusText=d[b][c]),c=='listSteps'&&(g.listSteps=d[b][c]),c=='healthType'&&(g.healthType=d[b][c]);}}e.merchantListData.push(g);}t.total=j.totalSize;}}function k(c){var b,d=a.getVm(h('paginationPage'));c.flag&&(e.backlogListData=[],b=c.data,e.backlogListData=b.rows,d.total=b.totalSize);}function m(a){var b;a.flag&&(b=a.data,e.dotolen=b.rows.length);}var h=function(b){var a=j+b;return c.push(a),a;},e=a.define(j,function(c){c.pageUserId=d.getAppData('user').id,c.pageStatus=1,c.merchantListData=[],c.backlogListData=[],c.dotolen=0,c.backlogRequestData={userId:c.pageUserId,inputItemTypes:['03'],merchantName:'',pageNumber:1,pageSize:10,businessTypes:['1']},c.merchantRequestData={merchantStatus:'',userId:c.pageUserId,pageSize:10,pageNumber:1,merchantName:'',merchantStatusType:1},c.localHref=function(a){b.jumpPage(a);},c.permission={sales_remaind:b.hasPermission('sales_remaind'),sales_ques_mag:b.hasPermission('sales_ques_mag'),sales_address:b.hasPermission('sales_address'),sales_my_merchant:b.hasPermission('sales_my_merchant'),sales_todolist:b.hasPermission('sales_todolist')},c.changePageStatus=function(b){c.pageStatus=b;var d=a.getVm(h('paginationPage'));d.currentPage=1,b==1?(e.merchantRequestData.merchantName='',f(e.merchantRequestData.$model,'myHomePage/getComplexSynMerchants.do',i)):b==2&&(e.backlogRequestData.merchantName='',f(e.backlogRequestData.$model,'myHomePage/getComplexSysToDoLists.do',k));},c.changeStatus=function(d){c.merchantRequestData.merchantStatus=d;var b=a.getVm(h('paginationPage'));e.merchantRequestData.pageNumber=1,b.currentPage=1,f(e.merchantRequestData.$model,'myHomePage/getComplexSynMerchants.do',i);},c.merchantSearch=function(){f(e.merchantRequestData.$model,'myHomePage/getComplexSynMerchants.do',i);},c.showProgressTip=function(){var d=this.$vmodel.$model,e=d.el.stepText,b=j+'-progress-tip',f=$(this),a=$('#'+b),c=f.offset();a.length||(a=$('<div id="'+b+'" class="grid-tip"></div>'),a.html('<span class="text-content"></span><span class="icon-arrow"></span>'),a.hide().appendTo('body')),$('.text-content',a).text(e),a.css({top:c.top-a.height()-20,left:c.left-a.width()/2-11}).show();},c.hideProgressTip=function(){$('#'+j+'-progress-tip').hide();},c.backlogSearch=function(){f(e.backlogRequestData.$model,'myHomePage/getComplexSysToDoLists.do',k);},c.doToStatus=function(c){var b=a.getVm(h('paginationPage'));b.currentPage=1,e.backlogRequestData.pageNumber=1,e.backlogRequestData.inputItemTypes=c,f(e.backlogRequestData.$model,'myHomePage/getComplexSysToDoLists.do',k);},c.$paginationOpts={paginationId:h('paginationPage'),total:0,onJump:function(c,d){var b=a.getVm(h('paginationPage'));e.pageStatus==1?(e.merchantRequestData.pageNumber=b.currentPage,f(e.merchantRequestData.$model,'myHomePage/getComplexSynMerchants.do',i)):e.pageStatus==2&&(e.backlogRequestData.pageNumber=b.currentPage,f(e.backlogRequestData.$model,'myHomePage/getComplexSysToDoLists.do',k));}};});a.scan(l[0]),f(e.backlogRequestData.$model,'myHomePage/getComplexSysToDoLists.do',m),f(e.merchantRequestData.$model,'myHomePage/getComplexSynMerchants.do',i);},$remove:function(b,d){_.each(c,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),c.length=0;}}),e;});

//From origin\page\sales\home\waiting\waiting.js
define('originpagesaleshomewaitingwaitingjs',['avalon','util','json','moment','dialog','originwidgetformselectjs','originwidgetformformjs','originwidgetcalendarcalendarjs','originwidgetuploaderuploaderjs','originmoduleinterviewinterviewjs','originmodulesurveysurveyjs','originmoduleaddressaddressjs'],function(a,c,d){var g=this,b=g.erp,f={},e=[];return _.extend(f,{$init:function(m,k,n){function h(e,g,h){var a=d.stringify(e);f.pageData=[],c.c2s({url:b.BASE_PATH+g,type:'post',contentType:'application/json',data:a,success:h});}function j(e){var b;if(e.flag){b=e.data;var a={};a.productList=b.productList,a.filePath=b.filePath;var c=b.merchantInfo;for(var d in c){var g=c.hasOwnProperty(d);g&&(a[d]=c[d]);}a.attachment_name?a.imgUrl=f.path+a.filePath+'/'+a.attachment_path+'/'+a.attachment_name:a.imgUrl=f.path+'portal/origin/asset/image/merchant-default-logo.jpg',f.merchantData=a;}}function i(a){var b;a.flag&&(b=a.data,f.pageData=b);}var g=function(b){var a=k+b;return e.push(a),a;},l=b.getAppData('user'),f=a.define(k,function(e){e.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/sales/home'},{text:'\u5F85\u529E\u4E8B\u9879'}],e.path=b.BASE_PATH,e.pageUserId=b.getAppData('user').id,e.merchantId=parseInt(n.params.id),e.imgUrl='',e.isLogo=!1,e.pageData={},e.localHref=function(a){c.jumpPage(a);};var k=function(){e.merchantData={productList:[],filePath:'',merchant_status:'',merchant_name:'',front_user_name:'',sale_user_name:'',assist_user_name:'',person_avg:'',desk_avg:'',store_number:'',begin_time:'',plan_online_time:'',format_name:'',attachment_name:'',attachment_path:''};};k();var m=function(){e.options1=[],e.$addQuestionDialogOpts={dialogId:g('addQuestionDialog'),getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD&nbsp;\u5B58</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(g('addQuestionForm'));b.reset(),b.title='',b.description='';},submit:function(k){var e,i=a.getVm(g('addQuestionDialog')),h=a.getVm(g('addQuestionForm'));if(h.validate()){e=h.getFormData();var j=a.getVm(g('addQuestionSelect')).selectedValue;e.merchantId=f.merchantId,e.problemType=j,e.problemStatus=1,e=d.stringify(e),c.c2s({url:b.BASE_PATH+'sysProblem/saveSysProblem.do',type:'post',contentType:'application/json',data:e,success:function(a){a.flag==1&&i.close();}});}}},e.openAdd=function(){var d=a.getVm(g('addQuestionSelect'));e.options1.length?d.setOptions(e.options1):c.c2s({url:b.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000040',success:function(a){var b;a.flag&&(b=a.data,e.options1=_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}),d.setOptions(e.options1));}});var f=a.getVm(g('addQuestionDialog')),h=a.getVm(g('addQuestionForm'));f.title='\u6DFB\u52A0\u95EE\u9898',h.title='',h.description='',f.open();},e.$addQuestionFormOpts={formId:g('addQuestionForm'),field:[{selector:'.title',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.description',rule:['noempty',function(b,a){return a[0]!==!0?'\u95EE\u9898\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],title:'',description:''},e.$scheduleOpts={selectId:g('addQuestionSelect'),options:[],selectedIndex:1};};m(),e.$surveyOpts={surveyId:g('-surveyModule'),readonly:'',merchantId:'',callFn:function(){h({merchantId:f.merchantId},'mktShopSurvey/listMktShopSurveys.do',i),h({merchantId:f.merchantId},'synMerchant/getMerchantInfoByOrder.do',j);}},e.addSurvey=function(){var b=a.getVm(g('-surveyModule'));f.pageData.isDisabled==3?b.readonly=1:b.readonly=0,b.moduleType='mkt',b.merchantId=f.merchantId,$(this).attr('data-id')?b.requestData={merchantId:f.merchantId,id:$(this).attr('data-id')}:b.requestData={merchantId:f.merchantId},b.open();},e.removeResearch=function(e,g){var a={id:e,moduleType:'mkt',storeId:g};a=d.stringify(a),c.confirm({content:'\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8C03\u7814\u5355\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'mktShopSurvey/deleteMktShopSurvey.do',type:'post',contentType:'application/json',data:a,success:function(a){a.flag==1&&h({merchantId:f.merchantId},'mktShopSurvey/listMktShopSurveys.do',i);}});}});},e.$interviewOpts={interviewId:g('-interviewModule'),sessionId:'',readonly:'',moduleType:'',merchantId:'',callFn:function(){h({merchantId:f.merchantId},'mktShopSurvey/listMktShopSurveys.do',i),h({merchantId:f.merchantId},'synMerchant/getMerchantInfoByOrder.do',j);}},e.addInterval=function(){var b=a.getVm(g('-interviewModule'));b.requestData={merchantId:f.merchantId},b.sessionId=l.sessionId,f.pageData.isDisabled==3?b.readonly=1:b.readonly=0,b.moduleType='mkt',b.merchantId=f.merchantId,b.requestData={merchantId:f.merchantId},b.open();},e.$addressOpts={addressId:g('-addressModule'),readonly:'',moduleType:'mkt',merchantId:''},e.addCommunication=function(k){var e=a.getVm(g('-addressModule'));e.readonly=0,e.callFn=function(){k&&c.c2s({url:b.BASE_PATH+'contact/searchContacts.do',type:'post',contentType:'application/json',data:d.stringify({merchantId:f.merchantId}),success:function(c){var d;if(c.flag){d=c.data.rows;var e=a.getVm(k),b=_.map(d,function(a){return{text:a.name,value:a.id};});b.unshift({text:'\u8BF7\u9009\u62E9',value:''}),e.setOptions(b);}}}),h({merchantId:f.merchantId},'mktShopSurvey/listMktShopSurveys.do',i),h({merchantId:f.merchantId},'synMerchant/getMerchantInfoByOrder.do',j);},$(this).attr('data-id')?e.requestData={merchantId:f.merchantId,id:$(this).attr('data-id')}:e.requestData={merchantId:f.merchantId},$(this).attr('data-readonly')?e.readonly=1:e.readonly=0,e.open();},e.showCommunication=function(a){c.c2s({url:b.BASE_PATH+'contact/editContact.do',type:'post',data:{contactIdStr:a},success:function(a){var b;a.flag&&(b=a.data,f.communicationRequestData=b,e.addCommunication('edit'));}});},e.stepEnd=function(){c.confirm({content:'\u4F60\u786E\u5B9A\u5B8C\u6210\u4E86\u5417\uFF1F',onSubmit:function(){c.c2s({url:b.BASE_PATH+'mktShopSurvey/salesComfirm.do',type:'get',contentType:'application/json',data:{merchantId:f.merchantId},success:function(a){a.flag&&h({merchantId:f.merchantId},'mktShopSurvey/listMktShopSurveys.do',i);}});}});};});a.scan(m[0]),h({merchantId:f.merchantId},'synMerchant/getMerchantInfoByOrder.do',j),h({merchantId:f.merchantId},'mktShopSurvey/listMktShopSurveys.do',i);},$remove:function(b,c){_.each(e,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),e.length=0;}}),f;});

//From origin\page\study\casemanage\casemanage.js
define('originpagestudycasemanagecasemanagejs',['avalon','util'],function(b,e){var c=this,d=c.erp,a={};return _.extend(a,{$init:function(a,c){var e=b.define(c,function(a){a.externalLink=d.BASE_PATH+'erp/project/toProjectItems.do',a.iframeHeight=1,a.onIframeLoad=function(){var b=$(this.contentWindow.document.body);$('.page-hd',b).hide(),a.iframeHeight=b.height()+60;};});b.scan(a[0]);},$remove:function(a,b){}}),a;});

//From origin\page\study\coursemanage\coursedetail\coursedetail.js
define('originpagestudycoursemanagecoursedetailcoursedetailjs',['avalon','util','sortable','originmodulecwselectorcwselectorjs','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs'],function(a,b,f){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(g,h,e){function j(){b.c2s({url:c.BASE_PATH+'course/getCourseDetail.do',data:{pageSize:10000,pageNumber:1,courseId:e.params.id},success:function(b){var a;b.flag==1&&(a=b.data,d.requiredCourseware=_.map(a.requiredCourseware,function(a){return{coursewareId:a.courseware_id,coursewareName:a.courseware_name,timeLimit:a.time_limit};}),d.optionalCourseware=_.map(a.noRequiredCourseware,function(a){return{coursewareId:a.courseware_id,coursewareName:a.courseware_name,timeLimit:a.time_limit};}));}});}var f=h+'-cwselector',i=decodeURIComponent(e.params.courseName),d=a.define(h,function(d){d.requiredCourseware=[],d.optionalCourseware=[],d.courseType='',d.navCrumbs=[{text:'\u8BFE\u7A0B\u7BA1\u7406',href:'#/study/coursemanage'},{text:i,href:'#/study/coursemanage'},{text:'\u67E5\u770B\u8BFE\u7A0B\u8BE6\u60C5'}],d.$cwselectorOpts={cwselectorId:f,multi:!0,onListReady:function(a){var b=d[d.courseType+'Courseware'];_.each(b.$model,function(c){var b=-1;_.some(a.$model,function(a,d){return a.id==c.coursewareId?(b=d,!0):void 0;})&&a.set(b,{isSelected:!0});});var c=d.courseType=='optional'?'required':'optional',e=d[c+'Courseware'];_.each(e.$model,function(c){var b=-1;_.some(a.$model,function(a,d){return a.id==c.coursewareId?(b=d,!0):void 0;})&&a.removeAt(b);});},onSubmit:function(a){a.length&&(d[d.courseType+'Courseware'].clear(),d[d.courseType+'Courseware']=_.map(a,function(a){return{coursewareId:a.id,coursewareName:a.coursewareName,timeLimit:a.timeLimit};}));}},d.openAdd=function(){var b=a.getVm(f);d.courseType=a(this).data('courseType'),b.open();},d.removeGridItem=function(){var b=a(this).data('courseType'),c=this.$vmodel.$model;d[b+'Courseware'].removeAt(c.$index);},d.deleteAll=function(){var c=a(this).data('courseType');b.confirm({content:'\u786E\u5B9A\u5C06\u8BFE\u4EF6\u90FD\u5220\u9664?',onSubmit:function(){d[c+'Courseware'].removeAll();}});},d.saveCourseware=function(){var a=[],f={courseId:e.params.id/1};if(_.each(d.requiredCourseware.$model,function(b){a.push({coursewareId:b.coursewareId,reRequired:'1'});}),_.each(d.optionalCourseware.$model,function(b){a.push({coursewareId:b.coursewareId,reRequired:'0'});}),!a.length){b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u81F3\u5C11\u4E00\u4E2A\u8BFE\u4EF6'});return;}f.coursewareInfos=a,b.c2s({url:c.BASE_PATH+'course/saveCourseware.do',type:'post',contentType:'application/json',data:JSON.stringify(f),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){b.jumpPage('#/study/coursemanage');}});}});};});a.scan(g[0],[d]),j(),$('.required-grid, .not-required-grid',g).sortable({containerSelector:'table',itemPath:'> tbody',itemSelector:'tr',placeholder:'<tr class="drag-sort-placeholder"><td colspan="4">&nbsp;</td></tr>',onDrop:function(f,h,g){var b=f.closest('table'),c=b.hasClass('required-grid')?'required':'optional',e=[];$('tbody tr',b).each(function(){var b=a(this).data('coursewareId');_.some(d[c+'Courseware'].$model,function(a){a.coursewareId==b&&e.push(a);});}),d[c+'Courseware']=e,g(f);}});},$remove:function(d,c){var b=c+'-cwselector';$(a.getVm(b).widgetElement).remove();}}),d;});

//From origin\page\study\coursemanage\coursemanage.js
define('originpagestudycoursemanagecoursemanagejs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetgridgridjs','originmodulepositionselectorpositionselectorjs'],function(a,b){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(j,f){var g=f+'-add-edit-dialog',e=f+'-add-edit-form',d=f+'-grid',h=f+'-positionselector',i=a.define(f,function(f){f.permission={magCourse:b.hasPermission('mag_course'),viewCourse:b.hasPermission('view_course'),finalExamRule:b.hasPermission('final_exam_rule')},f.$gridOpts={gridId:d,recordUnit:'\u79CD\u8BFE\u7A0B',columns:[{dataIndex:'course_name',text:'\u8BFE\u7A0B\u540D\u79F0'},{dataIndex:'time_limit',text:'\u8BFE\u7A0B\u9650\u65F6\uFF08\u5C0F\u65F6\uFF09'},{dataIndex:'count_is_required',text:'\u8BFE\u4EF6\u5B89\u6392',renderer:function(b,a){return'\u5FC5\u4FEE\u8BFE'+a.count_is_required+'\u8282,\u9009\u4FEE\u8BFE'+a.count_is_not_required+'\u8282';}},{dataIndex:'operation',text:'\u8BFE\u4EF6\u5B89\u6392',html:!0,renderer:function(b,a){return'<a href="#/study/coursemanage/coursedetail/'+a.id+'/'+a.course_name+'"'+' class="edit-l" ms-if="permission.viewCourse" data-course-id="'+a.id+'">\u67E5\u770B\u8BFE\u7A0B\u8BE6\u60C5</a>&nbsp;&nbsp;&nbsp;&nbsp;'+'<a href="javascript:;" class="ref-position-l"'+' ms-if="permission.finalExamRule"'+' ms-click="openPositonRef"'+' data-course-id="'+a.id+'">\u5173\u8054\u804C\u4F4D</a>&nbsp;&nbsp;&nbsp;&nbsp;'+'<a href="#/study/coursemanage/examrule/'+a.id+'/'+a.course_name+'" class="edit-l"'+' ms-if="permission.finalExamRule"'+' data-course-id="'+a.id+'">\u671F\u672B\u8003\u8BD5\u89C4\u5219</a>&nbsp;&nbsp;&nbsp;&nbsp;'+'<a href="javascript:;" class="edit-l" ms-click="openEdit"'+' ms-if="permission.magCourse"'+' data-course-id="'+a.id+'" data-course-name="'+a.course_name+'"'+' data-time-limit="'+a.time_limit+'">\u4FEE\u6539</a>&nbsp;&nbsp;&nbsp;&nbsp;'+'<a href="javascript:;" class="remove-l" ms-if="permission.magCourse" ms-click="removeGridItem"'+' data-course-id="'+a.id+'">\u5220\u9664</a></td>';}}],onLoad:function(a,d){b.c2s({url:c.BASE_PATH+'course/getCourseInfo.do',data:a,success:function(a){var b;a.flag&&(b=a.data,d.call(this,b));}});},openEdit:function(){var c=a.getVm(g),h=a.getVm(e),i=a.getVm(d),b=$(this),j=b.data('courseId')+'',k=b.data('courseName'),l=b.data('timeLimit');c.title='\u7F16\u8F91\u8BFE\u7A0B',h.courseName=k,h.timeLimit=l,f.addEditState='edit',i.selectById(j,!0),c.open();},openPositonRef:function(){var b=$(this),c=a.getVm(d),e=a.getVm(h),f=b.data('courseId');c.selectById(f,!0),e.open();},removeGridItem:function(){var c=$(this),b=a.getVm(d),e=c.data('courseId');b.selectById(e,!0),b._removeCourse();},batchRemoveGridItem:function(){a.getVm(d)._removeCourse();},_removeCourse:function(){var g,h,i,e=a.getVm(d),f=e.getSelectedData();f.length===0?b.alert({content:'\u8BF7\u5148\u9009\u4E2D\u8BFE\u7A0B'}):(g=_.map(f,function(a){return a.id;}),i=c.BASE_PATH+'course/deleteCourse.do',h=JSON.stringify({idString:g}),b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u8BFE\u7A0B\u5417\uFF1F',onSubmit:function(){b.c2s({url:i,type:'post',dataType:'json',contentType:'application/json',data:h,success:function(a){a.flag==1&&e.load();}});}}));}},f.$psOpts={positionselectorId:h,multi:!0,onListRequestData:function(e){var b=a.getVm(d),c=b.getSelectedData();return _.extend(e,{courseId:c[0].id/1});},onListReady:function(a){_.each(a.$model,function(b,c){b.isChoosed&&a.set(c,{isSelected:!0});});},onSubmit:function(e){var f=a.getVm(d),g=f.getSelectedData();e.length?b.c2s({url:c.BASE_PATH+'traPositionCourse/saveTraPositionCourse.do',type:'post',dataType:'json',contentType:'application/json',data:JSON.stringify(_.map(e,function(a){return{positionId:a.id/1,courseId:g[0].id/1};})),success:function(a){}}):b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u804C\u4F4D'});}},f.addEditState='',f.$addEditDialogOpts={dialogId:g,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e);b.reset(),b.courseName='',b.timeLimit='';},submit:function(o){var h,j,n=a.getVm(g),k=a.getVm(e),i=a.getVm(d),l=f.addEditState,m;k.validate()&&(h=k.getFormData(),l=='edit'?(m=i.getSelectedData()[0].id,_.extend(h,{id:m}),j=c.BASE_PATH+'course/updateCourse.do'):j=c.BASE_PATH+'course/saveCourse.do',b.c2s({url:j,type:'post',data:h,success:function(a){a.flag==1&&(l=='edit'?_.some(i.gridData.$model,function(a,b){return a.id==m?(i.gridData.set(b,{course_name:h.courseName,time_limit:h.timeLimit}),!0):void 0;}):i.load(),n.close());}}));}},f.$addEditFormOpts={formId:e,field:[{selector:'.course-name',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BFE\u7A0B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.time-limit',name:'timeLimit',rule:['noempty',function(a,b){return b[0]!==!0?'\u8BFE\u7A0B\u65F6\u9650\u4E0D\u80FD\u4E3A\u7A7A':/^-?\d+(\.\d{1,1})?$/.test(a)?parseFloat(a,10)<=0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8BFE\u7A0B\u65F6\u9650':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8BFE\u7A0B\u65F6\u9650';}]}],courseName:'',timeLimit:''},f.openAdd=function(){var b=a.getVm(g),c=a.getVm(e),h=a.getVm(d);b.title='\u6DFB\u52A0\u8BFE\u7A0B',c.courseName='',c.timeLimit='',f.addEditState='add',h.unselectById('all'),b.open();};});a.scan(j[0],[i]),a.getVm(d).load();},$remove:function(g,b){var c=b+'-add-edit-dialog',d=b+'-add-edit-form',e=b+'-grid',f=b+'-positionselector';$(a.getVm(e).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(c).widgetElement).remove(),$(a.getVm(f).widgetElement).remove();}}),d;});

//From origin\page\study\coursemanage\examrule\examrule.js
define('originpagestudycoursemanageexamruleexamrulejs',['avalon','util','json','originwidgetformformjs','dialog','originwidgetuploaderuploaderjs','originwidgetformselectjs','originmoduleqselectorqselectorjs'],function(a,b,e){var f=this,c=f.erp,d={};return _.extend(d,{$init:function(m,f,k){function n(){b.c2s({url:c.BASE_PATH+'finalExamRule/getFinalExamRuleByCourseId.do',data:e.stringify({courseId:g}),contentType:'application/json',success:function(c){var b;c.flag&&(b=c.data,d.ruleId=b.id||0,d.total=b.total||'',d.timeLimit=b.time_limit||'',d.passScore=b.pass_score||'',d.interviewScores=b.interview_scores||'',a.getVm(h).select(b.final_exam_rule_type/1),d.selectedWriteList=_.map(b.finalExamQuestions,function(a){return{id:a.question_id,question:a.question,questionType:a.question_type,pptName:a.ppt_name};}));}});}var i=f+'-form',j=f+'-qselector',h=f+'-write-range',g=k.params.id/1,l=decodeURIComponent(k.params.courseName),d=a.define(f,function(k){k.state=f.split('-').pop(),k.navCrumbs=[{text:'\u8BFE\u7A0B\u7BA1\u7406',href:'#/study/coursemanage'},{text:l,href:'#/study/coursemanage'},{text:'\u671F\u672B\u8003\u8BD5\u89C4\u5219'}],k.total='',k.timeLimit='',k.passScore='',k.ruleId=0,k.interviewScores='',k.selectedWriteList=[],k.examRange='all',k.$writeRangeOpts={selectId:h,options:[{text:'\u5168\u90E8\u968F\u673A',value:'0'},{text:'\u90E8\u5206\u968F\u673A',value:'1'}],onSelect:function(a,b,c){a=='0'?k.examRange='all':k.examRange='part';}},k.$qselectorOpts={qselectorId:j,multi:!0,listPath:'finalExamRule/getQuestionByCourseId.do',onListRequestData:function(a){return a.courseId=g,a;},onListReady:function(a){_.each(k.selectedWriteList.$model,function(c){var b=-1;_.some(a.$model,function(a,d){return a.id==c.id?(b=d,!0):void 0;})&&a.set(b,{isSelected:!0});});},onSubmit:function(a){a.length?k.selectedWriteList=_.map(a,function(a){return{id:a.id,question:a.question,questionType:a.questionType};}):b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u81F3\u5C11\u4E00\u4E2A\u8BD5\u9898'});}},k.openQuestionSelector=function(){var b=a.getVm(j);b.title='\u9009\u62E9\u5FC5\u8003\u9898',b.open();},k.removeWriteItem=function(){var a=this.$vmodel.$model;k.selectedWriteList.removeAt(a.$index);},k.$formOpts={formId:i,field:[{selector:'.time-limit',name:'timeLimit',rule:['noempty',function(a,b){return b[0]!==!0?'\u8003\u8BD5\u65F6\u9650\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u8BD5\u65F6\u9650':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u8BD5\u65F6\u9650';}]},{selector:'.total',name:'total',rule:['noempty',function(a,b){return b[0]!==!0?'\u8003\u9898\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u9898\u6570\u91CF':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u9898\u6570\u91CF';}]},{selector:'.pass-score',name:'passScore',rule:['noempty',function(a,b){return b[0]!==!0?'\u53CA\u683C\u5206\u6570\u7EBF\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u53CA\u683C\u5206\u6570':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u53CA\u683C\u5206\u6570';}]},{selector:'.interview-scores',name:'interviewScores',rule:['noempty',function(a,b){return b[0]!==!0?'\u4E92\u52A8\u53CA\u683C\u5206\u6570\u7EBF\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E92\u52A8\u53CA\u683C\u5206\u6570':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4E92\u52A8\u53CA\u683C\u5206\u6570';}]}],action:[{selector:'.f-submit',handler:function(m){var k=a.getVm(i),l=a.getVm(h),f,j=[];if(k.validate()){if(f=k.getFormData(),_.extend(f,{id:d.ruleId,courseId:g,finalExamRuleType:l.selectedValue}),d.examRange=='part'){if(j=_.map(d.selectedWriteList.$model,function(a){return a.id;}),!j.length){b.alert({iconType:'error',content:'\u8BF7\u6307\u5B9A\u6709\u6548\u7684\u8003\u9898\u8303\u56F4'});return;}if(j.length>f.total/1){b.alert({iconType:'error',content:'\u5FC5\u8003\u9898\u6570\u91CF\u4E0D\u80FD\u5927\u4E8E\u589E\u52A0\u8003\u9898\u6570\u91CF'});return;}}f.questionIdList=j,b.c2s({url:c.BASE_PATH+'finalExamRule/addFinalExamRule.do',type:'post',contentType:'application/json',data:e.stringify(f),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){b.jumpPage('#/study/coursemanage');}});}});}}}]};});n(),a.scan(m[0],[d]);},$remove:function(f,b){var c=b+'-form',d=b+'-qselector',e=b+'-write-range';$(a.getVm(e).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(c).widgetElement).remove();}}),d;});

//From origin\page\study\coursestudy\coursestudy.js
define('originpagestudycoursestudycoursestudyjs',['avalon','util','json','moment'],function(d,a,g,f){var e=this,b=e.erp,c={};return _.extend(c,{$init:function(h,i,k){function j(){a.c2s({url:b.BASE_PATH+'train/student/getAllCoursewares.do',success:function(h){var d,g,i,b,j;h.flag&&(d=h.data,g=d.required,i=d.optional,b=d.course,j=d.finalExamAvail,c.requiredList=e(g,b),c.requiredList.push({indexNum:g.length+1,isStudied:j?!0:!1,content:j?'<a href="#/study/coursestudy/plainexam/'+b.learningProgressId+'/'+b.id+'/0">\u671F\u672B\u8003\u8BD5</a>':'\u671F\u672B\u8003\u8BD5'}),c.optionalList=e(i,b),c.speaker=d.teachername,b&&(c.coursename=b.courseName,c.endTime=b.endTime?f(b.endTime).format('YYYY-MM-DD HH:mm'):''),g.length||i.length||a.alert({iconType:'info',content:h.message}));}});}function e(b,a){return _.map(b,function(b,e){var c='\u300A'+b.coursewareName+'\u300B',d=!1;return c+='&nbsp;&nbsp;&nbsp;&nbsp;',c+='\u8BFE\u65F6\uFF1A'+b.courseHours,c+='&nbsp;&nbsp;|&nbsp;&nbsp;',c+='\u4E3B\u8BB2\u4EBA\uFF1A'+b.speaker,b.studied&&(c+='&nbsp;&nbsp;<a href="#/study/coursestudy/process/'+a.learningProgressId+'/'+a.id+'/'+b.id+'">\u590D\u4E60\u8BFE\u7A0B</a>',d=!0),b.isNew&&(c+='&nbsp;&nbsp;<a href="#/study/coursestudy/process/'+a.learningProgressId+'/'+a.id+'/'+b.id+'">\u5F00\u59CB\u5B66\u4E60</a>'),b.examined&&(b.paperType=='0'?c+='&nbsp;-&nbsp;<a href="#/study/coursestudy/plainexam/'+a.learningProgressId+'/'+a.id+'/'+b.id+'">\u91CD\u65B0\u8003\u8BD5</a>':c+='&nbsp;-&nbsp;<a href="#/study/coursestudy/recordexam/'+a.learningProgressId+'/'+a.id+'/'+b.id+'">\u91CD\u65B0\u8003\u8BD5</a>'),b.studied&&!b.examined&&(b.paperType=='0'?c+='&nbsp;-&nbsp;<a href="#/study/coursestudy/plainexam/'+a.learningProgressId+'/'+a.id+'/'+b.id+'">\u9A6C\u4E0A\u8003\u8BD5</a>':c+='&nbsp;-&nbsp;<a href="#/study/coursestudy/recordexam/'+a.learningProgressId+'/'+a.id+'/'+b.id+'">\u9A6C\u4E0A\u8003\u8BD5</a>'),{indexNum:e+1,content:c,isNew:b.isNew,isStudied:d};});}var g=b.getAppData('user'),c=d.define(i,function(a){a.requiredList=[],a.optionalList=[],a.speaker='',a.coursename='',a.endTime='';});d.scan(h[0]),g.isFormal=='1'?a.jumpPage('#/study/coursestudy/oldstaffstudy'):j();},$remove:function(a,b){}}),c;});

//From origin\page\study\coursestudy\oldstaffstudy\oldstaffstudy.js
define('originpagestudycoursestudyoldstaffstudyoldstaffstudyjs',['avalon','util','json','moment'],function(c,a,g,d){var e=this,f=e.erp,b={};return _.extend(b,{$init:function(e,g,i){function h(){a.c2s({url:f.BASE_PATH+'train/student/getAllCoursewares.do',data:{isOldStaff:1},success:function(c){var a;c.flag&&(a=c.data,b.studyList=_.map(a.learningCoursewareList,function(a,b){return a.indexNum=_.str.lpad(b+1,2,'0'),a.coursewareEndTimeText=d(a.coursewareEndTime).format('YYYY.MM.DD HH:mm'),a;}),b.historyList=_.map(a.historyCoursewareList,function(a,b){return a.indexNum=_.str.lpad(b+1,2,'0'),a.coursewareEndTimeText=d(a.coursewareEndTime).format('YYYY.MM.DD HH:mm'),a;}));}});}var b=c.define(g,function(b){b.studyList=[],b.historyList=[],b.clickStartStudy=function(){var b=this.$vmodel.$model.el,c=b.id,d=b.learningProgressId;a.jumpPage('#/study/coursestudy/process/'+d+'/0/'+c);},b.clickStartExam=function(){var b=this.$vmodel.$model.el;b.paperType=='0'?a.jumpPage('#/study/coursestudy/plainexam/'+b.learningProgressId+'/0/'+b.id):a.jumpPage('#/study/coursestudy/recordexam/'+b.learningProgressId+'/0/'+b.id);};});c.scan(e[0]),h();},$remove:function(a,b){}}),b;});

//From origin\page\study\coursestudy\plainexam\plainexam.js
define('originpagestudycoursestudyplainexamplainexamjs',['avalon','util','json','originwidgetformformjs'],function(a,b,f){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(h,j,d){function m(b){var a='';switch(b){case'0':a='\u5355\u9009\u9898';break;case'1':a='\u591A\u9009\u9898';break;case'2':a='\u5224\u65AD\u9898';break;}return a;}function n(c){var a=0,b=0,d=0;return a=Math.floor(c/3600),b=Math.floor((c-a*3600)/60),d=c-b*60-a*3600,{hour:a,minute:b,second:d};}function o(e){var b,a=[],c={0:'single',1:'multi',2:'bool'},d={0:'\u5355\u9009\u9898',1:'\u591A\u9009\u9898',2:'\u5224\u65AD\u9898'};return b=_.groupBy(e,function(a){return a.questionType;}),_.each(b,function(f,b){var e=_.map(f,function(a){return{questionTitle:a.content,id:a.id,isAnswered:!1,optionList:_.map(a.examOptionVOs,function(a){return{optionContent:a.optionContent,id:a.id};})};});a.push({questionTypeTitle:d[b],questionType:c[b],questionList:e});}),a;}function l(){b.c2s({url:e.isFinalExam?c.BASE_PATH+'train/exam/finalExamine.do':c.BASE_PATH+'train/exam/examine.do',data:{courseId:d.params.courseId,coursewareId:d.params.id,learningProgressId:d.params.learningProgressId},success:function(b){var a;b.flag&&(a=b.data,e.isFinalExam?e.navCrumbs.removeAt(1):e.navCrumbs.set(1,{text:a.paperName,href:'#/study/coursestudy/process/'+d.params.learningProgressId+'/'+d.params.courseId+'/'+a.coursewareId}),e.originData=a.traExamDtlVOs,e.questionTypeList=o(a.traExamDtlVOs),e.duration=parseFloat(a.timeLimit,10));}});}var i=j+'-form',g=j+'-exam-complete',k=c.getAppData('user'),e=a.define(j,function(c){c.$skipArray=['tId','originData'],c.navCrumbs=[{text:'\u8BFE\u7A0B\u5B66\u4E60',href:'#/study/coursestudy'},{text:'',href:'#'},{text:'\u8BFE\u540E\u4E60\u9898'}],c.isFinalExam=d.params.id=='0'?!0:!1,c.isOldStaff=k.isFormal=='1',c.duration=0,c.leftHour=0,c.leftMinute=0,c.leftSecond=0,c.tId=0,c.originData=[],c.questionTypeList=[],c.$formOpts={formId:i,field:[{selector:'.question-item',name:'answers',getValue:function(){var a=[],b=$('.question-option',h);return b.each(function(){var c=$(this),e=c.data('questionId'),g=c.val(),f=!1,b=_.find(a,function(a){return a.id==e;}),d;b?d=b.examOptionVOs||[]:(b={},d=[],f=!0),d.push({id:g/1,isSelected:c.prop('checked')?'1':'0'}),b.id=e/1,b.examOptionVOs=d,f&&a.push(b);}),a;},rule:function(){var d=$('.progress-panel',h),e=$('.timer-panel',d),f=$('.question-state-panel',d),a=!0,c=!0;return $('.num',e).each(function(){return $(this).text()/1?(a=!1,!1):void 0;}),$('.question-item',f).each(function(){return $(this).hasClass('is-answered')?void 0:(c=!1,!1);}),{handler:function(){a||c||b.alert({iconType:'error',content:'\u8BF7\u68C0\u67E5\u7B54\u9898\u677F\uFF0C\u5B8C\u6210\u672A\u7B54\u7684\u9898'});},isPassed:a||c};}}],action:[{selector:'.f-submit',handler:function(){var e=a.getVm(i),d=a.getVm(g),h;if(e.validate()){if(h=e.getFormData(),_.isEmpty(h)){b.alert({iconType:'error',content:'\u6CA1\u6709\u4EFB\u4F55\u8BD5\u9898\u4F5C\u7B54'});return;}b.c2s({url:c.isFinalExam?'train/exam/saveFinalExam.do':'train/exam/saveExam.do',type:'post',data:f.stringify(h.answers),contentType:'application/json',success:function(h){var a,f,b,c,e,i,g,j;h.flag&&(a=h.data,f=a.examResult,b=f.judgement,c=f.multiple,e=f.single,i=a.nextCourse,g=a.isFinalExamAvailable,j=a.courseId,d.detailList.clear(),e&&d.detailList.push({questionTypeName:'\u5355\u9009\u9898',rightList:e.correct,wrongList:e.wrong,leftList:e.unanswered,score:e.score}),c&&d.detailList.push({questionTypeName:'\u591A\u9009\u9898',rightList:c.correct,wrongList:c.wrong,leftList:c.unanswered,score:c.score}),b&&d.detailList.push({questionTypeName:'\u5224\u65AD\u9898',rightList:b.correct,wrongList:b.wrong,leftList:b.unanswered,score:b.score}),d.isPassed=a.passed,a.passed?d.tipContent='\u606D\u559C\u60A8\uFF0C\u4EB2~\u60A8\u53D6\u5F97\u4E86'+a.score+'\u5206\u7684\u597D\u6210\u7EE9\uFF0C\u8981\u7EE7\u7EED\u4FDD\u6301\u54E6~':d.tipContent='\u5F88\u62B1\u6B49\uFF0C\u60A8\u7684\u6210\u7EE9\u53EA\u6709'+a.score+'\u5206\uFF0C\u65E0\u6CD5\u901A\u8FC7\u8003\u8BD5\u3002<br/>\u5C0F\u4F19\u4F34\uFF0C\u7EE7\u7EED\u52A0\u6CB9\u5427\uFF01',d.nextCourse=i,d.isFinalExamAvailable=g,d.enterNextStudyText=g?'\u8FDB\u5165\u671F\u672B\u8003\u8BD5':'\u5B66\u4E60\u4E0B\u4E00\u8282\u8BFE\u7A0B',d.courseId=j,d.open());}});}}}]},c.$examCompleteTip={dialogId:g,title:'',showClose:!1,width:580,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="ui-dialog-btn" ms-if="!isFinalExam && !!nextCourse && !isOldStaff" ms-class-1="submit-btn: isPassed" ms-class-2="cancel-btn: !isPassed" ms-click="enterNextStudy">{{enterNextStudyText}}</button><span class="separation"></span><button type="button" class="submit-btn ui-dialog-btn" ms-click="returnCourseList">\u8FD4\u56DE\u8BFE\u7A0B\u5217\u8868</button><span class="separation"></span><button type="button" class="submit-btn ui-dialog-btn" ms-click="reExam" ms-if="!(isFinalExam && isPassed)">\u91CD\u65B0\u8003\u8BD5</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},tipContent:'',detailList:[],isPassed:!1,questionList:[],nextCourse:null,isFinalExamAvailable:!1,enterNextStudyText:'\u5B66\u4E60\u4E0B\u4E00\u8282\u8BFE\u7A0B',courseId:0,clickNumField:function(){var i=a.getVm(g),e=$(this),d=$('.question-list-wrapper',e),f,h=this.$vmodel.$model;e.hasClass('right-num')?f=h.el.rightList:e.hasClass('wrong-num')?f=h.el.wrongList:e.hasClass('left-num')&&(f=h.el.leftList),i.questionList=_.map(f,function(b){var a=_.find(c.originData,function(a){return a.id==b;});return{questionContent:a.content,questionTypeName:m(a.questionType)};}),d.length?d.show():(d=$('<div class="question-list-wrapper"></div>'),d.html('<ul class="question-list"><li class="question-item" ms-repeat="questionList">{{$index + 1}}\u3001{{el.questionContent}}({{el.questionTypeName}})</li></ul>'),d.appendTo(e),a.scan(d[0],[i]),b.regGlobalMdExcept({element:d,handler:function(){d.hide();}}));},enterNextStudy:function(){var c=a.getVm(g);c.isPassed&&(c.isFinalExamAvailable?b.jumpPage('#/study/coursestudy/plainexam/'+d.params.learningProgressId+'/'+c.courseId+'/0'):c.nextCourse&&b.jumpPage('#/study/coursestudy/process/'+d.params.learningProgressId+'/'+c.nextCourse.courseId+'/'+c.nextCourse.coursewareId),c.close());},returnCourseList:function(){var c=a.getVm(g);b.jumpPage('#/study/coursestudy'),c.close();},reExam:function(){var e=a.getVm(i),b=a.getVm(g);b.close();var c=d.params.id;a.router.navigate('/study/coursestudy/plainexam/'+d.params.learningProgressId+'/'+d.params.courseId+'/'+c);},onClose:function(){var b=a.getVm(g);b.tipContent='',b.detailList.clear(),b.isPassed=!1,b.questionList.clear();}},c.$watch('duration',function(b){var a=Math.floor(b*60*60);clearInterval(c.tId),c.tId=setInterval(function(){var b;b=n(a),c.leftHour=b.hour,c.leftMinute=b.minute,c.leftSecond=b.second,a<=0?(clearInterval(c.tId),$('.f-submit',h).click()):a--;},1000);});});a.scan(h[0]),l(),h.on('change','.option-item input',function(){var b=$(this),f=b.closest('.option-list'),g=b.data('questionId'),c=!1,d=-1,a=-1;$('input',f).each(function(){return $(this).prop('checked')?(c=!0,!1):void 0;}),_.some(e.questionTypeList.$model,function(b,c){return _.some(b.questionList,function(b,c){return b.id==g?(a=c,!0):void 0;})?(d=c,!0):void 0;}),a>-1&&e.questionTypeList[d].questionList.set(a,{isAnswered:c});});},$remove:function(e,b){var c=b+'-form',d=b+'-exam-complete';$(a.getVm(d).widgetElement).remove(),$(a.getVm(c).widgetElement).remove();}}),d;});

//From origin\page\study\coursestudy\process\process.js
define('originpagestudycoursestudyprocessprocessjs',['avalon','util','json','moment','originwidgetmediaplayerjs','dialog'],function(b,a,g,e){var f=this,c=f.erp,d={};return _.extend(d,{$init:function(n,m,d){function o(){a.c2s({url:c.BASE_PATH+'train/student/study.do',data:{isOldStaff:i.isFormal,courseId:d.params.courseId,coursewareId:d.params.id,learningProgressId:d.params.learningProgressId==0?'':d.params.learningProgressId},success:function(b){var a,c,d,h,j,k;b.flag&&(a=b.data,c=a.attachmentVO,d=a.studyStudentRecords,h=a.examStudentRecords,j=c.smvpAttachData,k=j.entries[0].renditions,f.examEnable=!(i.isFormal=='1'&&a.isTest=='0'),f.navCrumbs.set(1,{text:a.coursewareName}),f.coursewareName=a.coursewareName,f.coursewareSummary='\u4E3B\u8BB2\u4EBA\uFF1A'+a.speaker+'&nbsp;&nbsp;&nbsp;&nbsp;\u65F6\u957F\uFF1A'+a.courseHours,g.load([{file:k[0].urls.smf.url.slice(0,-20)+'.mp4'}]),f.studyHistoryList=_.map(d,function(a){return{historyTime:e(a.beginTime).format('MM\u6708DD\u65E5 HH:mm')};}),f.examHistoryList=_.map(h,function(a){return{historyTime:e(a.beginTime).format('MM\u6708DD\u65E5 HH:mm'),examScore:a.score,isPassed:!0};}),f.isExist=!0,f.studied=a.studied,f.paperType=a.paperType);}});}var l=m+'-player',h=m+'-dialog',i=c.getAppData('user'),f=b.define(m,function(e){e.navCrumbs=[{text:'\u8BFE\u7A0B\u5B66\u4E60',href:'#/study/coursestudy'},{text:''}],e.examEnable=!0,e.isExist=!0,e.paperType='0',e.coursewareName='',e.coursewareSummary='',e.studyHistoryList=[],e.examHistoryList=[],e.studied=!1,e.$coursewareOpts={playerId:l,jwplayerOptions:{width:798,height:558,image:c.ASSET_PATH+'image/media-bg.png'}},e.$completedOpts={dialogId:h,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-if="examEnable" ms-click="enterExam">\u5F00\u59CB\u8003\u8BD5</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="replay">\u91CD\u65B0\u64AD\u653E</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},enterExam:function(c){e.paperType=='0'?a.jumpPage('#/study/coursestudy/plainexam/'+d.params.learningProgressId+'/'+d.params.courseId+'/'+d.params.id):a.jumpPage('#/study/coursestudy/recordexam/'+d.params.learningProgressId+'/'+d.params.courseId+'/'+d.params.id),b.getVm(h).close();},replay:function(a){g.play(!0),b.getVm(h).close();}},e.enterExam=function(){e.paperType=='0'?a.jumpPage('#/study/coursestudy/plainexam/'+d.params.learningProgressId+'/'+d.params.courseId+'/'+d.params.id):a.jumpPage('#/study/coursestudy/recordexam/'+d.params.learningProgressId+'/'+d.params.courseId+'/'+d.params.id);},e.enterStudyPage=function(){a.jumpPage('#/study/coursestudy');},e.enterHistoryPage=function(){a.jumpPage('#/study/history');};});b.scan(n[0]);var g=b.getVm(l).playerCore,k=!1,j=!0;g.onSeek(function(b){var a=b.position,c=b.offset;k||f.studied?k=!1:setTimeout(function(){c>a&&(k=!0,g.seek(a));},10);}),g.onPlay(function(b){b.oldstate=='BUFFERING'&&j&&(a.c2s({url:c.BASE_PATH+'train/student/startStudy.do',data:{isOldStaff:i.isFormal,courseId:d.params.courseId,coursewareId:d.params.id,learningProgressId:d.params.learningProgressId==0?'':d.params.learningProgressId},success:function(a){a.flag;}}),j=!1);}),g.onComplete(function(){a.c2s({url:c.BASE_PATH+'train/student/completeStudy.do',data:{isOldStaff:i.isFormal,courseId:d.params.courseId,coursewareId:d.params.id,learningProgressId:d.params.learningProgressId==0?'':d.params.learningProgressId},success:function(c){if(c.flag){var a=b.getVm(h);f.studied=!0,a.open();}}}),j=!0;}),o();},$remove:function(f,c){var d=c+'-player',e=c+'-dialog',a=b.getVm(d);$(b.getVm(e).widgetElement).remove(),a&&$(a.widgetElement).remove();}}),d;});

//From origin\page\study\coursestudy\recordexam\recordexam.js
define('originpagestudycoursestudyrecordexamrecordexamjs',['avalon','util','json','originmodulepptplayerpptplayerjs','originwidgetformformjs'],function(a,e,f){var d=this,b=d.erp,c={};return _.extend(c,{$init:function(j,g,c){function k(){e.c2s({url:b.BASE_PATH+'train/exam/pptExam.do',data:{courseId:c.params.courseId,coursewareId:c.params.id,learningProgressId:c.params.learningProgressId},success:function(m){var k,j,g,l,n,e=[];m.flag&&(j=a.getVm(f),k=m.data,g=k.ppt,n=g.pptDtlVOs,l=k.exampaper,i.navCrumbs.set(1,{text:g.pptName,href:'#/study/coursestudy/process/'+c.params.learningProgressId+'/'+c.params.courseId+'/'+g.coursewareId}),j.pptList=_.map(n,function(a){return{imagePath:b.BASE_PATH+a.uri};}),j.currentPath=j.pptList[0].imagePath,d&&d.RecordOpen&&(e[0]=l.id,e[1]=g.id,e[2]=l.timeLimit/1,e[3]=h.sessionId,d.RecordOpen(e.join(','))));}});}var f=g+'-ppt',d=document.getElementById('softPos'),h=b.getAppData('user'),i=a.define(g,function(a){a.navCrumbs=[{text:'\u8BFE\u7A0B\u5B66\u4E60',href:'#/study/coursestudy'},{text:'',href:'#'},{text:'\u8BFE\u540E\u4E60\u9898'}],a.$pptplayerOpts={pptplayerId:f};});a.scan(j[0]),k();},$remove:function(e,d){var c=d+'-ppt',b=document.getElementById('softPos');$(a.getVm(c).widgetElement).remove(),b&&b.RecordClose&&b.RecordClose();}}),c;});

//From origin\page\study\coursewaremanage\courseware-add-edit.js
define('originpagestudycoursewaremanagecoursewareaddeditjs',['avalon','util','json','originwidgetformformjs','dialog','originwidgetuploaderuploaderjs'],function(a,b,d){var f=this,c=f.erp,e={};return _.extend(e,{$init:function(l,g,j){function m(){b.c2s({url:c.BASE_PATH+'courseware/getCoursewareInfoByCoursewareId.do',type:'post',contentType:'application/json',data:d.stringify({coursewareId:j.params.id/1}),success:function(d){var c,g=a.getVm(e);d.flag&&(c=d.data,f.coursewareName=c.courseware_name,f.speaker=c.speaker,f.attachName=c.remark,f.timeLimit=c.time_limit,f.hours=c.hours,f.belongToCourseList=_.map(c.courseInfo,function(a){return{courseName:a.course_name};}),g.uploadList.push({id:b.generateID(),name:c.attachment_name}));}});}var h=g+'-form',e=g+'-uploader',k=c.getAppData('user'),i=k.smvp,f=a.define(g,function(f){f.state=g.split('-').pop(),f.navCrumbs=[{text:'\u8BFE\u4EF6\u7BA1\u7406',href:'#/study/coursewaremanage'},{text:f.state==='add'?'\u6DFB\u52A0\u8BFE\u4EF6':'\u4FEE\u6539\u8BFE\u4EF6'}],f.belongToCourseList=[],f.coursewareName='',f.speaker='',f.timeLimit='',f.attachName='',f.videoId='',f.hours='',f.$uploaderOpts={uploaderId:e,clickRemoveBtn:function(d){var b=a.getVm(e),c=this.$vmodel.$model;b.removeFile(c.el.id);},defaultExtKeyData:{},uploadifyOpts:{swf:'http://static.smvp.cn/flash/uploadify.swf',uploader:'http://api.alpha.smvp.cn/entries/upload',formData:{token:i.token,entry:d.stringify({category:_.find(i.category,function(a){return a.name==='\u8BFE\u4EF6';}).id,activated:!0})},fileObjName:'myfiles',multi:!1,fileTypeDesc:'\u89C6\u9891\u6587\u4EF6(*.mp4)',fileTypeExts:'*.mp4',fileSizeLimit:'1024MB',width:116,height:30,onSelect:function(c){var b=a.getVm(e);b.uploadList.size()>1&&b.removeFile(b.uploadList[0].id);}},onSuccessResponseData:function(b,c){var a=d.parse(b);f.videoId=a.id,f.attachName=a.title;}},f.$formOpts={formId:h,field:[{selector:'.courseware-name',name:'coursewareName',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BFE\u4EF6\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.speaker',name:'speaker',rule:['noempty',function(b,a){return a[0]!==!0?'\u4E3B\u8BB2\u4EBA\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.video-uploader',name:'videoId',getValue:function(){return f.videoId;},reset:function(){var b=a.getVm(e);f.state=='add'&&b.removeAllFile();},rule:function(){var b=a.getVm(e),c=b.uploadList;return c.size()?!0:'\u4E0A\u4F20\u89C6\u9891\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.time-limit',name:'timeLimit',rule:['noempty',function(a,b){return b[0]!==!0?'\u5B66\u4E60\u65F6\u9650\u4E0D\u80FD\u4E3A\u7A7A':/^-?\d+(\.\d{1,1})?$/.test(a)?parseFloat(a,10)<=0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u5730\u65F6\u95F4\u503C':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u5B66\u4E60\u65F6\u9650';}]},{selector:'.hours',name:'hours',rule:['noempty',function(a,b){return b[0]!==!0?'\u89C4\u5B9A\u65F6\u957F\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u89C4\u5B9A\u65F6\u957F':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u89C4\u5B9A\u65F6\u957F';}]}],action:[{selector:'.f-submit',handler:function(n){var k=a.getVm(h),g=a.getVm(e),i,l,m;k.validate()&&(l=function(){i=k.getFormData(),f.state=='edit'?(_.extend(i,{coursewareId:j.params.id/1}),m=c.BASE_PATH+'courseware/updateCourseware.do'):m=c.BASE_PATH+'courseware/saveCourseware.do',i.originalFileName=f.attachName,b.c2s({url:m,type:'post',contentType:'application/json',data:d.stringify(i),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){window.location.href=c.BASE_PATH+'#!/study/coursewaremanage';}});}});},g.uploading?(b.showGlobalMask(),g.$unwatch('uploading'),g.$watch('uploading',function(a){a||(b.hideGlobalMask(),l(),g.$unwatch('uploading'));})):l());}}]};});a.scan(l[0]),f.state=='edit'&&m();},$remove:function(e,b){var c=b+'-form',d=b+'-uploader';$(a.getVm(d).widgetElement).remove(),$(a.getVm(c).widgetElement).remove();}}),e;});

//From origin\page\study\coursewaremanage\coursewaremanage.js
define('originpagestudycoursewaremanagecoursewaremanagejs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetformselectjs'],function(b,a){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(i,g){function e(g){var e=b.getVm(h),f={courseName:d.courseName,coursewareName:d.coursewareName};g?(f.pageSize=e.perPages,f.pageNumber=1):(f.pageSize=e.perPages,f.pageNumber=e.currentPage),a.c2s({url:c.BASE_PATH+'courseware/getCoursewareInfo.do',data:f,success:function(b){var a;b.flag&&(a=b.data,e.total=a.totalSize,g&&(e.currentPage=1),d.gridData=a.rows,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear());}});}var h=g+'-pagination',f=g+'-course-list-tip',d=b.define(g,function(b){b.permission={magCourseware:a.hasPermission('mag_course_ware'),paperRule:a.hasPermission('paper_rule'),magQuestion:a.hasPermission('mag_question')},b.courseName='',b.coursewareName='',b.gridTotalSize=0,b.gridData=[],b.gridAllChecked=!1,b.gridSelected=[],b.gridCheckAll=function(){this.checked?b.gridSelected=_.map(b.gridData.$model,function(a){return a.id;}):b.gridSelected.clear();},b.scCheckAll=function(){b.gridSelected=_.map(b.gridData.$model,function(a){return a.id;});},b.$paginationOpts={paginationId:h,total:0,onJump:function(a,b){e();}},b.search=function(){e(!0);},b.jumpAddQuestionPage=function(){var a=$('<a href="#/study/questionmanage/add"></a>');a.appendTo('body'),a[0].click(),a.remove();},b.jumpQueryQuestionPage=function(){var a=$('<a href="#/study/questionmanage"></a>');a.appendTo('body'),a[0].click(),a.remove();},b.jumpAddPage=function(){var a=$('<a href="#/study/coursewaremanage/add"></a>');a.appendTo('body'),a[0].click(),a.remove();},b.removeGridItem=function(){var a=$(this),c=a.data('id')+'';b.gridSelected=[c],b._removeCourseware();},b.batchRemoveGridItem=function(){b._removeCourseware();},b._removeCourseware=function(){var d,f,g;b.gridSelected.size()===0?a.alert({content:'\u8BF7\u5148\u9009\u4E2D\u8BFE\u4EF6'}):(d=b.gridSelected.$model,g=c.BASE_PATH+'courseware/deleteCourseware.do',f={idString:d},a.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u8BFE\u4EF6\u5417\uFF1F',onSubmit:function(){a.c2s({url:g,type:'post',data:JSON.stringify(f),contentType:'application/json',success:function(a){a.flag==1&&e(!0);}});}}));};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),b.scan(i[0],[d]),e(),i.on('mouseenter','.course-count',function(){var e=$(this),l=b(this).data('index'),g=$('#'+f),h=e.offset(),i=d.gridData[l],m=i.coursecount,j=e.data('courseList'),k=function(b){var a='';_.each(b,function(b){a+='<li class="course-item">'+b+'</li>';}),g.html(a).css({top:h.top,left:h.left+e.width()}).show();};g.length||(g=$('<ul id="'+f+'"></ul>'),g.appendTo('body')),m>0&&(j?k(j):a.c2s({url:c.BASE_PATH+'courseware/getCourseByCoursewareId.do',type:'post',data:{coursewareId:i.id},success:function(b){var c,a;b.flag==1&&(c=b.data,a=_.map(c,function(a){return a.course_name;}),k(a),e.data('courseList',a));}},{mask:!1,withData:!1,ajaxType:'abort'}));}).on('mouseleave','.course-count',function(){$('#'+f).hide();});},$remove:function(e,a){var c=a+'-pagination',d=a+'-course-list-tip';$(b.getVm(c).widgetElement).remove(),$('#'+d).remove();}}),d;});

//From origin\page\study\coursewaremanage\examrule\examrule.js
define('originpagestudycoursewaremanageexamruleexamrulejs',['avalon','util','json','originwidgetformformjs','dialog','originwidgetuploaderuploaderjs','originwidgetformselectjs','originmoduleqselectorqselectorjs','originmodulepptselectorpptselectorjs'],function(a,b,e){var f=this,c=f.erp,d={};return _.extend(d,{$init:function(o,f,m){function p(){b.c2s({url:c.BASE_PATH+'rule/getRuleByCoursewareId.do',data:e.stringify({coursewareId:g}),contentType:'application/json',success:function(c){var b;c.flag&&(b=c.data,d.paperType=b.paper_type=='1'?'ppt':'write',d.isTest=b.is_test,d.passingScore=b.passing_score||'',d.timeLimit=b.time_limit||'',d.ruleId=b.id||0,d.total=b.total||'',b.paper_type=='1'?(b.rule_type=='1'&&b.requiredQuestions.length&&(d.selectedPptId=b.requiredQuestions[0].question_id,d.selectedPptName=b.requiredQuestions[0].question+'&nbsp;'),a.getVm(i).select(b.rule_type/1)):(d.selectedWriteList=_.map(b.requiredQuestions,function(a){return{id:a.question_id,question:a.question,questionType:a.question_type,pptName:a.ppt_name};}),a.getVm(h).select((b.rule_type||0)/1)));}});}var j=f+'-form',k=f+'-qselector',l=f+'-pptselector',i=f+'-ppt-range',h=f+'-write-range',g=m.params.id/1,n=decodeURIComponent(m.params.coursewareName),d=a.define(f,function(m){m.state=f.split('-').pop(),m.navCrumbs=[{text:'\u8BFE\u4EF6\u7BA1\u7406',href:'#/study/coursewaremanage'},{text:n,href:'#/study/coursewaremanage'},{text:'\u8003\u5377\u89C4\u5219'}],m.paperType='write',m.isTest='0',m.total='',m.timeLimit='',m.pptTimeLimit='',m.passingScore='',m.ruleId=0,m.selectedWriteList=[],m.examRange='all',m.selectedPptName='',m.selectedPptId=0,m.$writeRangeOpts={selectId:h,options:[{text:'\u5168\u90E8\u968F\u673A',value:'0'},{text:'\u90E8\u5206\u968F\u673A',value:'1'}],onSelect:function(a,b,c){a=='0'?m.examRange='all':m.examRange='part';}},m.$pptRangeOpts={selectId:i,options:[{text:'\u968F\u673APPT',value:'0'},{text:'\u6307\u5B9APPT',value:'1'}],onSelect:function(a,b,c){a=='0'?m.examRange='all':m.examRange='part';}},m.$qselectorOpts={qselectorId:k,multi:!0,onListRequestData:function(a){return a.coursewareId=g,a;},onListReady:function(a){_.each(m.selectedWriteList.$model,function(c){var b=-1;_.some(a.$model,function(a,d){return a.id==c.id?(b=d,!0):void 0;})&&a.set(b,{isSelected:!0});});},onSubmit:function(a){a.length?m.selectedWriteList=_.map(a,function(a){return{id:a.id,question:a.question,questionType:a.questionType};}):b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u81F3\u5C11\u4E00\u4E2A\u8BD5\u9898'});}},m.$pptselectorOpts={pptselectorId:l,onListRequestData:function(a){return a.coursewareId=g,a;},onListReady:function(b){var a=-1;_.some(b.$model,function(b,c){return b.id==m.selectedPptId?(a=c,!0):void 0;})&&b.set(a,{isSelected:!0});},onSubmit:function(a){a.length?(m.selectedPptName=a[0].pptName+'&nbsp;',m.selectedPptId=a[0].id):b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u4E00\u4E2APPT'});}},m.openQuestionSelector=function(){var b=a.getVm(k);b.title='\u9009\u62E9\u5FC5\u8003\u9898',b.open();},m.openPptSelector=function(){var b=a.getVm(l);b.title='\u9009\u62E9PPT',b.open();},m.switchPaperType=function(f){var d=a(this),e=d.data('name'),b=a.getVm(h),c=a.getVm(i);m.paperType=e,m.selectedWriteList.clear(),m.selectedPptId=0,m.selectedPptName='',m.examRange='all',b&&b.select(0),c&&c.select(0);},m.removeWriteItem=function(){var a=this.$vmodel.$model;m.selectedWriteList.removeAt(a.$index);},m.$formOpts={formId:j,field:[{selector:'.paper-type',name:'paperType',getValue:function(){return $(this).filter('.mn-radio-state-selected').data('name');}},{selector:'.for-old-staff',name:'isTest'},{selector:'.time-limit',name:'timeLimit',rule:['noempty',function(a,b){return b[0]!==!0?'\u8003\u8BD5\u65F6\u9650\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u8BD5\u65F6\u9650':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u8BD5\u65F6\u9650';}]},{selector:'.total',name:'total',rule:['noempty',function(a,b){return b[0]!==!0?'\u8003\u9898\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u9898\u6570\u91CF':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u8003\u9898\u6570\u91CF';}]},{selector:'.passing-score',name:'passingScore',rule:['noempty',function(a,b){return b[0]!==!0?'\u53CA\u683C\u5206\u6570\u7EBF\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?parseFloat(a,10)===0||a.slice(0,2)==='00'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u53CA\u683C\u5206\u6570':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u53CA\u683C\u5206\u6570';}]}],action:[{selector:'.f-submit',handler:function(n){var l=a.getVm(j),m=d.paperType=='write'?a.getVm(h):a.getVm(i),k,f=[];if(l.validate()){if(k=l.getFormData(),_.extend(k,{id:d.ruleId,coursewareId:g,ruleType:m.selectedValue}),d.examRange=='part')if(d.paperType=='write'){if(f=_.map(d.selectedWriteList.$model,function(a){return a.id;}),!f.length){b.alert({iconType:'error',content:'\u8BF7\u6307\u5B9A\u6709\u6548\u7684\u8003\u9898\u8303\u56F4'});return;}if(f.length>k.total/1){b.alert({iconType:'error',content:'\u5FC5\u8003\u9898\u6570\u91CF\u4E0D\u80FD\u5927\u4E8E\u589E\u52A0\u8003\u9898\u6570\u91CF'});return;}}else if(f.push(d.selectedPptId),!d.selectedPptId){b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u4E00\u4E2Appt\u8003\u9898'});return;}k.questionIdList=f,b.c2s({url:c.BASE_PATH+'rule/addRule.do',type:'post',contentType:'application/json',data:e.stringify(k),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){b.jumpPage('#/study/coursewaremanage');}});}});}}}]};});p(),a.scan(o[0],[d]);},$remove:function(l,b){var j=b+'-form',k=b+'-qselector',g=b+'-pptselector',h=b+'-ppt-range',i=b+'-write-range',e=a.getVm(h),f=a.getVm(g),d=a.getVm(k),c=a.getVm(i);c&&$(c.widgetElement).remove(),e&&$(e.widgetElement).remove(),f&&$(f.widgetElement).remove(),d&&$(d.widgetElement).remove(),$(a.getVm(j).widgetElement).remove();}}),d;});

//From origin\page\study\history\audition\audition.js
define('originpagestudyhistoryauditionauditionjs',['avalon','util','json','originmodulepptplayerpptplayerjs','originwidgetmediaplayerjs','originwidgetformformjs'],function(a,e,f){var c=this,b=c.erp,d={};return _.extend(d,{$init:function(o,d,l){function q(){e.c2s({url:b.BASE_PATH+'studentManagement/queryPptExamInfo.do',data:f.stringify({paperId:l.params.id/1}),contentType:'application/json',success:function(n){var d,f,j,m,e,h;n.flag&&(f=a.getVm(k),d=n.data,j=d.audioInfo,m=d.studentInfo,e=d.ppt,h=d.traExamPaper,g.navCrumbs.set(1,{text:e.ppt_name}),f.pptList=_.map(d.pptDtlList,function(a){return{imagePath:b.BASE_PATH+d.pptPhotoPath+'/'+e.ppt_path+'/'+a.ppt_dtl_name};}),f.currentPath=f.pptList[0].imagePath,i.load([{file:b.BASE_PATH+d.audioPath+'/'+j.attachment_path+'/'+j.attachment_name}]),g.studentName=m.userName,g.studentId=m.id,g.pptName=e.ppt_name,g.auditionSummary=e.ppt_name,h.examPaperType=='1'&&h.comment&&(g.teacherComment=h.comment),l.params.action&&l.params.action=='comment'&&$(c).scrollTop(10000));}});}var k=d+'-ppt',j=d+'-audio',n=d+'-do-score-dialog',h=d+'-play-over-dialog',p=d+'do-score-form',m=d+'do-score-form_',g=a.define(d,function(b){b.navCrumbs=[{text:'\u5386\u53F2\u56DE\u987E',href:'#/study/history'},{text:''}],b.studentName='',b.studentId=0,b.pptName='',b.auditionSummary='',b.teacherComment='',b.$pptOpts={pptplayerId:k},b.$audioOpts={playerId:j,jwplayerOptions:{width:800,height:30}},b.$playOverDialogOpts={dialogId:h,title:'\u63D0\u793A',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u8FD4\u56DE\u5386\u53F2\u56DE\u987E</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="replay">\u91CD\u65B0\u64AD\u653E</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){var b=a.getVm(m);b&&b.reset();},submit:function(c){var b=a.getVm(h);b.close(),e.jumpPage('#/study/history');},replay:function(){var b=a.getVm(h);b.close(),i.play(!0);}};});a.scan(o[0]),q();var i=a.getVm(j).playerCore;i.onComplete(function(){var b=a.getVm(h);b.open();});},$remove:function(m,b){var k=b+'-ppt',l=b+'-audio',g=b+'-do-score-dialog',h=b+'-play-over-dialog',i=b+'do-score-form',j=b+'do-score-form_',e=a.getVm(i),f=a.getVm(j),d=a.getVm(g),c=a.getVm(h);$(a.getVm(k).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),e&&$(e.widgetElement).remove(),f&&$(f.widgetElement).remove(),d&&$(d.widgetElement).remove(),c&&$(c.widgetElement).remove();}}),d;});

//From origin\page\study\history\history.js
define('originpagestudyhistoryhistoryjs',['avalon','util','json','moment'],function(f,g,i,c){var a=this,d=a.erp,e={},b,h=d.getAppData('user');return _.extend(e,{$init:function(l,m,j){function k(){g.c2s({url:d.BASE_PATH+'studentManagement/queryTraStudentRecordByStudentId.do',contentType:'application/json',data:i.stringify({studentId:j.params.id?j.params.id/1:h.id,pageSize:e.pageSize,pageNumber:e.pageNumber}),success:function(a){a.flag&&(e.originData=e.originData.concat(a.data.rows),e.lineList=n(e.originData),e.totalSize=a.data.totalSize,e.pageNumber=e.pageNumber+1,e.totalSize<=e.pageSize&&(e.isComplete=!0),a.data.totalSize===0&&g.alert({iconType:'info',content:'\u60A8\u8FD8\u672A\u4EA7\u751F\u5386\u53F2\u56DE\u987E'}));}});}function n(d){var a=[],b;return b=_.groupBy(d,function(a){return c(a.begin_time).format('YYYY-MM-DD');}),_.each(b,function(i,d){var g=c().format('YYYY-MM-DD'),h=c().subtract('days',1).format('YYYY-MM-DD'),e=!1,f=!1,b=d.split('-').slice(1).join('.');d==g&&(b='\u4ECA\u5929',e=!0),d==h&&(b='\u6628\u5929',f=!0),a.push({dateIndex:b,isToday:e,isYestoday:f,detailList:_.map(i,function(a){var b='',d='';return a.operating_type=='0'?b='<a href="#/study/coursestudy/process/'+a.learning_progress_id+'/'+a.course_id+'/'+a.courseware_id+'">\u590D\u4E60\u8BFE\u7A0B</a>':a.operating_type=='1'&&(a.exam_paper_type=='1'?(b='<a href="#/study/history/audition/'+a.paper_id+'">\u8BD5\u542C\u5F55\u97F3</a>',d='#/study/coursestudy/recordexam/'+a.learning_progress_id+'/'+a.course_id+'/'+a.courseware_id):a.exam_paper_type=='0'?d='#/study/coursestudy/plainexam/'+a.learning_progress_id+'/'+a.course_id+'/'+a.courseware_id:a.exam_paper_type=='5'&&(d='#/study/coursestudy/plainexam/'+a.learning_progress_id+'/'+a.course_id+'/0'),a.exam_paper_type=='1'&&a.paper_status=='3'&&a.paper_comment&&(b+='&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/study/history/audition/'+a.paper_id+'/comment">\u67E5\u770B\u8BC4\u8BED</a>'),(a.paper_status=='4'&&a.exam_paper_type=='5'||a.exam_paper_type!='5')&&(b+='&nbsp;&nbsp;&nbsp;&nbsp;<a href="'+d+'">\u91CD\u65B0\u8003\u8BD5</a>')),a.learning_progress_id||(b=''),{timeIndex:c(a.begin_time).format('HH:mm'),content:a.description,action:b};})});}),a;}var e=f.define(m,function(a){a.$skipArray=['originData'],a.lineList=[],a.originData=[],a.totalSize=0,a.pageSize=13,a.pageNumber=1,a.isComplete=!1;});f.scan(l[0]),k(),b=function(){$('body').height()-$(a).scrollTop()-$(a).height()<=10&&((e.pageNumber-1)*e.pageSize<e.totalSize?k():(e.isComplete=!0,$(a).unbind('scroll',b)));},$(a).scroll(b);},$remove:function(c,d){$(a).unbind('scroll',b),b=null;}}),e;});

//From origin\page\study\membermanage\membermanage.js
define('originpagestudymembermanagemembermanagejs',['avalon','util','json','originwidgetgridgridjs'],function(a,e,f){var d=this,b=d.erp,c={};return _.extend(c,{$init:function(i,d){var c=d+'-grid',g=b.getAppData('user'),h=a.define(d,function(d){d.keyword='',d.$gridOpts={gridId:c,recordUnit:'\u4E2A\u4EBA',disableCheckAll:!0,disableCheckbox:!0,columns:[{dataIndex:'user_name',text:'\u59D3\u540D'},{dataIndex:'tel',text:'\u624B\u673A\u53F7'},{dataIndex:'group_name',text:'\u90E8\u95E8'},{dataIndex:'position_name',text:'\u804C\u4F4D'},{dataIndex:'coursewareCount',text:'\u6B63\u5728\u5B66\u4E60\u7684\u8BFE\u4EF6'},{dataIndex:'operation',text:'\u64CD\u4F5C',html:!0,renderer:function(b,a){return'<a ms-href="#/study/membermanage/viewstudy/{{$outer.el.id}}">\u67E5\u770B\u5B66\u4E60\u60C5\u51B5</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#/study/membermanage/history/'+a.id+'">\u67E5\u770B\u5386\u53F2</a></td>';}}],onLoad:function(a,c){_.extend(a,{subUserName:_.str.trim(d.keyword),baseUserId:+g.id}),e.c2s({type:'post',url:b.BASE_PATH+'teamMember/queryMemberList.do',data:f.stringify(a),contentType:'application/json',dataType:'json',success:function(a){var b;a.flag&&(b=a.data,c.call(this,b));}});}},d.query=function(){a.getVm(c).load();};});a.scan(i[0],[h]),a.getVm(c).load();},$remove:function(d,c){var b=c+'-grid';$(a.getVm(b).widgetElement).remove();}}),c;});

//From origin\page\study\membermanage\viewstudy\viewstudy.js
define('originpagestudymembermanageviewstudyviewstudyjs',['avalon','util','json','moment'],function(c,d,f,g){var a=this,e=a.erp,b={};return _.extend(b,{$init:function(k,l,m){function i(){d.c2s({type:'post',url:e.BASE_PATH+'teamMember/queryLearningProcessList.do',data:f.stringify({pageSize:b.pageSize,pageNumber:b.pageNumber,studentId:+j}),contentType:'application/json',dataType:'json',success:function(a){var c;a.flag&&(c=a.data.user,b.totalSize=a.data.totalSize,b.userName=c.user_name,b.tel=c.tel,b.group=c.group_name,b.position=c.position_name,b.pageNumber=b.pageNumber+1,b.rowsData=b.rowsData.concat(_.each(a.data.rows,function(a){a.begin_time=a.begin_time?g(a.begin_time).format('YYYY-MM-DD HH:mm')+' \u5F00\u59CB\u5B66\u4E60':'\u8FD8\u6CA1\u6709\u5F00\u59CB\u5B66\u4E60';})),b.totalSize<=b.pageSize&&(b.isComplete=!0),a.data.totalSize===0&&d.alert({iconType:'info',content:'\u60A8\u8FD8\u672A\u5B66\u4E60'}));}});}var j=m.params.id,h,b=c.define(l,function(a){a.userName='',a.tel='',a.group='',a.position='',a.rowsData=[],a.totalSize=0,a.pageSize=13,a.pageNumber=1,a.isComplete=!1;});c.scan(k[0],[b]),h=function(){$('body').height()-$(a).scrollTop()-$(a).height()<=10&&((b.pageNumber-1)*b.pageSize<b.totalSize?i():(b.isComplete=!0,$(a).unbind('scroll',h)));},$(a).scroll(h),i();},$remove:function(a,b){}}),b;});

//From origin\page\study\questionmanage\question-add-edit.js
define('originpagestudyquestionmanagequestionaddeditjs',['avalon','util','json','sortable','originmodulecwselectorcwselectorjs','originwidgetformformjs','dialog','originwidgetuploaderuploaderjs'],function(a,b,d,g){var f=this,c=f.erp,e={};return _.extend(e,{$init:function(i,g,h){function p(){b.c2s({url:c.BASE_PATH+'question/getQuestionOptionByQId.do',type:'post',contentType:'application/json',data:d.stringify({questionId:h.params.id/1}),success:function(i){var g,h;i.flag==1&&(g=i.data,e.questionType=o(g.question_type),e.coursewareId=g.coursewareid,e.coursewareName=g.courseware_name,e.questionTitle=g.question,e.pptName=g.pptName,e.questionType=='bool'?e.boolSetting=_.map(g.questionOptions,function(a){return{isRight:a.is_right,optionContent:a.option_content,id:a.id};}):(e.questionType=='single'||e.questionType=='multi')&&(e.optionList=_.map(g.questionOptions,function(a){return{isRight:a.is_right,optionContent:a.option_content,id:a.id};})),g.question_type==3&&(h=a.getVm(f),h.uploadList=_.map(g.pptList,function(a){return{id:b.generateID(),uploaded:!0,filePath:c.BASE_PATH+g.relativePath+'/'+a.ppt_dtl_name,name:a.original_file_name,data:d.stringify(a)};}),h.uploaded=_.map(h.uploadList.$model,function(a){return a.id;}),e.pptId=g.ppt_id));}});}function o(b){var a;switch(b){case'0':a='single';break;case'1':a='multi';break;case'2':a='bool';break;case'5':a='qa';break;case'3':a='ppt';break;case'4':a='practice';break;default:a='';break;}return a;}var k=g+'-cwselector',l=g+'-form',f=g+'-uploader',j=h.params.id/1,m=decodeURIComponent(h.params.coursewareName),n=c.getAppData('user'),e=a.define(g,function(e){e.state=g.split('-').pop(),e.navCrumbs=[{text:'\u8BD5\u9898\u7BA1\u7406',href:'#/study/questionmanage'},{text:e.state==='add'?'\u6DFB\u52A0\u8BD5\u9898':'\u4FEE\u6539\u8BD5\u9898'}],e.questionType=e.state==='add'?'single':'',e.optionList=[{optionContent:'',isRight:!0},{optionContent:'',isRight:!1}],e.boolSetting=[{optionContent:'\u6B63\u786E',isRight:!0},{optionContent:'\u9519\u8BEF',isRight:!1}],e.coursewareId=j?j:0,e.coursewareName=m?m:'',e.questionTitle='',e.referenceAnswer='',e.practiceUrl='',e.pptName='',e.pptId=0,e.switchQuestionType=function(f){var c=a(this),d=c.data('name');e.questionType=d;var b;(e.questionType=='single'||e.questionType=='bool')&&(_.each(e.optionList,function(a,c){a.isRight&&_.isUndefined(b)&&(b=c),a.isRight=!1;}),e.optionList.set(b||0,{isRight:!0}));},e.addQuestionOption=function(a){e.optionList.push({optionContent:'',isRight:!1,id:0});},e.removeOption=function(){var a=this.$vmodel.$model,b=a.$index;e.optionList.removeAt(b);},e.setOptionTrue=function(){var a=this.$vmodel.$model,b=a.$index;(e.questionType=='single'||e.questionType=='bool')&&_.each(e.optionList,function(a){a.isRight=!1;}),e.optionList.set(b,{isRight:!0});},e.setOptionFalse=function(){var a=this.$vmodel.$model,b=a.$index;e.optionList.set(b,{isRight:!1});},e.setBoolSetting=function(){var a=this.$vmodel.$model,b=a.$index;e.boolSetting[0].isRight=!1,e.boolSetting[1].isRight=!1,e.boolSetting.set(b,{isRight:!0});},e.$uploaderOpts={uploaderId:f,uploadList_:[],clickRemoveBtn:function(d){var b=a.getVm(f),c=this.$vmodel.$model;b.removeFile(c.el.id);},uploadifyOpts:{uploader:c.BASE_PATH+'question/uploadImage.do',fileObjName:'myfiles',multi:!0,fileTypeDesc:'\u56FE\u7247\u6587\u4EF6(*.gif; *.jpg; *.png; *.jpeg)',fileTypeExts:'*.gif; *.jpg; *.png; *.jpeg',fileSizeLimit:'2MB',formData:{sessionId:n.sessionId},width:112},defaultExtKeyData:{filePath:'',fileName:'',data:''},onSuccessResponseData:function(b){var a=d.parse(b);return{filePath:a.data[0].relativePath,fileName:a.data[0].fileName};}},e.$formOpts={formId:l,field:[{selector:'.question-type',name:'questionType',getValue:function(){return $(this).filter('.mn-radio-state-selected').data('name');},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u4E00\u79CD\u9898\u578B';}},{selector:'.question-title',name:'question',rule:['noempty',function(b,a){return a[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.option-list',name:'answers',getValue:function(){return e.optionList.$model;},reset:function(){$('.ff-value-tip',this).removeClass('valid-error').empty().hide(),$('.valid-error-field',this).removeClass('valid-error-field'),$('textarea',this).val('');},rule:function(d){var a=[],c=!1;return _.each(d,function(b,d){b.optionContent.length||a.push(d),b.isRight&&(c=!0);}),{handler:function(e){var d=this;$('.ff-value-tip',this).removeClass('valid-error').empty().hide(),$('.valid-error-field',this).removeClass('valid-error-field'),c||b.alert({iconType:'error',content:'\u8BF7\u8BBE\u7F6E\u81F3\u5C11\u4E00\u4E2A\u6B63\u786E\u7B54\u6848'}),e||_.each(a,function(e){var a=$('.option-item',d).eq(e),b=$('.ff-value-tip',a),c=$('.option-content',a);b.addClass('valid-error').text('\u7B54\u6848\u4E0D\u80FD\u4E3A\u7A7A').slideDown('fast'),c.addClass('valid-error-field');});},isPassed:!a.length&&c};}},{selector:'.bool-answer-field',name:'answers',getValue:function(){return e.boolSetting.$model;}},{selector:'.reference-answer',name:'referenceAnswer',rule:['noempty',function(b,a){return a[0]!==!0?'\u53C2\u8003\u7B54\u6848\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.url',name:'practiceUrl',rule:['noempty',function(b,a){return a[0]!==!0?'URL\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.pptName',name:'pptName',rule:['noempty',function(b,a){return a[0]!==!0?'PPT\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.upload-panel',name:'fileName',getValue:function(){var c=a.getVm(f),d=c.uploadList,b=[];return _.each(d.$model,function(a){return a.uploaded?(b.push({fileName:a.fileName,originalFileName:a.name,data:a.data}),!0):void 0;}),b;},rule:function(){var b=a.getVm(f),c=b.uploadList;return c.length?!0:'\u4E0A\u4F20ppt\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.courseware-selected',name:'coursewareId',getValue:function(){return e.coursewareId;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u5F52\u5C5E\u8BFE\u4EF6';}}],action:[{selector:'.f-submit',handler:function(n){var k=a.getVm(l),g=a.getVm(f),i,m,j;k.validate()&&(j=function(){i=k.getFormData(),e.state=='edit'?(_.extend(i,{questionId:h.params.id/1}),m=c.BASE_PATH+'question/updateQuestion.do',i.questionType=='ppt'&&(i.pptId=e.pptId)):m=c.BASE_PATH+'question/saveQuestion.do',b.c2s({url:m,type:'post',contentType:'application/json',data:d.stringify(i),success:function(a){a.flag==1&&b.alert({iconType:'success',content:a.message,onSubmit:function(){b.jumpPage('#/study/questionmanage');}});}});},e.questionType=='ppt'?g.uploading?(b.showGlobalMask(),g.$unwatch('uploading'),g.$watch('uploading',function(a){a||(b.hideGlobalMask(),j(),g.$unwatch('uploading'));})):j():j());}}]},e.$cwselectorOpts={cwselectorId:k,multi:!1,onListReady:function(a){_.some(a.$model,function(b,c){return b.id==e.coursewareId?(a.set(c,{isSelected:!0}),!0):void 0;});},onSubmit:function(a){a.length&&(e.coursewareId=a[0].id,e.coursewareName=a[0].coursewareName);}},e.openCourseware=function(){a.getVm(k).open();},e.removeAllUploadBtn=function(c){var b=a.getVm(f);b.removeAllFile();};});a.scan(i[0]),e.$watch('questionType',function(c){var b;c=='ppt'&&(b=a.getVm(f),b.uploadList.$watch('length',function(){var a=[],c;_.each(b.uploadList.$model,function(b){_.some(a,function(a){return a.name==b.name;})?c=b:a.push(b);}),c&&a.length!==b.uploadList.size()&&(b.uploadList=a,c.uploaded||$('#'+b.uploaderId).uploadify('cancel',c.id));}),b.uploaded.$watch('length',function(){var a=[];a=_.filter(b.uploadList.$model,function(a){return a.uploaded;}),b.uploadList_=a;}),a.scan($('.ppt-field-wrapper .upload-panel',i).removeAttr('ms-skip')[0],[b]),$('.upload-list',i).sortable({onDrop:function(e,g,f){var d=$('.upload-item',i),c=[];d.each(function(){var d=a(this).data('fileId');c.push(_.find(b.uploadList.$model,function(a){return a.id==d;}));}),b.uploadList.clear(),b.uploadList=c,b.uploadList_=c,f(e);}}),e.$unwatch('questionType'));}),e.state=='edit'&&p();},$remove:function(g,b){var d=b+'-cwselector',e=b+'-form',f=b+'-uploader',c=a.getVm(f);c&&$(c.widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(e).widgetElement).remove();}}),e;});

//From origin\page\study\questionmanage\questionmanage.js
define('originpagestudyquestionmanagequestionmanagejs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetformselectjs'],function(a,b){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(j,f,k){function e(i){var e=a.getVm(g),f={question:d.questionTitle,coursewareName:d.coursewareName,questionType:a.getVm(h).selectedValue};i?(f.pageSize=e.perPages,f.pageNumber=1):(f.pageSize=e.perPages,f.pageNumber=e.currentPage),b.c2s({url:c.BASE_PATH+'question/getQuestionsInfo.do',data:f,success:function(b){var a;b.flag&&(a=b.data,e.total=a.totalSize,i&&(e.currentPage=1),d.gridData=a.rows,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear());}});}var g=f+'-pagination',h=f+'-schedule',i=decodeURIComponent(k.params.coursewareName),d=a.define(f,function(a){a.permission={magQuestion:b.hasPermission('mag_question')},a.$scheduleOpts={selectId:h,options:[{text:'\u6240\u6709\u9898\u578B',value:''},{text:'\u5355\u9009',value:'0'},{text:'\u591A\u9009',value:'1'},{text:'\u5224\u65AD',value:'2'},{text:'PPT',value:'3'},{text:'\u4EA7\u54C1\u5B9E\u64CD',value:'4'},{text:'\u95EE\u7B54\u9898',value:'5'}],selectedIndex:0},a.questionTitle='',a.coursewareName=i==='undefined'?'':i,a.$positionOpts={options:[],selectedIndex:0},a.gridTotalSize=0,a.gridData=[],a.gridAllChecked=!1,a.gridSelected=[],a.gridCheckAll=function(){this.checked?a.gridSelected=_.map(a.gridData.$model,function(a){return a.id;}):a.gridSelected.clear();},a.scCheckAll=function(){a.gridSelected=_.map(a.gridData.$model,function(a){return a.id;});},a.$paginationOpts={paginationId:g,total:0,onJump:function(a,b){e();}},a.search=function(){e(!0);},a.jumpAddPage=function(){var a=$('<a href="#/study/questionmanage/add"></a>');a.appendTo('body'),a[0].click(),a.remove();},a.removeGridItem=function(){var b=$(this),c=b.data('id')+'';a.gridSelected=[c],a._removeQuestion();},a.batchRemoveGridItem=function(){a._removeQuestion();},a._removeQuestion=function(){var d,f,g;a.gridSelected.size()===0?b.alert({content:'\u8BF7\u5148\u9009\u4E2D\u8BD5\u9898'}):(d=a.gridSelected.$model,g=c.BASE_PATH+'question/deleteQuestion.do',f={idString:d},b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u8BD5\u9898\u5417\uFF1F',onSubmit:function(){b.c2s({url:g,type:'post',data:JSON.stringify(f),contentType:'application/json',success:function(a){a.flag==1&&e(!0);}});}}));};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),a.scan(j[0],[d]),e();},$remove:function(e,b){var c=b+'-pagination',d=b+'-schedule';$(a.getVm(d).widgetElement).remove(),$(a.getVm(c).widgetElement).remove();}}),d;});

//From origin\page\study\seniorstudy\manage\manage.js
define('originpagestudyseniorstudymanagemanagejs',['avalon','util','json','moment','originwidgetgridgridjs','originwidgetcalendarcalendarjs'],function(a,b,e,c){var g=this,d=g.erp,f={};return _.extend(f,{$init:function(l,h,i){function j(c){b.confirm({iconType:'info',content:'\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5B66\u5458\u5417\uFF1F',onSubmit:function(){b.c2s({type:'post',url:d.BASE_PATH+'oldStaffManagement/executeRemove.do',data:e.stringify({learningProgressIdList:c}),contentType:'application/json',dataType:'json',success:function(b){b.flag&&a.getVm(f).load();}});},onCancel:function(){a.getVm(f).unselectById('all');}});}var f=h+'-grid',g=h+'-calendar',k=a.define(h,function(h){h.removeTheStudentsPermission=b.hasPermission('remove_the_students'),h.removeAllTheStudentsPermission=b.hasPermission('remove_all_the_students'),h.timeDelayLearningPermission=b.hasPermission('time_delay_learning'),h.hashId=i.params.id,h.courseName=decodeURIComponent(i.params.name),h.tabIndex=1,h.courseStatus='',h.sumSize=0,h.learningSize=0,h.timeOutSize=0,h.graduationSize=0,h.learningProgressId='',h.studentName='',h.keyword='',h.$calendarOpts={calendarId:g,onClickDate:function(g){$(this.widgetElement).hide(),b.confirm({iconType:'info',content:'\u786E\u5B9A\u8981\u5EF6\u65F6'+h.studentName+'\u5B66\u4E60\u65F6\u95F4\u81F3'+c(g).format('YYYY-MM-DD')+'\u5417\uFF1F',onSubmit:function(){b.c2s({type:'post',url:d.BASE_PATH+'oldStaffManagement/executeDelay.do',data:e.stringify({learningProgressId:+h.learningProgressId,endDate:g.getTime()}),contentType:'application/json',dataType:'json',success:function(b){b.flag&&a.getVm(f).load();}});}});}},h.openCalendar=function(){var f=$(this),d=a.getVm(g),e,j=f.offset(),i=f.data('dateName'),k=new Date();h.learningProgressId=f.data('id'),h.studentName=f.data('studentName'),d?e=$(d.widgetElement):(e=$('<div ms-widget="calendar,$,$calendarOpts"></div>'),e.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(e[0],[h]),d=a.getVm(g),b.regGlobalMdExcept({element:e,handler:function(){e.hide();}})),h[i+'Date']?d.focusDate=c(h[i+'Date'],'YYYY-MM-DD')._d:d.focusDate=k,i==='start'&&h.endDate&&(d.maxDate=c(h.endDate,'YYYY-MM-DD').subtract('days',1)._d,d.minDate=null),i==='end'&&h.startDate&&(d.minDate=c(h.startDate,'YYYY-MM-DD').add('days',1)._d,d.maxDate=null),e.css({top:j.top+f.outerHeight()+5,left:j.left-245}).show();},h.$gridOpts={gridId:f,disableCheckAll:!1,disableCheckbox:!0,getTemplate:function(c){var a=c.split('MS_OPTION_TBAR'),b;return a=a[1].split('MS_OPTION_MAIN'),b=a[0],b+'<div class="ui-grid-bbar fn-clear">'+'<div class="grid-action fn-left">'+'<button type="button" class="check-all-btn main-btn"'+' ms-if="removeAllTheStudentsPermission"'+' ms-visible="!disableCheckAll"'+' ms-click="delAll">\u79FB\u9664\u5168\u90E8\u5B66\u5458</button>'+'&nbsp;'+'</div>'+'<div class="pagination fn-right"'+' ms-widget="pagination,$,$paginationOpts"></div>'+'</div>';},columns:[{dataIndex:'user_name',text:'\u59D3\u540D'},{dataIndex:'tel',text:'\u624B\u673A\u53F7'},{dataIndex:'position_name',text:'\u804C\u79F0'},{dataIndex:'group_name',text:'\u90E8\u95E8'},{dataIndex:'tip',text:'\u5B66\u4E60\u72B6\u6001',html:!0,renderer:function(a,b){return b.course_status==3?'<span class="font-red">'+a+'</span> ':a;}},{dataIndex:'operation',text:'\u64CD\u4F5C',html:!0,renderer:function(b,a){return'<a href="javascript:;" ms-click="delStudent" ms-data-id="$outer.el.id" ms-if="removeTheStudentsPermission">\u79FB\u9664\u5B66\u5458</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:;" ms-if="timeDelayLearningPermission" ms-click="openCalendar" ms-visible="$outer.el.course_status==3" ms-data-student-name="$outer.el.user_name" data-id="'+a.learning_progress_id+'" data-date-name="start">\u5EF6\u65F6\u5B66\u4E60</a>';}}],onLoad:function(a,c){_.extend(a,{coursewareId:+h.hashId,courseStatus:h.courseStatus,userName:_.str.trim(h.keyword),tel:''}),b.c2s({type:'post',url:d.BASE_PATH+'oldStaffManagement/queryOldStaffList.do',data:e.stringify(a),contentType:'application/json',dataType:'json',success:function(b){var a;b.flag&&(a=b.data,h.sumSize=a.sumSize,h.learningSize=a.learningSize,h.timeOutSize=a.timeOutSize,h.graduationSize=a.graduationSize,c.call(this,a));}});},delStudent:function(){var a=[+$(this).data('id')];j(a);},delAll:function(){var b=a.getVm(f),c=[];b.scCheckAll(),c=_.map(b.getSelectedData(),function(a){return a.id/1;}),j(c);}},h.query=function(){a.getVm(f).load();},h.switchTab=function(){var b=$(this).data('type');if(b==h.tabIndex)return;switch(b){case 1:h.courseStatus='';h.tabIndex=1;break;case 2:h.courseStatus='1';h.tabIndex=2;break;case 3:h.tabIndex=3;h.courseStatus='3';break;case 4:h.tabIndex=4;h.courseStatus='2';break;}a.getVm(f).load();};});a.scan(l[0],[k]),a.getVm(f).load();},$remove:function(f,c){var d=c+'-grid',e=c+'-calendar',b=a.getVm(e);$(a.getVm(d).widgetElement).remove(),b&&$(b.widgetElement).remove();}}),f;});

//From origin\page\study\seniorstudy\seniorstudy.js
define('originpagestudyseniorstudyseniorstudyjs',['avalon','util','json','dialog','originwidgetformformjs','originwidgetgridgridjs','originwidgettreetreejs'],function(a,b,d){var f=this,c=f.erp,e={};return _.extend(e,{$init:function(m,h){function i(i){var k=a.getVm(j),l=a.getVm(f),h,m=a.getVm(e).getSelectedData();i=='3'?(h={queryType:i,pageSize:100000,pageNumber:1},h.coursewareId=m[0].id/1):h={queryType:i},h.flag=l.excludeStudied?'1':'0',b.c2s({type:'post',url:c.BASE_PATH+'oldStaffManagement/queryInfo.do',data:d.stringify(h),contentType:'application/json',dataType:'json',success:function(a){var b=a.data.sysGroups;if(a.flag)switch(i){case'1':k.updateTree(_.map(b,function(a){return{id:a.id,name:a.groupName,pId:a.parentId};}));break;case'2':g.positionData=a.data.sysPositionList;break;case'3':g.employeeData=a.data.sysUserList.rows;break;}}});}function l(b){var a=[];return b.each(function(b){a.push($(this).data('id'));}),a;}var f=h+'-create-study-dialog',j=h+'-tree',e=h+'-grid',k=c.getAppData('user'),g=a.define(h,function(g){g.initiateStudiesPermission=b.hasPermission('initiate_studies'),g.keyword='',g.$treeOpts={treeId:j,ztreeOptions:{setting:{check:{enable:!0,chkboxType:{Y:'s',N:'s'}},callback:{onClick:function(a,b,c){}},data:{simpleData:{enable:!0}}}},treeData:[]},g.$gridOpts={gridId:e,recordUnit:'\u4E2A\u8BFE\u4EF6',disableCheckAll:!0,disableCheckbox:!0,columns:[{dataIndex:'id',text:'ID'},{dataIndex:'courseware_name',text:'\u8BFE\u4EF6\u540D\u79F0'},{dataIndex:'hours',text:'\u65F6\u957F\uFF08\u5206\uFF09'},{dataIndex:'speaker',text:'\u4E3B\u8BB2\u4EBA'},{dataIndex:'num',text:'\u5B66\u4E60\u4EBA\u6570'},{dataIndex:'operation',text:'\u64CD\u4F5C',html:!0,renderer:function(a,b){return'<a ms-href="#/study/seniorstudy/manage/{{$outer.el.id}}/{{$outer.el.courseware_name}}">\u5B66\u5458\u7BA1\u7406</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:;" ms-click="openStudy" ms-data-id="$outer.el.id" ms-if="initiateStudiesPermission">\u53D1\u8D77\u5B66\u4E60</a></td>';}}],onLoad:function(a,e){_.extend(a,{coursewareName:_.str.trim(g.keyword)}),b.c2s({type:'post',url:c.BASE_PATH+'oldStaffManagement/queryCoursewareList.do',data:d.stringify(a),contentType:'application/json',dataType:'json',success:function(a){var b;a.flag&&(b=a.data,e.call(this,b));}});}},g.query=function(){a.getVm(e).load();},g.studyType=['\u6309\u90E8\u95E8','\u6309\u804C\u4F4D','\u6309\u5458\u5DE5'],g.currentType='\u6309\u90E8\u95E8',g.typeNum=1,g.showIs=!1,g.positionData=[],g.employeeData=[],g.keyName='',g.todoNum=0,g.loginUserId=k.id,g.showType=function(){g.showIs=!0;},g.chooseType=function(b){var c=a(this).data('type');if(g.showIs=!1,b==g.currentType)return;g.positionData=[],g.employeeData=[];switch(c){case 1:g.typeNum=1;break;case 2:i('2');g.typeNum=2;break;case 3:i('3');g.typeNum=3;break;}g.currentType=b;},g.chooseSel=function(){$(this).hasClass('choose-bg')?$(this).removeClass('choose-bg'):$(this).addClass('choose-bg');},g.searchName=function(){if(_.str.trim(g.keyName)){var a=new RegExp(g.keyName);g.employeeData=_.filter(g.employeeData,function(b){return b.userName.match(a)?!0:!1;});}else i('3');},g.openStudy=function(){var b=a.getVm(f),c=a.getVm(e);b.title='\u53D1\u8D77\u5B66\u4E60',c.selectById($(this).data('id'),!0),b.open();},g.$createStudyDialogOpts={dialogId:f,width:540,excludeStudied:!0,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){g.showIs=!1,g.currentType='\u6309\u90E8\u95E8',g.typeNum=1,g.positionData=[],g.employeeData=[];},submit:function(){var n=$("input[name='flag']").prop('checked')?'1':'0',i=a.getVm(e),h={flag:n,coursewareId:+i.getSelectedData()[0].id},m=[],k;switch(g.typeNum){case 1:k='\u90E8\u95E8\u4EBA\u5458';m=_.map(a.getVm(j).core.getCheckedNodes(),function(a){return a.id;});_.extend(h,{idList:m,conditionType:'1'});break;case 2:k='\u804C\u4F4D\u4EBA\u5458';_.extend(h,{idList:l($('.position-list .choose-bg')),conditionType:'2'});break;case 3:k='\u5458\u5DE5';_.extend(h,{idList:l($('.employee-list .choose-bg')),conditionType:'3'});break;}b.confirm({iconType:'info',content:'\u4F60\u786E\u5B9A\u6240\u9009\u7684'+k+'\u5B66\u4E60'+i.getSelectedData()[0].courseware_name+'\u5417\uFF1F',onSubmit:function(){h.idList.length>0?b.c2s({type:'post',url:c.BASE_PATH+'oldStaffManagement/executeTermBegin.do',data:d.stringify(h),contentType:'application/json',dataType:'json',success:function(c){c.flag&&(b.alert({iconType:'success',content:c.message}),a.getVm(f).close(),i.load());}}):b.alert({iconType:'info',content:'\u8BF7\u9009\u62E9\u90E8\u95E8\u3001\u804C\u4F4D\u6216\u5458\u5DE5!'});}});}};});a.scan(m[0],[g]),a.getVm(e).load(),i('1'),b.c2s({url:c.BASE_PATH+'oldStaffManagement/queryToDoListCountByLeaderId.do',data:d.stringify({baseUserId:k.id}),contentType:'application/json',success:function(a){var b=a.data;a.flag&&(g.todoNum=b.totalSize);}});},$remove:function(f,b){var c=b+'-create-study-dialog',d=b+'-tree',e=b+'-grid';$(a.getVm(e).widgetElement).remove(),$(a.getVm(c).widgetElement).remove(),$(a.getVm(d).widgetElement).remove();}}),e;});

//From origin\page\study\studentmanage\detail\audition\audition.js
define('originpagestudystudentmanagedetailauditionauditionjs',['avalon','util','json','originmodulepptplayerpptplayerjs','originwidgetmediaplayerjs','originwidgetformformjs'],function(a,b,d){var f=this,c=f.erp,e={};return _.extend(e,{$init:function(o,e,n){function p(){b.c2s({url:c.BASE_PATH+'studentManagement/queryPptExamInfo.do',data:d.stringify({paperId:n.params.id/1}),contentType:'application/json',success:function(j){var b,g,h,d,e;j.flag&&(g=a.getVm(m),b=j.data,h=b.audioInfo,d=b.studentInfo,e=b.ppt,f.navCrumbs.set(1,{text:'\u67E5\u770B\u8BE6\u60C5-'+d.userName,href:'#/study/studentmanage/detail/'+d.id}),f.navCrumbs.set(2,{text:e.ppt_name}),g.pptList=_.map(b.pptDtlList,function(a){return{imagePath:c.BASE_PATH+b.pptPhotoPath+'/'+e.ppt_path+'/'+a.ppt_dtl_name};}),g.currentPath=g.pptList[0].imagePath,i.load([{file:c.BASE_PATH+b.audioPath+'/'+h.attachment_path+'/'+h.attachment_name}]),f.studentName=d.userName,f.studentId=d.id,f.pptName=e.ppt_name,f.auditionSummary=e.ppt_name);}});}var m=e+'-ppt',l=e+'-audio',g=e+'-do-score-dialog',h=e+'-play-over-dialog',k=e+'do-score-form',j=e+'do-score-form_',f=a.define(e,function(e){e.permission={markTheRecord:b.hasPermission('mark_the_record')},e.navCrumbs=[{text:'\u5B66\u5458\u7BA1\u7406',href:'#/study/studentmanage'},{text:'',href:''},{text:''}],e.studentName='',e.studentId=0,e.pptName='',e.auditionSummary='',e.$pptOpts={pptplayerId:m},e.$audioOpts={playerId:l,jwplayerOptions:{width:800,height:30}},e.$playOverDialogOpts={dialogId:h,title:'\u63D0\u793A',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b=e.permission.markTheRecord?'<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u4FDD\u5B58\u5E76\u8FD4\u56DE\u67E5\u770B\u8BE6\u60C5</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="replay">\u91CD\u65B0\u8BD5\u542C</button></div></div>':'<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u8FD4\u56DE\u8BE6\u60C5\u5217\u8868</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="replay">\u91CD\u65B0\u8BD5\u542C</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){var b=a.getVm(j);b.reset();},submit:function(k){var f,i=a.getVm(h),g;e.permission.markTheRecord?(g=a.getVm(j),g.validate()&&(f=g.getFormData(),_.extend(f,{paperId:n.params.id/1}),b.c2s({url:c.BASE_PATH+'studentManagement/updatePptPaper.do',type:'post',contentType:'application/json',data:d.stringify(f),success:function(a){a.flag&&(i.close(),b.alert({iconType:'success',content:a.message,onSubmit:function(){b.jumpPage('#/study/studentmanage/detail/'+e.studentId);}}));}}))):b.jumpPage('#/study/studentmanage/detail/'+e.studentId);},replay:function(){var b=a.getVm(h);b.close(),i.play(!0);}},e.$doScoreDialogOpts={dialogId:g,title:'\u5F55\u97F3\u8BC4\u5206',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){var b=a.getVm(k);b.reset();},submit:function(i){var e,h=a.getVm(g),f=a.getVm(k);f.validate()&&(e=f.getFormData(),_.extend(e,{paperId:n.params.id/1}),b.c2s({url:c.BASE_PATH+'studentManagement/updatePptPaper.do',type:'post',contentType:'application/json',data:d.stringify(e),success:function(a){a.flag&&(b.alert({iconType:'success',content:a.message}),h.close());}}));}},e.$doScoreFormOpts={formId:k,field:[{selector:'.score',name:'mark',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BC4\u5206\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.comment',name:'comment',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BC4\u8BED\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]},e.$doScoreFormOpts_={formId:j,field:[{selector:'.score',name:'mark',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BC4\u5206\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.comment',name:'comment',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BC4\u8BED\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]},e.doScore=function(){var b=a.getVm(g);b.open();};});a.scan(o[0]),p();var i=a.getVm(l).playerCore;i.onComplete(function(){var b=a.getVm(h);$(a.getVm(g).widgetElement).is(':hidden')&&b.open();});},$remove:function(m,b){var k=b+'-ppt',l=b+'-audio',g=b+'-do-score-dialog',h=b+'-play-over-dialog',i=b+'do-score-form',j=b+'do-score-form_',e=a.getVm(i),f=a.getVm(j),d=a.getVm(g),c=a.getVm(h);$(a.getVm(k).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),e&&$(e.widgetElement).remove(),f&&$(f.widgetElement).remove(),d&&$(d.widgetElement).remove(),c&&$(c.widgetElement).remove();}}),e;});

//From origin\page\study\studentmanage\detail\detail.js
define('originpagestudystudentmanagedetaildetailjs',['avalon','util','json','moment'],function(f,d,h,c){var a=this,g=a.erp,e={},b;return _.extend(e,{$init:function(j,k,l){function i(){d.c2s({url:g.BASE_PATH+'studentManagement/queryTraStudentRecordByStudentId.do',contentType:'application/json',data:h.stringify({studentId:l.params.id/1,pageSize:e.pageSize,pageNumber:e.pageNumber}),success:function(a){a.flag&&(e.originData=e.originData.concat(a.data.rows),e.lineList=m(e.originData),e.totalSize=a.data.totalSize,e.pageNumber=e.pageNumber+1,e.totalSize<=e.pageSize&&(e.isComplete=!0),a.data.totalSize===0&&d.alert({iconType:'info',content:'\u8BE5\u5B66\u5458\u8FD8\u6CA1\u6709\u8BE6\u60C5\u8BB0\u5F55'}));}});}function m(d){var a=[],b;return b=_.groupBy(d,function(a){return c(a.begin_time).format('YYYY-MM-DD');}),_.each(b,function(j,d){var h=c().format('YYYY-MM-DD'),i=c().subtract('days',1).format('YYYY-MM-DD'),f=!1,g=!1,b=d.split('-').slice(1).join('.');d==h&&(b='\u4ECA\u5929',f=!0),d==i&&(b='\u6628\u5929',g=!0),a.push({dateIndex:b,isToday:f,isYestoday:g,detailList:_.map(j,function(a){var b='';return a.operating_type=='1'&&e.permission.tryToLRecord&&a.exam_paper_type=='1'&&(b='<a href="#/study/studentmanage/detail/audition/'+a.paper_id+'">\u8BD5\u542C\u5F55\u97F3</a>'),{timeIndex:c(a.begin_time).format('HH:mm'),content:a.description,action:b};})});}),a;}var e=f.define(k,function(a){a.permission={tryToLRecord:d.hasPermission('try_to_l_record')},a.$skipArray=['originData'],a.lineList=[],a.originData=[],a.totalSize=0,a.pageSize=13,a.pageNumber=1,a.isComplete=!1;});f.scan(j[0]),i(),b=function(){$('body').height()-$(a).scrollTop()-$(a).height()<=10&&((e.pageNumber-1)*e.pageSize<e.totalSize?i():(e.isComplete=!0,$(a).unbind('scroll',b)));},$(a).scroll(b);},$remove:function(c,d){$(a).unbind('scroll',b),b=null;}}),e;});

//From origin\page\study\studentmanage\studentmanage.js
define('originpagestudystudentmanagestudentmanagejs',['avalon','util','moment','originmodulebindselectorbindselectorjs','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetformselectjs','originwidgetcalendarcalendarjs'],function(a,b,e){var f=this,c=f.erp,d={};return _.extend(d,{$init:function(o,f){function g(g){var f=a.getVm(n),e={userName:d.userName,tel:d.tel,courseStatus:a.getVm(i).selectedValue,positionId:a.getVm(k).selectedValue};d.permission.teacher&&(e.hasTeacherFlag=1),d.permission.charge&&(e.hasTeacherFlag=a.getVm(m).selectedValue),d.permission.teacher&&!d.permission.charge&&(e.teacherId=h.id),g?(e.pageSize=f.perPages,e.pageNumber=1):(e.pageSize=f.perPages,e.pageNumber=f.currentPage),b.c2s({url:c.BASE_PATH+'studentManagement/queryStudentList.do',data:JSON.stringify(e),contentType:'application/json',success:function(e){var a,c;e.flag&&(a=e.data,f.total=a.totalSize,g&&(f.currentPage=1),c=_.map(a.rows,function(a){return b.keyToCamelize(a);}),_.each(c,function(a){var b=a.progress,c=b.coursewareList;a.progressList=_.map(c,function(a){var b={id:a.id,isStudied:a.is_studied,isCurrent:a.is_current,isTimeout:a.is_timeout};return b;}),delete a.progress;}),d.gridData=c,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear());}});}var n=f+'-pagination',m=f+'-allocate',k=f+'-position',i=f+'-schedule',l=f+'-bind',j=f+'-delay-course',h=c.getAppData('user'),d=a.define(f,function(d){d.permission={teacher:b.hasPermission('teacher_item'),charge:b.hasPermission('t_incharge_item'),addStudent:b.hasPermission('add_student'),viewStudentDetail:b.hasPermission('view_student_detail'),unbindTSRel:b.hasPermission('unbind_t_s_rel'),allocateT:b.hasPermission('allocate_t'),cDelay:b.hasPermission('c_delay')},d.$allocateOpts={selectId:m,options:[{text:'\u5DF2\u5206\u914D\u8001\u5E08',value:1},{text:'\u672A\u5206\u914D\u8001\u5E08',value:0}],selectedIndex:0,onSelect:function(b){b?d.scheduleIsVisible=!0:(a.getVm(i).select(0),d.scheduleIsVisible=!1);}},d.scheduleIsVisible=!0,d.$scheduleOpts={selectId:i,options:[{text:'\u6240\u6709\u8FDB\u5EA6',value:''}],selectedIndex:0,onSelect:function(a,b,c){}},d.$positionOpts={selectId:k,options:[{text:'\u6240\u6709\u804C\u4F4D',value:0}],selectedIndex:0},d.loginUserId=h.id,d.userName='',d.tel='',d.gridData=[],d.todoNum=0,d.gridTotalSize=0,d.gridAllChecked=!1,d.gridSelected=[],d.gridCheckAll=function(){this.checked?d.gridSelected=_.map(d.gridData.$model,function(a){return a.studentId+'';}):d.gridSelected.clear();},d.scCheckAll=function(){d.gridSelected=_.map(d.gridData.$model,function(a){return a.studentId+'';});},d.search=function(){g(!0);},d.$paginationOpts={paginationId:n,total:0,onJump:function(a,b){g();}},d.$allocationOpts={bindselectorId:l,multi:d.permission.charge?!1:!0,listPath:d.permission.charge?'studentManagement/queryTeacherList.do':'studentManagement/queryStudentListToBeAllocated.do',onListReady:function(a){var b=d.gridSelected[0],c=_.find(d.gridData.$model,function(a){return a.studentId==b;});d.permission.charge&&_.some(a.$model,function(b,d){return b.teacherId==c.teacherId?(a.set(d,{isSelected:!0}),!0):void 0;});},onSubmit:function(a){var e=this,f,i,j;a.length?(i=d.gridSelected[0],j=_.find(d.gridData.$model,function(a){return a.studentId==i;}),f={teacherId:d.permission.charge?a[0].teacherId:h.id,studentIdList:d.permission.charge?[j.studentId]:_.map(a,function(a){return a.id;})},b.c2s({url:c.BASE_PATH+'studentManagement/saveTraTeacherStudent.do',type:'post',data:JSON.stringify(f),contentType:'application/json',success:function(a){a.flag&&(d.permission.charge?g():d.permission.teacher&&g(!0),e.close());}})):b.alert({iconType:'error',content:'\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u6761\u76EE'});}},d.openBindDialog=function(){var b=a.getVm(l),c=this.$vmodel.$model;d.permission.charge?(b.title='\u5206\u914D\u8001\u5E08',b.userRole='teacher',d.gridSelected.clear(),d.gridSelected.push(c.el.studentId+'')):d.permission.teacher&&(b.title='\u5B66\u5458\u8BA4\u9886',b.userRole='student'),b.open();},d.removeGridItem=function(){var b=a(this),c=b.data('studentId')+'';d.gridSelected.clear(),d.gridSelected.push(c),d._remove();},d.batchRemoveGridItem=function(){d._remove();},d._remove=function(){var a=[];d.gridSelected.size()>0?(_.each(d.gridSelected.$model,function(c){var b=_.find(d.gridData.$model,function(a){return a.studentId==c;});a.push({studentId:b.studentId,teacherId:b.teacherId});}),a.length===1&&(a=a[0]),b.confirm({content:'\u786E\u5B9A\u8981\u89E3\u9664\u5E08\u751F\u5173\u7CFB\u5417\uFF1F',onSubmit:function(){b.c2s({url:c.BASE_PATH+'studentManagement/deleteTraTeacherStudent.do',type:'post',contentType:'application/json',data:JSON.stringify(a),success:function(a){a.flag&&g();}});}})):b.alert({iconType:'error',content:'\u8BF7\u9009\u62E9\u81F3\u5C11\u4E00\u4E2A\u5B66\u751F'});},d.$delayCourseOpts={calendarId:j,onClickDate:function(h){var f=-1,a=_.find(d.gridData.$model,function(a,b){return a.studentId==d.gridSelected[0]?(f=b,!0):void 0;}),g=e(h)/1;b.c2s({url:c.BASE_PATH+'studentManagement/updateCourseEndTime.do',type:'post',contentType:'application/json',data:JSON.stringify({endDate:g,learningProgressId:a.learningProgressId,studentId:a.studentId,teacherId:a.teacherId,courseId:a.courseId,coursewareId:a.coursewareId}),success:function(a){a.flag&&(b.alert({iconType:'success',content:a.message}),f>-1&&d.gridData.set(f,{courseEndTime:g,courseStatus:'1'}));}}),$(this.widgetElement).hide();}},d.delayCourse=function(){var g=$(this),h=this.$vmodel.$model,f=a.getVm(j),c,i=g.offset();f?c=$(f.widgetElement):(c=$('<div ms-widget="calendar,$,$delayCourseOpts"></div>'),c.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(c[0],[d]),f=a.getVm(j),b.regGlobalMdExcept({element:c,handler:function(){c.hide();}})),c.css({top:i.top+g.outerHeight()+10,left:i.left-c.width()+g.width()}).show(),h.el.courseEndTime?f.focusDate=e(h.el.courseEndTime)._d:f.focusDate=new Date(),d.gridSelected.clear(),d.gridSelected.push(h.el.studentId+'');},d.showProgressTip=function(){var e=this.$vmodel.$model,g=e.$outer,h=g.el.progressTip,b=f+'-progress-tip',c=$(this),a=$('#'+b),d=c.offset();a.length||(a=$('<div id="'+b+'" class="grid-tip"></div>'),a.html('<span class="text-content"></span><span class="icon-arrow"></span>'),a.hide().appendTo('body')),c.hasClass('is-current')&&($('.text-content',a).text(h),a.css({top:d.top-a.height()-20,left:d.left-a.width()/2-11}).show());},d.hideProgressTip=function(){$('#'+f+'-progress-tip').hide();};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),a.scan(o[0]),g(),b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',data:'dictionaryType=00000005',success:function(b){var c=a.getVm(i);b.flag==1&&c.setOptions([{text:'\u6240\u6709\u8FDB\u5EA6',value:''}].concat(_.map(b.data,function(a){return{text:a.dictionary_value,value:a.dictionary_key};})));}}),b.c2s({url:c.BASE_PATH+'position/initPosition.do',success:function(b){var c=a.getVm(k);b.flag==1&&c.setOptions([{text:'\u6240\u6709\u804C\u4F4D',value:''}].concat(_.map(b.data,function(a){return{text:a.position_name,value:a.id};})));}}),!d.permission.charge&&d.permission.teacher&&b.c2s({url:c.BASE_PATH+'studentManagement/queryToDoListCountByTeacherId.do',data:JSON.stringify({teacherId:h.id}),contentType:'application/json',success:function(b){var a=b.data;d.todoNum=a.totalSize;}});},$remove:function(k,b){var e=b+'-pagination',f=b+'-allocate',g=b+'-position',h=b+'-schedule',i=b+'-bind',j=b+'-delay-course',d=a.getVm(f),c=a.getVm(j);$(a.getVm(e).widgetElement).remove(),d&&$(d.widgetElement).remove(),$(a.getVm(g).widgetElement).remove(),$(a.getVm(h).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),c&&$(c.widgetElement).remove(),$('#'+b+'-progress-tip').remove();}}),d;});

//From origin\page\study\studentmanage\todolist\todolist.js
define('originpagestudystudentmanagetodolisttodolistjs',['avalon','util','moment','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs'],function(a,b,g){var c=this,e=c.erp,f={},d;return _.extend(f,{$init:function(m,k,i){function l(){var a={pageSize:f.pageSize,pageNumber:f.pageNumber},c;i.route==='/study/seniorstudy/todolist/:id'?(c='oldStaffManagement/queryToDoListByLeaderId.do',a.baseUserId=i.params.id/1):i.route==='/study/studentmanage/todolist/:id'&&(c='studentManagement/queryToDoListByTeacherId.do',a.teacherId=i.params.id/1),b.c2s({url:e.BASE_PATH+c,contentType:'application/json',data:JSON.stringify(a),success:function(b){var a,c;b.flag&&(a=b.data,c=a.rows,f.todoList=f.todoList.concat(_.map(c,function(a){return{beginTime:g(a.begin_time/1).format('YYYY-MM-DD HH:mm:ss'),studentName:a.student_name,description:a.description,examPaperType:a.exam_paper_type,paperId:a.paper_id};})),f.totalSize=a.totalSize,f.pageNumber=f.pageNumber+1,f.totalSize<=f.pageSize&&(f.isComplete=!0));}});}var h=k+'-do-score-dialog',j=k+'-do-score-form',f=a.define(k,function(c){c.permission={tryToLRecord:b.hasPermission('try_to_l_record'),markTheRecord:b.hasPermission('mark_the_record'),humanMark:b.hasPermission('human_mark')},c.todoList=[],c.currentPaperId=0,c.currentExamPaperType=0,c.navCrumbs=[{text:'\u5B66\u5458\u7BA1\u7406',href:'#/study/studentmanage'},{text:'\u5F85\u529E\u4E8B\u9879'}],c.$doScoreDialogOpts={dialogId:h,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){var b=a.getVm(h);c.currentExamPaperType==5?b.title='\u771F\u4EBA\u4E92\u52A8\u8BC4\u5206':c.currentExamPaperType==1&&(b.title='\u8FDB\u884C\u8BC4\u5206');},onClose:function(){var b=a.getVm(j);b.reset();},submit:function(l){var d,k=a.getVm(h),g=a.getVm(j),i;g.validate()&&(c.currentExamPaperType==5?i='studentManagement/updateMark.do':c.currentExamPaperType==1&&(i='studentManagement/updatePptPaper.do'),d=g.getFormData(),_.extend(d,{paperId:c.currentPaperId/1}),b.c2s({url:e.BASE_PATH+i,type:'post',contentType:'application/json',data:JSON.stringify(d),success:function(a){a.flag?(b.alert({iconType:'success',content:a.message,onSubmit:function(){_.some(f.todoList.$model,function(a,b){return a.paperId==c.currentPaperId?(f.todoList.removeAt(b),!0):void 0;});}}),k.close()):b.alert({iconType:'error',content:a.message});}}));}},c.$doScoreFormOpts={formId:j,field:[{selector:'.score',name:'mark',rule:['noempty',function(a,b){return b[0]!==!0?'\u8BC4\u5206\u4E0D\u80FD\u4E3A\u7A7A':/^\d{1,6}$/.test(a)?a.slice(0,1)==='0'?'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u5206\u6570':!0:'\u8BF7\u8F93\u5165\u6709\u6548\u7684\u5206\u6570';}]},{selector:'.comment',name:'comment',rule:['noempty',function(b,a){return a[0]!==!0?'\u8BC4\u8BED\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]},c.openDoScore=function(f){var b=a.getVm(h),d=this.$vmodel.$model,e=d.el.examPaperType;c.currentPaperId=a(this).data('paperId'),c.currentExamPaperType=e,b.open(),f.preventDefault();},c.totalSize=0,c.pageSize=13,c.pageNumber=1,c.isComplete=!1;});a.scan(m[0]),l(),d=function(){$('body').height()-$(c).scrollTop()-$(c).height()<=10&&((f.pageNumber-1)*f.pageSize<f.totalSize?l():(f.isComplete=!0,$(c).unbind('scroll',d)));},$(c).scroll(d);},$remove:function(g,b){var e=b+'-do-score-dialog',f=b+'-do-score-form';$(a.getVm(f).widgetElement).remove(),$(a.getVm(e).widgetElement).remove(),$(c).unbind('scroll',d),d=null;}}),f;});

//From origin\page\study\videomanage\videomanage.js
define('originpagestudyvideomanagevideomanagejs',['avalon','util'],function(b,e){var c=this,d=c.erp,a={};return _.extend(a,{$init:function(a,c){var d=b.define(c,function(a){a.externalLink='http://192.168.236.31:8083/yazuo_erp/erp/video/toVideoItems.do',a.iframeHeight=1200,a.onIframeLoad=function(){};});b.scan(a[0]);},$remove:function(a,b){}}),a;});

//From origin\page\sysmanage\merchantinput\merchantinput.js
define('originpagesysmanagemerchantinputmerchantinputjs',['avalon','util','moment','json','originwidgetformformjs','originwidgetformselectjs','originwidgetuploaderuploaderjs','originwidgetcalendarcalendarjs'],function(a,b,e,d){var g=this,c=g.erp,f={};return _.extend(f,{$init:function(s,f,u){function t(){b.c2s({url:c.BASE_PATH+'user/getAllUsersByResourceCode.do',contentType:'application/json',data:d.stringify({remark:'sales_service'}),success:function(b){var c;b.flag&&(c=b.data,a.getVm(g).setOptions(_.map(c,function(a){return{value:a.id,text:a.userName};})));}}),b.c2s({url:c.BASE_PATH+'user/getAllUsersByResourceCode.do',contentType:'application/json',data:d.stringify({remark:'front_end_service'}),success:function(b){var c;b.flag&&(c=b.data,a.getVm(h).setOptions(_.map(c,function(a){return{value:a.id,text:a.userName};})));}});}var k=f+'-form',q=f+'-brand',r=f+'-merchant-list',j=f+'-service-years',l=f+'-free-months',m=f+'-online-status',g=f+'-sale',h=f+'-advisor',i=f+'-calendar',n=f+'-uploader',o=c.getAppData('user'),p=a.define(f,function(f){f.showAdvisor=!0,f.merchantLogo=c.ASSET_PATH+'image/merchant-default-logo.jpg',f.fileName='',f.originalFileName='',f.fileSize=0,f.$uploaderOpts={uploaderId:n,uploadifyOpts:{uploader:c.BASE_PATH+'synMerchant/uploadLogo.do',formData:{sessionId:o.sessionId},fileTypeDesc:'\u56FE\u7247\u6587\u4EF6(*.gif; *.jpg; *.png; *.jpeg)',fileTypeExts:'*.gif; *.jpg; *.png; *.jpeg',fileSizeLimit:'2MB',fileObjName:'myfiles',multi:!1},onSuccessResponseData:function(c){var b=d.parse(c),a=b.data[0];f.merchantLogo=a.relativePath,f.fileName=a.fileName,f.originalFileName=a.originalFileName,f.fileSize=a.fileSize;}},f.$serviceYearsOpts={selectId:j,options:_.map(_.range(0,11),function(a){return{text:a+'\u5E74',value:a};})},f.$freeMonthsOpts={selectId:l,options:_.map(_.range(0,7),function(a){return{text:a+'\u4E2A\u6708',value:a};})},f.$onlineStatusOpts={selectId:m,options:[{text:'\u5DF2\u4E0A\u7EBF',value:1},{text:'\u5546\u6237\u521B\u5EFA',value:2}],onSelect:function(a){a===2?f.showAdvisor=!1:f.showAdvisor=!0;}},f.$saleOpts={selectId:g},f.$advisorOpts={selectId:h},f.$formOpts={formId:k,field:[{selector:'.brand-id',name:'merchant_id',rule:['noempty',function(b,a){return a[0]!==!0?'\u54C1\u724CID\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.merchant-logo',name:'fileName',getValue:function(){return f.fileName;},rule:function(){return f.fileName.length?!0:'\u54C1\u724CLogo\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.service-years',name:'service_year',getValue:function(){return a.getVm(j).selectedValue;}},{selector:'.free-months',name:'free_month',getValue:function(){return a.getVm(l).selectedValue;}},{selector:'.start-date',name:'service_start_time',rule:['noempty',function(b,a){return a[0]!==!0?'\u670D\u52A1\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.online-status',name:'merchant_status',getValue:function(){return a.getVm(m).selectedValue+'';}},{selector:'.sale',name:'sales_user_id',getValue:function(){return a.getVm(g).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u9500\u552E\u4EBA\u5458';}},{selector:'.advisor',name:'front_user_id',excludeHidden:!0,getValue:function(){return a.getVm(h).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u524D\u7AEF\u987E\u95EE';}}]},f.startDate='',f.$calendarOpts={calendarId:i,onClickDate:function(a){f.startDate=e(a).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},f.openCalendar=function(){var g=$(this),d=a.getVm(i),c,h=g.offset(),j=new Date();d?c=$(d.widgetElement):(c=$('<div ms-widget="calendar,$,$calendarOpts"></div>'),c.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(c[0],[f]),d=a.getVm(i),b.regGlobalMdExcept({element:c,handler:function(){c.hide();}})),f.startDate?d.focusDate=e(f.startDate,'YYYY-MM-DD')._d:d.focusDate=j,c.css({top:h.top+g.outerHeight()-1,left:h.left}).show();},f.submit=function(){var g,i=a.getVm(k),h=a.getVm(n),j;i.validate()&&(j=function(){g=i.getFormData(),g.merchant_id=g.merchant_id/1,g.service_start_time=e(g.service_start_time,'YYYY-MM-DD')/1,g.originalFileName=f.originalFileName,g.fileSize=f.fileSize,b.c2s({url:c.BASE_PATH+'synMerchant/saveSynMerchantExtend.do',type:'post',contentType:'application/json',data:d.stringify(g),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){b.forceRefresh();}});}});},h.uploading?(b.showGlobalMask(),h.$unwatch('uploading'),h.$watch('uploading',function(a){a||(b.hideGlobalMask(),j(),h.$unwatch('uploading'));})):j());};});a.scan(s[0]),t();},$remove:function(l,b){var e=b+'-form',f=b+'-uploader',g=b+'-service-years',d=b+'-free-months',i=b+'-online-status',j=b+'-sale',k=b+'-advisor',h=b+'-calendar',c=a.getVm(h);c&&$(c.widgetElement).remove(),$(a.getVm(g).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(j).widgetElement).remove(),$(a.getVm(k).widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),$(a.getVm(e).widgetElement).remove();}}),f;});

//From origin\page\sysmanage\migration\migration.js
define('originpagesysmanagemigrationmigrationjs',['avalon','util','moment','json','originwidgetformformjs','originwidgetformselectjs','originwidgetuploaderuploaderjs','originwidgetautocompleteautocompletejs','originwidgetcalendarcalendarjs'],function(a,b,d,e){var g=this,c=g.erp,f={};return _.extend(f,{$init:function(r,f,t){function q(){b.c2s({url:c.BASE_PATH+'user/getAllUsersByResourceCode.do',contentType:'application/json',data:e.stringify({remark:'sales_service'}),success:function(b){var c;b.flag&&(c=b.data,a.getVm(i).setOptions(_.map(c,function(a){return{value:a.id,text:a.userName};})));}}),b.c2s({url:c.BASE_PATH+'user/getAllUsersByResourceCode.do',contentType:'application/json',data:e.stringify({remark:'front_end_service'}),success:function(b){var c;b.flag&&(c=b.data,a.getVm(j).setOptions(_.map(c,function(a){return{value:a.id,text:a.userName};})));}});}var m=f+'-form',h=f+'-brand',g=f+'-merchant-list',l=f+'-service-years',n=f+'-free-months',o=f+'-online-status',i=f+'-sale',j=f+'-advisor',k=f+'-calendar',p=c.getAppData('user'),s=a.define(f,function(f){f.navCrumbs=[{text:'miniERP\u6570\u636E\u8FC1\u79FB'}],f.showMerchantList=!1,f.showAdvisor=!0,f.merchantName='',f.crmId=0,f.$brandOpts={autocompleteId:h,placeholder:'\u8BF7\u6307\u5B9A\u5546\u6237',delayTime:300,onChange:function(a,d){a.length?b.c2s({url:c.BASE_PATH+'brands/getBrandsInfo.do',data:{name:a},success:function(a){var b;a.flag&&(b=a.data,d(_.map(b,function(a){return a.text=a.name||'\u672A\u77E5',a.value=a.id,a;})));}},{mask:!1}):d([]);},onSelect:function(c){var b=a.getVm(h).getOptionByValue(c);b.crm_id?(f.showMerchantList=!1,a.getVm(g)&&(a.getVm(g).inputText=''),f.merchantName=b.merchant_name,f.crmId=b.crm_id):(f.showMerchantList=!0,a.getVm(g)&&(a.getVm(g).inputText=b.name),f.merchantName='');}},f.$merchantListOpts={autocompleteId:g,onChange:function(a,d){a.length?b.c2s({url:c.BASE_PATH+'merchantCrm/getMerchantsInfo.do',data:{merchantName:a},success:function(a){var b;a.flag&&(b=a.data,d(_.map(b,function(a){return a.text=a.merchant_name||'\u672A\u77E5',a.value=a.merchant_id,a;})));}}):d([]);},onSelect:function(a,b){f.merchantName=b,f.crmId=a;}},f.$serviceYearsOpts={selectId:l,options:_.map(_.range(0,11),function(a){return{text:a+'\u5E74',value:a};})},f.$freeMonthsOpts={selectId:n,options:_.map(_.range(0,7),function(a){return{text:a+'\u4E2A\u6708',value:a};})},f.$onlineStatusOpts={selectId:o,options:[{text:'\u5DF2\u4E0A\u7EBF',value:1},{text:'\u5546\u6237\u521B\u5EFA',value:2}],onSelect:function(a){a===2?f.showAdvisor=!1:f.showAdvisor=!0;}},f.$saleOpts={selectId:i},f.$advisorOpts={selectId:j},f.$formOpts={formId:m,field:[{selector:'.brand-name',name:'mini_merchant_id',getValue:function(){return a.getVm(a.getVm(h).selectId).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u54C1\u724C';}},{selector:'.merchant-name',name:'merchant_id',getValue:function(){return f.crmId;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u5546\u6237';}},{selector:'.service-years',name:'service_year',getValue:function(){return a.getVm(l).selectedValue;}},{selector:'.free-months',name:'free_month',getValue:function(){return a.getVm(n).selectedValue;}},{selector:'.start-date',name:'service_start_time',rule:['noempty',function(b,a){return a[0]!==!0?'\u670D\u52A1\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.online-status',name:'merchant_status',getValue:function(){return a.getVm(o).selectedValue+'';}},{selector:'.sale',name:'sales_user_id',getValue:function(){return a.getVm(i).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u9500\u552E\u4EBA\u5458';}},{selector:'.advisor',name:'front_user_id',excludeHidden:!0,getValue:function(){return a.getVm(j).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u524D\u7AEF\u987E\u95EE';}}]},f.startDate='',f.$calendarOpts={calendarId:k,onClickDate:function(a){f.startDate=d(a).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},f.openCalendar=function(){var g=$(this),e=a.getVm(k),c,h=g.offset(),i=new Date();e?c=$(e.widgetElement):(c=$('<div ms-widget="calendar,$,$calendarOpts"></div>'),c.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(c[0],[f]),e=a.getVm(k),b.regGlobalMdExcept({element:c,handler:function(){c.hide();}})),f.startDate?e.focusDate=d(f.startDate,'YYYY-MM-DD')._d:e.focusDate=i,c.css({top:h.top+g.outerHeight()-1,left:h.left}).show();},f.submit=function(){var f,g=a.getVm(m);g.validate()&&(f=g.getFormData(),f.service_start_time=d(f.service_start_time,'YYYY-MM-DD')/1,b.c2s({url:c.BASE_PATH+'synMerchant/saveSynMerchantForOnlineBefore.do',type:'post',contentType:'application/json',data:e.stringify(f),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){b.forceRefresh();}});}}));};});a.scan(r[0]),q();},$remove:function(n,b){var e=b+'-form',f=b+'-brand',g=b+'-merchant-list',h=b+'-service-years',i=b+'-free-months',j=b+'-online-status',k=b+'-sale',l=b+'-advisor',m=b+'-calendar',d=a.getVm(m),c=a.getVm(g);d&&$(d.widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),c&&$(c.widgetElement).remove(),$(a.getVm(h).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(j).widgetElement).remove(),$(a.getVm(k).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),$(a.getVm(e).widgetElement).remove();}}),f;});

//From origin\page\sysmanage\orgmanage\orgmanage.js
define('originpagesysmanageorgmanageorgmanagejs',['avalon','util','originmoduleorganizationorganizationjs'],function(b,e,f){var c=this,d=c.erp,a={};return _.extend(a,{$init:function(c,d){var a=b.define(d,function(a){});b.scan(c[0],[a]);},$remove:function(a,b){}}),a;});

//From origin\page\sysmanage\position\position.js
define('originpagesysmanagepositionpositionjs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs'],function(a,b){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(j,g){function h(g){var e=a.getVm(i),f={};g?(f.pageSize=e.perPages,f.pageNumber=1):(f.pageSize=e.perPages,f.pageNumber=e.currentPage),b.c2s({url:c.BASE_PATH+'position/list.do',data:f,success:function(b){var a;b.flag&&(a=b.data,e.total=a.totalSize,g&&(e.currentPage=1),d.gridData=a.rows,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear());}});}var f=g+'-add-edit-dialog',e=g+'-add-edit-form',i=g+'-pagination',d=a.define(g,function(d){d.gridTotalSize=0,d.gridData=[],d.gridAllChecked=!1,d.gridSelected=[],d.addEditState='',d.gridCheckAll=function(){this.checked?d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';}):d.gridSelected.clear();},d.scCheckAll=function(){d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';});},d.$paginationOpts={paginationId:i,total:0,onJump:function(a,b){h();}},d.$addEditDialogOpts={dialogId:f,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e);b.positionName='',b.reset();},submit:function(n){var g,l,m=a.getVm(f),i=a.getVm(e),j=d.addEditState,k;i.validate()&&(g=i.getFormData(),j=='edit'&&(k=d.gridSelected[0],_.extend(g,{id:k})),l=c.BASE_PATH+'position/savePosition.do',b.c2s({url:l,type:'post',data:g,success:function(a){a.flag==1&&(b.alert({content:a.message,iconType:'success'}),j=='edit'?_.some(d.gridData.$model,function(a,b){return a.id==k?(d.gridData.set(b,{position_name:g.positionName}),!0):void 0;}):h(!0),m.close());}}));}},d.$addEditFormOpts={formId:e,field:[{selector:'.position-name',rule:['noempty',function(b,a){return a[0]!==!0?'\u804C\u4F4D\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],positionName:''},d.openAdd=function(){var b=a.getVm(f),c=a.getVm(e);b.title='\u6DFB\u52A0\u804C\u4F4D',c.positionName='',d.addEditState='add',d.gridSelected.clear(),b.open();},d.openEdit=function(){var b=a.getVm(f),g=a.getVm(e),c=a(this),h=c.data('positionId')+'',i=c.data('positionName');b.title='\u7F16\u8F91\u804C\u4F4D',g.positionName=i,d.addEditState='edit',d.gridSelected=[h],b.open();},d.removeGridItem=function(){var b=a(this),c=b.data('positionId')+'';d.gridSelected=[c],d._removePosition();},d.batchRemoveGridItem=function(){d._removePosition();},d._removePosition=function(){var a,e,f;d.gridSelected.size()===0?b.alert({content:'\u8BF7\u5148\u9009\u4E2D\u804C\u4F4D'}):(a=d.gridSelected.$model,a.length===1?(f=c.BASE_PATH+'position/delete.do',e={id:a[0]}):(f=c.BASE_PATH+'position/deleteMany.do',e={idString:a}),b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u804C\u4F4D\u5417\uFF1F',onSubmit:function(){b.c2s({url:f,type:'post',data:e,success:function(a){a.flag==1&&h();}});}}));};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),a.scan(j[0],[d]),h();},$remove:function(a,b){$('.add-edit-position-dialog .add-edit-form').remove(),$('.add-edit-position-dialog').remove(),$('.pagination',a).remove();}}),d;});

//From origin\page\sysmanage\resource\resource.js
define('originpagesysmanageresourceresourcejs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs'],function(a,c){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(j,g){function e(h,g){var f=a.getVm(i),e={};h?(e.pageSize=f.perPages,e.pageNumber=1):(e.pageSize=f.perPages,e.pageNumber=f.currentPage),g?(e.parentId=g,d.parentId=g):(e.parentId=0,d.parentId=0),c.c2s({url:b.BASE_PATH+'resource/list/'+e.parentId+'/'+e.pageNumber+'/'+e.pageSize+'.do',type:'get',contentType:'application/json',success:function(b){var a,c;b.flag==1&&(a=b.data,c=a.pageNavigate,f.total=a.totalSize,h&&(f.currentPage=1),_.each(a.rows,function(a){a.is_visible=='1'?(a.is_visible_text='\u542F\u7528',a.control_is_visible='\u7981\u7528'):(a.is_visible_text='\u7981\u7528',a.control_is_visible='\u542F\u7528');}),d.gridData=a.rows,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear(),d.navCrumbs=_.map(c,function(a,b){return{id:a.id,text:a.resourceName,href:'javascript:;'};}),d.navCrumbs.unshift({id:0,text:'\u8D44\u6E90\u7BA1\u7406',href:'#/sysmanage/resource'}),d.navCrumbs.set(d.navCrumbs.size()-1,{href:!1}));}});}var h=g+'-add-edit-dialog',f=g+'-add-edit-form',i=g+'-pagination',d=a.define(g,function(d){d.navCrumbs=[],d.parentId=0,d.gridTotalSize=0,d.gridData=[],d.gridAllChecked=!1,d.gridSelected=[],d.addEditState='',d.gridCheckAll=function(){this.checked?d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';}):d.gridSelected.clear();},d.scCheckAll=function(){d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';});},d.$paginationOpts={paginationId:i,total:0,onJump:function(a,b){e();}},d.$addEditDialogOpts={dialogId:h,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(f);b.resourceName='',b.reset();},submit:function(n){var g,i,m=a.getVm(h),j=a.getVm(f),k=d.addEditState,l;j.validate()&&(g=j.getFormData(),k=='edit'?(l=d.gridSelected[0],_.extend(g,{id:l}),i=b.BASE_PATH+'resource/updateResource.do'):i=b.BASE_PATH+'resource/saveResource.do',c.c2s({url:i,contentType:'application/json',type:'post',data:JSON.stringify(g),success:function(a){a.flag==1&&(k=='edit'?_.some(d.gridData.$model,function(a,b){return a.id==l?(d.gridData.set(b,{resource_name:g.resourceName}),!0):void 0;}):e(),m.close());}}));}},d.$addEditFormOpts={formId:f,field:[{selector:'.resource-name',rule:['noempty',function(b,a){return a[0]!==!0?'\u8D44\u6E90\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}],resourceName:''},d.triggerOnOrOff=function(i){var f=a(this),g=b.BASE_PATH+'resource/triggerOnOrOffResource/'+f.data('resourceId')+'.do',h=this.$vmodel.$model.el,e=this.$vmodel.$model.$index;c.c2s({url:g,type:'get',contentType:'application/json',success:function(a){a.flag&&(h.is_visible=='0'?d.gridData.set(e,{is_visible_text:'\u542F\u7528',control_is_visible:'\u7981\u7528',is_visible:'1'}):d.gridData.set(e,{is_visible_text:'\u7981\u7528',control_is_visible:'\u542F\u7528',is_visible:'0'}));}});},d.openEdit=function(){var b=a.getVm(h),e=a.getVm(f),c=a(this),g=c.data('resourceId')+'',i=c.data('resourceName');b.title='\u4FEE\u6539\u540D\u79F0',e.resourceName=i,d.addEditState='edit',d.gridSelected=[g],b.open();},d.batchTriggerOnGridItem=function(){d.batchTriggerTrigger(1);},d.batchTriggerOffGridItem=function(){d.batchTriggerTrigger(0);},d.batchTriggerTrigger=function(h){var a,f,g;d.gridSelected.size()===0?c.alert({content:'\u8BF7\u5148\u9009\u4E2D\u8D44\u6E90'}):(a=d.gridSelected.$model,g=b.BASE_PATH+'resource/updateResources.do',f={idString:a,flag:h},c.c2s({url:g,type:'post',contentType:'application/json',data:JSON.stringify(f),success:function(a){a.flag==1&&e(!1,d.parentId);}}));},d.viewChildren=function(){var b=a(this),c=b.data('resourceId');e(!1,c);},d.clickPageNav=function(){var b=a(this).data('resourceId');e(!1,b);};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),a.scan(j[0],[d]),e();},$remove:function(a,b){$('.add-edit-resource-dialog .add-edit-form').remove(),$('.add-edit-resource-dialog').remove(),$('.pagination',a).remove();}}),d;});

//From origin\page\sysmanage\role\role-common.js
define('originpagesysmanagerolerolecommonjs',['avalon','util'],function(b,c){var e=this,a=e.erp,d={};return _.extend(d,{$init:function(i,d,e){function j(b){c.c2s({url:a.BASE_PATH+'role/initTree.do',success:function(d){function e(b){_.each(b,function(b){var c='';(!b.childrenList||b.childrenList.length===0)&&(c='leaf-item'),a+='<li class="permission-item '+c+'">'+'<div class="permission-title">'+'<i class="visible-h iconfont" ms-click="toggleVisible">&#xe601;</i>&nbsp;<span class="label-for"><input type="checkbox" class="check-h" value="'+b.id+'" ms-click="clickNode" />&nbsp;'+'<label class="permission-name">'+b.text+'</label></span>'+'</div>',b.childrenList&&b.childrenList.length>0?(a+='<ul class="permission-list">',e(b.childrenList),a+='</ul></li>'):a+='</li>';});}var c,a='';d.flag==1&&(c=d.data,c=[].concat(c),e(c),f.html('<ul class="permission-list">'+a+'</ul>'),b&&b.call(this,c));}});}function k(){c.c2s({url:a.BASE_PATH+'role/edit.do',data:{id:e.params.id},success:function(a){var b;a.flag&&(b=a.data,_.each(b,function(a){$('.check-h[value="'+a+'"]',f).prop('checked',!0);}));}});}var f=$('.permission-box',i),g=d+'-form',h=b.define(d,function(f){f.navCrumbs=[{text:'\u6743\u9650\u7EC4\u7BA1\u7406',href:'#/sysmanage/role'},{text:d.slice(-3)==='add'?'\u6DFB\u52A0\u6743\u9650\u7EC4':'\u4FEE\u6539\u6743\u9650\u7EC4'}],f.formState=d.slice(-3)==='add'?'add':'edit',f.roleName=d.slice(-3)==='add'?'':decodeURIComponent(e.params.rolename),f.$formOpts={formId:g,field:[{selector:'.role-name',name:'roleName',rule:['noempty',function(b,a){return a[0]!==!0?'\u6743\u9650\u7EC4\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.permission-box .check-h',name:'permission',tipDeep:10,rule:function(a){return a.length===0?'\u8BF7\u81F3\u5C11\u5206\u914D\u4E00\u79CD\u6743\u9650':!0;}}],action:[{selector:'.f-submit',handler:function(){var d,i='role/saveRole.do',h=b.getVm(g);h.validate()&&(d=h.getFormData(),d.permission=[].concat(d.permission),f.formState==='edit'&&_.extend(d,{id:e.params.id}),c.c2s({url:a.BASE_PATH+i,data:d,success:function(b){b.flag&&(f.formState==='add'&&h.reset(),c.alert({content:b.message,iconType:'success',onSubmit:function(){window.location.href=a.BASE_PATH+'#!/sysmanage/role';}}));}}));}}]},f.clickNode=function(f){var a=$(this),b=a.closest('.permission-item'),d=a.prop('checked'),c=function(e){var b=e.closest('.permission-item'),d=b.parent().closest('.permission-item'),a=d.children('.permission-title').find(':checkbox');a.prop('checked',!0),a.closest('.permission-item').length>0&&c(a);},e=function(f){var b=f.closest('.permission-item'),c=b.siblings('.permission-item'),d=b.parent().closest('.permission-item'),a=d.children('.permission-title').find(':checkbox');c.children('.permission-title').find(':checked').length===0&&(a.prop('checked',!1),a.closest('.permission-item').length>0&&e(a));};d?(c(a),b.children('.permission-list').find(':checkbox').prop('checked',!0)):b.children('.permission-list').find(':checkbox').prop('checked',!1);},f.toggleVisible=function(e){var a=$(this),c=a.closest('.permission-item'),b=c.children('.permission-list'),d=a.data('isHidden');d?(b.slideDown('fast'),a.data('isHidden',!1),a.html('&#xe601;')):(b.slideUp('fast'),a.data('isHidden',!0),a.html('&#xe600;'));};});j(function(){h.formState==='edit'&&k(),b.scan(i[0],[h]);});},$remove:function(d,c){var a=c+'-form';$(b.getVm(a).widgetElement).remove();}}),d;});

//From origin\page\sysmanage\role\role.js
define('originpagesysmanagerolerolejs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs'],function(a,b){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(h,e){function f(h){var e=a.getVm(g),f={};h?(f.pageSize=e.perPages,f.pageNumber=1):(f.pageSize=e.perPages,f.pageNumber=e.currentPage),b.c2s({url:c.BASE_PATH+'role/list.do',data:f,success:function(b){var a;b.flag&&(a=b.data,e.total=a.totalSize,h&&(e.currentPage=1),d.gridData=a.rows,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear());}});}var i=e+'-add-edit-dialog',j=e+'-add-edit-form',g=e+'-pagination',d=a.define(e,function(d){d.gridTotalSize=0,d.gridData=[],d.gridAllChecked=!1,d.gridSelected=[],d.addEditState='',d.gridCheckAll=function(){this.checked?d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';}):d.gridSelected.clear();},d.scCheckAll=function(){d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';});},d.$paginationOpts={paginationId:g,total:0,onJump:function(a,b){f();}},d.removeGridItem=function(){var b=a(this),c=b.data('roleId')+'';d.gridSelected=[c],d._removeRole();},d.batchRemoveGridItem=function(){d._removeRole();},d.jumpAddPage=function(b){var a=$('<a href="#/sysmanage/role/add"></a>');a.appendTo('body'),a[0].click(),a.remove();},d._removeRole=function(){var a,e,g;d.gridSelected.size()===0?b.alert({content:'\u8BF7\u5148\u9009\u4E2D\u6743\u9650\u7EC4'}):(a=d.gridSelected.$model,g=c.BASE_PATH+'role/delete.do',e={id:a},b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u6743\u9650\u7EC4\u5417\uFF1F',onSubmit:function(){b.c2s({url:g,type:'post',data:e,success:function(a){a.flag==1&&f(!0);}});}}));};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),a.scan(h[0],[d]),f();},$remove:function(a,b){$('.add-edit-position-dialog .add-edit-form').remove(),$('.add-edit-position-dialog').remove(),$('.pagination',a).remove();}}),d;});

//From origin\page\sysmanage\usermanage\settingrange\settingrange.js
define('originpagesysmanageusermanagesettingrangesettingrangejs',['avalon','util','json','originwidgetformformjs','originwidgetformselectjs','originwidgetuploaderuploaderjs'],function(b,a,f){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(j,k,g){var h=k+'-form',d=b.define(k,function(d){d.navCrumbs=[{text:'\u7528\u6237\u7BA1\u7406',href:'#/sysmanage/usermanage'},{text:'\u8BBE\u7F6E\u7BA1\u8F96\u8303\u56F4'}],d.userName=decodeURIComponent(g.params.userName),d.$skipArray=['tempRangeId'],d.rangeIdSelected=[],d.exceptUserIdSelected=[],d.tempUserList=[],d.tempUserListVisible=!1,d.tempRangeId='',d.$formOpts={formId:h,field:[{selector:'.control-range-wrapper',name:'group',getValue:function(){return d.rangeIdSelected.$model;}}],action:[{selector:'.f-submit',handler:function(){var e,i=b.getVm(h);i.validate()&&(e=i.getFormData(),e.exceptUser=d.exceptUserIdSelected.$model,_.extend(e,{id:g.params.id}),a.c2s({url:c.BASE_PATH+'user/updateManager.do',type:'post',contentType:'application/json',data:f.stringify(e),success:function(b){b.flag==1&&a.alert({content:b.message,iconType:'success',onSubmit:function(){a.jumpPage('#/sysmanage/usermanage');}});}}));}}]},d.switchNodeVisible=function(e){var a=$(this),c=a.closest('.node-text'),b=c.next('.node-list'),d=a.data('visibleState')||'shown';d=='shown'?(b.slideUp('fast'),a.data('visibleState','hidden').html('&#xe600;')):(b.slideDown('fast'),a.data('visibleState','shown').html('&#xe601;'));},d.clickNodeCk=function(h){var a=$(this),b=a.closest('.node-text'),c=b.next('.node-list'),f=function(c){var a=c.closest('.node-list').prev('.node-text'),d=c.closest('.node-item').siblings(),b=!0;d.each(function(){var a=$(this);return $('.ck-h',a).prop('checked')?void 0:(b=!1,!1);}),b&&a.length&&($('.ck-h',a).prop('checked',!0),f(a));},g=function(b){var c=b.parent(),a=b.closest('.node-list').prev('.node-text');a.length&&($('.ck-h',a).prop('checked',!1),g(a));};d.closeTempUserList(),a.prop('checked')?($('.ck-h',c).prop('checked',!0),d.tempRangeId=b.data('groupId'),d.tempUserListVisible=!0):$('.ck-h',c).prop('checked',!1),d.rangeIdSelected.clear(),$(':checked',e).each(function(){d.rangeIdSelected.push($(this).val());});},d.closeTempUserList=function(){d.tempRangeId='',d.tempUserListVisible=!1;},d.clickTempUserItem=function(){var a=this.$vmodel.$model,b=a.$index,c=-1;a.el.isChecked?(d.tempUserList.set(b,{isChecked:!1}),_.some(d.exceptUserIdSelected,function(b){return b.id==a.el.id;})||d.exceptUserIdSelected.push({id:a.el.id,belongToGroup:a.el.group_id})):(d.tempUserList.set(b,{isChecked:!0}),_.some(d.exceptUserIdSelected,function(b,d){b.id==a.el.id&&(c=d);})&&d.exceptUserIdSelected.removeAt(c));},d.$watch('tempUserListVisible',function(b){b&&a.c2s({url:c.BASE_PATH+'user/getUserOfGroup.do',data:{groupId:d.tempRangeId},success:function(a){var b;a.flag&&(b=a.data,d.tempUserList=_.map(b,function(a){return _.extend(a,{isChecked:!0});}));}});});});b.scan(j[0]),d.rangeIdSelected.$watch('length',function(){d.exceptUserIdSelected=_.filter(d.exceptUserIdSelected.$model,function(a){return _.some(d.rangeIdSelected,function(b){return b==a.belongToGroup;})?!0:void 0;});});var i=function(a){var b='',c='',d='';return(!a.childrenList||a.childrenList.length===0)&&(c='leaf-node-text'),a.isRoot&&(c+=' root-node-text',d='root-node-list'),b+='<div class="node-text '+c+'" data-group-id="'+a.id+'">'+'<i class="visible-h iconfont" ms-click="switchNodeVisible">&#xe601;</i><span class="label-for"><input type="checkbox" class="ck-h" ms-click="clickNodeCk" ms-value="'+a.id+'" />&nbsp;'+'<label class="text-content">'+a.text+'</label></span></div>',a.childrenList&&a.childrenList.length>0&&(b+='<ul class="node-list '+d+'">',_.each(a.childrenList,function(a){b+='<li class="node-item">'+i(a)+'</li>';}),b+='</ul>'),b;},e=$('.control-range-wrapper',j);a.c2s({url:c.BASE_PATH+'group/initGroup.do',success:function(f){var h;f.flag&&(h=f.data,rootNodeData={id:0,text:'root',childrenList:h,isRoot:!0},e.html(i(rootNodeData)),b.scan(e[0],[d]),a.c2s({url:c.BASE_PATH+'user/edit.do',data:{id:g.params.id,editContent:'managerSetting'},success:function(b){var a;b.flag&&(a=b.data,_.each(a.group,function(a){$('[value="'+a+'"]',e).prop('checked',!0);}),d.rangeIdSelected=_.map(a.group,function(a){return a+'';}),d.exceptUserIdSelected=_.map(a.exceptUser,function(a){return{id:a.user_id,belongToGroup:a.group_id};}));}}));}});},$remove:function(d,c){var a=c+'-form';$(b.getVm(a).widgetElement).remove();}}),d;});

//From origin\page\sysmanage\usermanage\settingrole\settingrole.js
define('originpagesysmanageusermanagesettingrolesettingrolejs',['avalon','util','json','originwidgetformformjs','originwidgetformselectjs'],function(c,a,f){var e=this,b=e.erp,d={};return _.extend(d,{$init:function(i,g,d){function j(c){a.c2s({url:b.BASE_PATH+'role/initRole.do',success:function(a){var b;a.flag&&(b=a.data,e.roleList=_.map(b,function(a){return _.extend(a,{isChecked:!1});}),c&&c());}});}function k(){a.c2s({url:b.BASE_PATH+'user/edit.do',data:{id:d.params.id,editContent:'roleSetting'},success:function(a){var b;a.flag&&(b=a.data,_.each(b,function(b){var a=-1;_.some(e.roleList.$model,function(c,d){return c.id==b?(a=d,!0):void 0;}),e.roleList.set(a,{isChecked:!0});}));}});}var f=g+'-form',h=b.getAppData('user'),e=c.define(g,function(e){e.navCrumbs=[{text:'\u7528\u6237\u7BA1\u7406',href:'#/sysmanage/usermanage'},{text:'\u8BBE\u7F6E\u6743\u9650\u7EC4'}],e.userName=decodeURIComponent(d.params.userName),e.roleList=[],e.$formOpts={formId:f,field:[{selector:'.role-list-wrapper .ck-h',name:'roleIds',tipDeep:6,rule:function(a){return a.length?!0:($('.role-list-wrapper').addClass('valid-error-field'),'\u6743\u9650\u7EC4\u4E0D\u80FD\u4E3A\u7A7A');}}],action:[{selector:'.f-submit',handler:function(){var e,g=c.getVm(f);g.validate()&&(e=g.getFormData(),e.roleIds=[].concat(e.roleIds),_.extend(e,{id:d.params.id}),a.c2s({url:b.BASE_PATH+'user/updateRole.do',type:'post',data:e,success:function(b){b.flag==1&&a.alert({content:b.message,iconType:'success',onSubmit:function(){d.params.id==h.id?location.reload():a.jumpPage('#/sysmanage/usermanage');}});}}));}}]};});c.scan(i[0]),j(function(){k();});},$remove:function(d,b){var a=b+'-form';$(c.getVm(a).widgetElement).remove();}}),d;});

//From origin\page\sysmanage\usermanage\user-add-edit.js
define('originpagesysmanageusermanageuseraddeditjs',['avalon','util','json','moment','events','originwidgetformformjs','originwidgetformselectjs','originwidgetuploaderuploaderjs','originwidgetcalendarcalendarjs'],function(a,c,g,e,i){var h=this,b=h.erp,f={},d=new i();return _.extend(f,{$init:function(t,i,o){function u(){c.c2s({url:b.BASE_PATH+'role/initRole.do',success:function(a){var b;a.flag&&(b=a.data,f.roleList=b,h.role=!0,_.every(h,function(a){return a;})&&d.trigger('cptInited'));}});}function w(){c.c2s({url:b.BASE_PATH+'position/initPosition.do',success:function(b){var c,e=a.getVm(j);b.flag&&(c=b.data,e.setOptions(_.map(c,function(a){return{text:a.position_name,value:a.id};}),0),h.position=!0,_.every(h,function(a){return a;})&&d.trigger('cptInited'));}});}function v(){c.c2s({url:b.BASE_PATH+'user/edit.do',data:{id:o.params.id,editContent:'baseSetting'},success:function(g){var b=g.data,h,c,d=-1;g.flag&&(f.userType=b.isFormal=='0'?'new':'old',f.userName=b.userName,f.birthday=e.unix(b.birthday).format('YYYY-MM-DD'),f.sex=b.genderType,f.mobile=b.tel,f.belongToGroupId=b.groupId||'',f.belongToGroupName=b.groupName||'',f.userAvatar=b.userImage||'',f.fileName=b.fileName||'',f.mainRouteName==='sysmanage'&&(h=a.getVm(j),c=h.panelVmodel,f.macList=_.map(b.macs,function(a){return{value:a};}),_.some(c.options.$model,function(a,c){return a.value==b.positionId?(d=c,!0):void 0;}),c.selectedIndex=d));}});}var s=i+'-uploader',j=i+'-position',k=i+'-organization',n=i+'-form',l=i+'-birthday',r=b.getAppData('user'),f=a.define(i,function(d){d.$skipArray=['tempRangeId'],d.mainRouteName=o.route.split('/')[1],d.state=i.split('-').pop(),d.navCrumbs=[{text:'\u7528\u6237\u7BA1\u7406',href:'#/sysmanage/usermanage'},{text:d.state==='add'?'\u6DFB\u52A0\u7528\u6237':'\u4FEE\u6539\u7528\u6237'}],d.userAvatar=b.ASSET_PATH+'image/user-avatar-default.png',d.userType='new',d.birthday='',d.sex='0',d.userName='',d.mobile='',d.macList=[{value:''}],d.roleList=[],d.rangeIdSelected=[],d.exceptUserIdSelected=[],d.tempUserList=[],d.tempUserListVisible=!1,d.tempRangeId='',d.belongToGroupId='',d.belongToGroupName='',d.fileName='',d.$uploaderOpts={uploaderId:s,uploadifyOpts:{uploader:b.BASE_PATH+'user/uploadImage.do',formData:{sessionId:r.sessionId},fileTypeDesc:'\u56FE\u7247\u6587\u4EF6(*.gif; *.jpg; *.png; *.jpeg)',fileTypeExts:'*.gif; *.jpg; *.png; *.jpeg',fileSizeLimit:'2MB',fileObjName:'myfiles',multi:!1},onSuccessResponseData:function(b){var a=g.parse(b);d.userAvatar=a.data[0].relativePath,d.fileName=a.data[0].fileName;}},d.$positionOpts={selectId:j,options:[],selectIndex:0},d.$organizationOpts={dialogId:k,title:'\u9009\u62E9\u90E8\u95E8',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},clickNode:function(){var b=$(this),a=b.closest('.node-text');d.belongToGroupId=a.data('groupId'),d.belongToGroupName=a.data('groupName');},onOpen:function(){},onClose:function(){},submit:function(b){a.getVm(k).close();}},d.$formOpts={formId:n,field:[{selector:'.user-type',name:'isFormal',getValue:function(){return $(this).filter('.mn-radio-state-selected').data('userType');}},{selector:'.user-name',name:'userName',rule:['noempty',function(b,a){return a[0]!==!0?'\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.birthday',name:'birthday',getValue:function(){var a=_.str.trim($(this).val());return a.length?e(a,'YYYY-MM-DD').unix():0;},rule:function(a){return a===0?'\u751F\u65E5\u4E0D\u80FD\u4E3A\u7A7A':!0;}},{selector:'.sex',name:'genderType'},{selector:'.mac-wrapper',name:'macs',getValue:function(){var a=[];return _.each(d.macList.$model,function(c){var b=_.str.trim(c.value);b&&a.push(b);}),a;},rule:function(a){return a.length?!0:'MAC\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.mobile',name:'tel',rule:['noempty',function(b,c){if(c[0]!==!0)return'\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A';else{var a=/^(13[0-9]|15[0-9]|18[0-9])\d{8}$/;return a.test(b)?!0:'\u624B\u673A\u53F7\u9519\u8BEF';}}]},{selector:'.user-avatar',name:'userImage',getValue:function(){return'img';}},{selector:'.organization',name:'groupId',getValue:function(){return d.belongToGroupId;},rule:['noempty',function(b,a){return a[0]!==!0?'\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.position',name:'positionId',getValue:function(){return a.getVm(j).selectedValue;},rule:function(a){return a?!0:'\u804C\u4F4D\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.control-range-wrapper',name:'group',getValue:function(){return d.rangeIdSelected.$model;}},{selector:'.role-list-wrapper .ck-h',name:'roleIds',tipDeep:6,rule:function(a){return a.length?!0:($('.role-list-wrapper').addClass('valid-error-field'),'\u6743\u9650\u7EC4\u4E0D\u80FD\u4E3A\u7A7A');}},{selector:'.old-pwd',name:'oldPassword'},{selector:'.confirm-pwd',name:'newPassword'},{selector:'.confirm-pwd',name:'password',rule:function(b,d,c){var a=_.str.trim($('.new-pwd',c).val());return b.length||a.length?b!==a?'\u786E\u8BA4\u5BC6\u7801\u4E0D\u4E00\u81F4':!0:!0;}}],action:[{selector:'.f-submit',handler:function(){var e,h=a.getVm(j),f=a.getVm(n);f.validate()&&(e=f.getFormData(),e.exceptUser=d.exceptUserIdSelected.$model,d.state==='edit'?e.id=o.params.id:e.roleIds=[].concat(e.roleIds),e.fileName=d.fileName,c.c2s({url:b.BASE_PATH+'user/saveUser.do',type:'post',contentType:'application/json',data:g.stringify(e),success:function(a){a.flag==1&&(d.state=='add'&&(f.reset(),d.userAvatar=b.ASSET_PATH+'image/user-avatar-default.png',d.userType='new',d.sex='0',d.birthday='',d.userName='',d.mobile='',d.rangeIdSelected=[],d.exceptUserIdSelected=[],d.tempUserList=[],d.tempUserListVisible=!1,d.tempRangeId='',d.belongToGroupId='',d.belongToGroupName='',d.fileName='',h.select(0,!0)),c.alert({content:a.message,iconType:'success',onSubmit:function(){c.jumpPage('#/sysmanage/usermanage');}}));}}));}}]},d.$birthdayOpts={calendarId:l,maxDate:new Date(),onClickDate:function(a){d.birthday=e(a).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},d.openBirthdayPanel=function(){var g=$(this),f=a.getVm(l),b,h=g.offset();f?b=$(f.widgetElement):(b=$('<div ms-widget="calendar,$,$birthdayOpts"></div>'),b.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(b[0],[d]),f=a.getVm(l),c.regGlobalMdExcept({element:b,handler:function(){b.hide();}})),d.birthday?f.focusDate=e(d.birthday,'YYYY-MM-DD')._d:f.focusDate=new Date(),b.css({top:h.top+g.outerHeight()-1,left:h.left}).show();},d.addMoreMac=function(){d.macList.push({value:''});},d.removeMacItem=function(){var a=this.$vmodel.$model,b=a.$index;d.macList.removeAt(b);},d.openOrganizationDialog=function(c){var b=a.getVm(k);b.open();},d.switchNodeVisible=function(e){var a=$(this),c=a.closest('.node-text'),b=c.next('.node-list'),d=a.data('visibleState')||'shown';d=='shown'?(b.slideUp('fast'),a.data('visibleState','hidden').html('&#xe600;')):(b.slideDown('fast'),a.data('visibleState','shown').html('&#xe601;'));},d.clickNodeCk=function(g){var a=$(this),b=a.closest('.node-text'),c=b.next('.node-list'),e=function(c){var a=c.closest('.node-list').prev('.node-text'),d=c.closest('.node-item').siblings(),b=!0;d.each(function(){var a=$(this);return $('.ck-h',a).prop('checked')?void 0:(b=!1,!1);}),b&&a.length&&($('.ck-h',a).prop('checked',!0),e(a));},f=function(b){var c=b.parent(),a=b.closest('.node-list').prev('.node-text');a.length&&($('.ck-h',a).prop('checked',!1),f(a));};d.closeTempUserList(),a.prop('checked')?($('.ck-h',c).prop('checked',!0),d.tempRangeId=b.data('groupId'),d.tempUserListVisible=!0):$('.ck-h',c).prop('checked',!1),$(':checked',m).each(function(){d.rangeIdSelected.ensure($(this).val());});},d.closeTempUserList=function(){d.tempRangeId='',d.tempUserListVisible=!1;},d.clickTempUserItem=function(){var a=this.$vmodel.$model,b=a.$index,c=-1;a.el.isChecked?(d.tempUserList.set(b,{isChecked:!1}),_.some(d.exceptUserIdSelected,function(b){return b.id==a.el.id;})||d.exceptUserIdSelected.push({id:a.el.id,belongToGroup:a.el.group_id})):(d.tempUserList.set(b,{isChecked:!0}),_.some(d.exceptUserIdSelected,function(b,d){b.id==a.el.id&&(c=d);})&&d.exceptUserIdSelected.removeAt(c));},d.$watch('tempUserListVisible',function(a){a&&c.c2s({url:b.BASE_PATH+'user/getUserOfGroup.do',data:{groupId:d.tempRangeId},success:function(a){var b;a.flag&&(b=a.data,d.tempUserList=_.map(b,function(a){return _.extend(a,{isChecked:!0});}));}});});});a.scan(t[0]),f.rangeIdSelected.$watch('length',function(){f.exceptUserIdSelected=_.filter(f.exceptUserIdSelected.$model,function(a){return _.some(f.rangeIdSelected,function(b){return b==a.belongToGroup;})?!0:void 0;});});var q=function(a){var b='',c='',d='';return(!a.childrenList||a.childrenList.length===0)&&(c='leaf-node-text'),a.isRoot&&(c+=' root-node-text',d='root-node-list'),b+='<div class="node-text '+c+'" data-group-id="'+a.id+'" data-group-name="'+a.text+'" ms-class="state-selected: belongToGroupId == '+a.id+'">'+'<i class="visible-h iconfont" ms-click="switchNodeVisible">&#xe601;</i>'+'<label class="text-content" ms-click="clickNode">'+a.text+'</label></div>',a.childrenList&&a.childrenList.length>0&&(b+='<ul class="node-list '+d+'">',_.each(a.childrenList,function(a){b+='<li class="node-item">'+q(a)+'</li>';}),b+='</ul>'),b;},p=function(a){var b='',c='',d='';return(!a.childrenList||a.childrenList.length===0)&&(c='leaf-node-text'),a.isRoot&&(c+=' root-node-text',d='root-node-list'),b+='<div class="node-text '+c+'" data-group-id="'+a.id+'">'+'<i class="visible-h iconfont" ms-click="switchNodeVisible">&#xe601;</i><span class="label-for"><input type="checkbox" class="ck-h" ms-click="clickNodeCk" ms-value="'+a.id+'" />&nbsp;'+'<label class="text-content">'+a.text+'</label></span></div>',a.childrenList&&a.childrenList.length>0&&(b+='<ul class="node-list '+d+'">',_.each(a.childrenList,function(a){b+='<li class="node-item">'+p(a)+'</li>';}),b+='</ul>'),b;},h={group:!1,position:!1};f.state==='add'&&(h.role=!1,h.range=!1),f.state==='add'?u():d.on('cptInited',function(){v();});var m=$('.control-range-wrapper',t);f.mainRouteName==='sysmanage'?(c.c2s({url:b.BASE_PATH+'group/initGroup.do',success:function(c){var e,b;c.flag&&(e=c.data,b={id:0,text:'root',childrenList:e,isRoot:!0},a.getVm(k).setContent('<div class="group-wrapper">'+q(b)+'</div>'),f.state==='add'&&(m.html(p(b)),a.scan(m[0],[f]),h.range=!0),h.group=!0,_.every(h,function(a){return a;})&&d.trigger('cptInited'));}}),w()):f.mainRouteName==='profile'&&d.trigger('cptInited');},$remove:function(j,b){var e=b+'-uploader',f=b+'-position',g=b+'-organization',h=b+'-form',i=b+'-birthday',c=a.getVm(i);$(a.getVm(e).widgetElement).remove(),a.getVm(b).mainRouteName==='sysmanage'&&($(a.getVm(f).widgetElement).remove(),$(a.getVm(g).widgetElement).remove()),$(a.getVm(h).widgetElement).remove(),c&&$(c.widgetElement).remove(),d.off('cptInited');}}),f;});

//From origin\page\sysmanage\usermanage\usermanage.js
define('originpagesysmanageusermanageusermanagejs',['avalon','util','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetformselectjs'],function(a,b){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(i,f){function g(i){var f=a.getVm(h),g={userName:d.name,tel:d.phone,positionId:a.getVm(e).selectedValue};i?(g.pageSize=f.perPages,g.pageNumber=1):(g.pageSize=f.perPages,g.pageNumber=f.currentPage),b.c2s({url:c.BASE_PATH+'user/list.do',data:g,success:function(b){var a;b.flag&&(a=b.data,f.total=a.totalSize,i&&(f.currentPage=1),_.each(a.rows,function(a){var b=[];_.each(a.listRoles,function(a){b.push(a.roleName);}),a.patchedRoleNames=b.length==0?'':b.join(','),a.position?a.positionName=a.position.positionName:a.positionName='';}),d.gridData=a.rows,d.gridTotalSize=a.totalSize,d.gridAllChecked=!1,d.gridSelected.clear());}});}var h=f+'-pagination',e=f+'-position',d=a.define(f,function(d){d.name='',d.phone='',d.gridTotalSize=0,d.gridData=[],d.gridAllChecked=!1,d.gridSelected=[],d.addEditState='',d.gridCheckAll=function(){this.checked?d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';}):d.gridSelected.clear();},d.$positionOpts={selectId:e,options:[],selectedIndex:0},d.scCheckAll=function(){d.gridSelected=_.map(d.gridData.$model,function(a){return a.id+'';});},d.$paginationOpts={paginationId:h,total:0,onJump:function(a,b){g();}},d.jumpAddPage=function(){var a=$('<a href="#/sysmanage/usermanage/add"></a>');a.appendTo('body'),a[0].click(),a.remove();},d.search=function(){g(!0);},d.removeGridItem=function(){var b=a(this),c=b.data('userId')+'';d.gridSelected=[c],d._removeUser();},d.batchRemoveGridItem=function(){d._removeUser();},d._removeUser=function(){var e,a,f,g=function(){_.each(e,function(b){var a=-1;_.some(d.gridData.$model,function(c,d){return c.id==b?(a=d,!0):void 0;})&&(d.gridData.removeAt(a),d.gridSelected.clear());});};d.gridSelected.size()===0?b.alert({content:'\u8BF7\u5148\u9009\u4E2D\u7528\u6237'}):(e=d.gridSelected.$model,f=c.BASE_PATH+'user/delete.do',a={id:e,defineDelete:0},b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u7528\u6237\u5417\uFF1F',onSubmit:function(){b.c2s({url:f,type:'post',data:a,success:function(c){c.flag==1?g():c.flag==2&&(a.defineDelete=1,b.confirm({content:c.message,onSubmit:function(){b.c2s({url:f,type:'post',data:a,success:function(a){a.flag&&g();}});}}));}});}}));};});d.gridSelected.$watch('length',function(a){d.gridAllChecked=a===d.gridData.size();}),a.scan(i[0],[d]),g(),b.c2s({url:c.BASE_PATH+'position/initPosition.do',success:function(b){var c=a.getVm(e);b.flag==1&&c.setOptions([{value:'',text:'\u5168\u90E8\u804C\u4F4D'}].concat(_.map(b.data,function(a){return{text:a.position_name,value:a.id};})),0);}});},$remove:function(e,b){var c=b+'-pagination',d=b+'-position';$(a.getVm(c).widgetElement).remove(),$(a.getVm(d).widgetElement).remove();}}),d;});

//From origin\page\sysmanage\webkit\webkit.js
define('originpagesysmanagewebkitwebkitjs',['avalon','util','moment','originwidgetpaginationpaginationjs','dialog','originwidgetformformjs','originwidgetformselectjs','originwidgetgridgridjs','originwidgetuploaderuploaderjs'],function(a,b,f){var e=this,c=e.erp,d={};return _.extend(d,{$init:function(o,d){var g=d+'-grid',i=d+'-add-dialog',e=d+'-add-form',h=d+'-uploader',j=d+'-version-num-1',k=d+'-version-num-2',l=d+'-version-num-3',m=c.getAppData('user'),n=a.define(d,function(d){d.permission={},d.$gridOpts={gridId:g,recordUnit:'\u4E2A\u7248\u672C',tableLayout:'fixed',columns:[{dataIndex:'versionNum',text:'\u7248\u672C\u53F7'},{dataIndex:'updateTime',text:'\u66F4\u65B0\u65E5\u671F',renderer:function(a){return f(a).format('YYYY-MM-DD HH:mm:ss');}},{dataIndex:'description',text:'\u66F4\u65B0\u8BF4\u660E',width:420},{dataIndex:'fileSize',text:'\u6587\u4EF6\u5927\u5C0F\uFF08M\uFF09',renderer:function(a){return(a/1024/1024).toFixed(2);}},{dataIndex:'operation',text:'\u64CD\u4F5C',html:!0,textAlign:'left',renderer:function(b,a){return'<a href="'+a.downloadLink+'" class="download-l">\u4E0B\u8F7D\u5E94\u7528</a>&nbsp;&nbsp;&nbsp;&nbsp;'+'<a href="javascript:;" class="remove-l" ms-click="removeGridItem"'+' data-record-id="'+a.id+'">\u5220\u9664</a></td>';}}],onLoad:function(a,d){b.c2s({url:c.BASE_PATH+'webkit/list.do',data:a,success:function(a){var b;a.flag&&(b=a.data,d.call(this,b));}});},removeGridItem:function(){var c=$(this),b=a.getVm(g),d=c.data('recordId');b.selectById(d,!0),b._removeRecord();},_removeRecord:function(){var f,h,i,d=a.getVm(g),e=d.getSelectedData();e.length===0?b.alert({content:'\u8BF7\u5148\u9009\u4E2D\u8BB0\u5F55'}):(f=_.map(e,function(a){return a.id;}),i=c.BASE_PATH+'webkit/deleteWebkit.do',h={id:f[0]},b.confirm({content:'\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684\u7248\u672C\u5417\uFF1F',onSubmit:function(){b.c2s({url:i,type:'post',dataType:'json',data:h,success:function(a){a.flag&&d.load();}});}}));}},d.$addDialogOpts={dialogId:i,title:'\u4E0A\u4F20\u65B0\u7248\u5E94\u7528',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onOpen:function(){},onClose:function(){var b=a.getVm(e);b.reset(),b.originalFileName='',b.attachmentName='',b.attachmentSize=0,a.getVm(j).select(0,!0),a.getVm(k).select(0,!0),a.getVm(l).select(0,!0);},submit:function(r){var f,o,p=a.getVm(i),m=a.getVm(e),q=a.getVm(g),d=a.getVm(h),n;m.validate()&&(o=c.BASE_PATH+'webkit/saveWebkit.do',n=function(){f=m.getFormData(),f.versionNum='v.'+a.getVm(j).selectedValue+'.'+a.getVm(k).selectedValue+'.'+a.getVm(l).selectedValue,b.c2s({url:o,type:'post',contentType:'application/json',data:JSON.stringify(f),success:function(a){a.flag&&b.alert({iconType:'success',content:a.message,onSubmit:function(){p.close(),q.load(1);}});}});},d.uploading?(b.showGlobalMask(),d.$unwatch('uploading'),d.$watch('uploading',function(a){a||(b.hideGlobalMask(),n(),d.$unwatch('uploading'));})):n());}},d.$addFormOpts={formId:e,field:[{selector:'.version-uploader',name:'attachmentVO',getValue:function(){var b=a.getVm(e);return{attachmentName:b.attachmentName,originalFileName:b.originalFileName,attachmentSize:b.attachmentSize};},rule:function(){var b=a.getVm(e);return b.attachmentName.length?!0:'\u4E0A\u4F20\u7248\u672C\u6587\u4EF6\u4E0D\u80FD\u4E3A\u7A7A';}},{selector:'.update-desc',name:'description',rule:['noempty',function(b,a){return a[0]!==!0?'\u66F4\u65B0\u8BF4\u660E\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'[name="page_sysmanage_webkit_add_is_forced_upgrade"]',name:'isForcedUpgrade'}],originalFileName:'',attachmentName:'',attachmentSize:0,$uploaderOpts:{uploaderId:h,uploadifyOpts:{uploader:c.BASE_PATH+'webkit/uploadImage.do',formData:{sessionId:m.sessionId},fileObjName:'myfiles',multi:!1,fileTypeDesc:'Webkit\u6587\u4EF6(*.*)',fileTypeExts:'*.*',fileSizeLimit:'100MB',width:88,height:30,onSelect:function(c){var b=a.getVm(h);b.uploadList.size()&&b.removeFile(b.uploadList[0].id);}},onSuccessResponseData:function(g,h){var c=JSON.parse(g),d,f=a.getVm(e);c.flag?(d=c.data[0],f.originalFileName=d.originalFileName,f.attachmentName=d.fileName,f.attachmentSize=d.fileSize):b.alert({content:c.message,iconType:'error'});}},$versionNum1Opts:{selectId:j,options:_.map(_.range(1,31),function(a){return{text:a,value:a};})},$versionNum2Opts:{selectId:k,options:_.map(_.range(0,31),function(a){return{text:a,value:a};})},$versionNum3Opts:{selectId:l,options:_.map(_.range(0,31),function(a){return{text:a,value:a};})}},d.openAdd=function(){a.getVm(i).open();};});a.scan(o[0],[n]),a.getVm(g).load();},$remove:function(j,b){var c=b+'-grid',d=b+'-add-dialog',e=b+'-add-form',f=b+'-uploader',g=b+'-version-num-1',h=b+'-version-num-2',i=b+'-version-num-3';$(a.getVm(c).widgetElement).remove(),$(a.getVm(g).widgetElement).remove(),$(a.getVm(h).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),$(a.getVm(e).widgetElement).remove(),$(a.getVm(d).widgetElement).remove();}}),d;});

//From origin\page\welcome\welcome.js
define('originpagewelcomewelcomejs',['avalon','util','json','moment','originmoduleaddproductaddproductjs'],function(c,e,f,g){var d=this,a=d.erp,b={};return _.extend(b,{$init:function(b,d,g){var e=$('.page-bd-inner',b),f=c.define(d,function(b){b.noPermission=!a.getAppData('permission').length,b.noCourse=!a.getAppData('user').hasCourse;});c.scan(b[0]);},$remove:function(a,b){}}),b;});

//From origin\page\wldh\setting\setting.js
define('originpagewldhsettingsettingjs',['avalon','util','moment','json','originwidgetitemselectoritemselectorjs','dialog','originwidgetformselectjs'],function(a,b,f,d){var g=this,c=g.erp,e={};return _.extend(e,{$init:function(q,g,r){function i(){var d=a.getVm(l),e=a.getVm(m);b.c2s({url:c.BASE_PATH+'mktTeam/list.do',type:'get',data:{date:f(d.selectedValue+'-'+e.selectedValue,'YYYY-M')/1},success:function(a){var b=a.data;a.flag&&(p.teamList=_.map(b,function(a){return{id:a.id,teamName:a.teamName,teamLeader:a.leaderName,teamMember:a.teamMember,teamWord:a.teamSlogan,odds:a.teamOdds,oddsState:'r',oddsBtnText:'\u4FEE\u6539',income:a.salesDegrees,incomeState:'r',incomeBtnText:'\u4FEE\u6539',supportVisibleCtrBtnText:'\u67E5\u770B\u652F\u6301\u8005',supportVisibleState:!1,supportNum:a.supportCount,supportList:[]};}));}});}function j(d,a){b.c2s({url:c.BASE_PATH+'mktTeam/listSupport.do',type:'get',data:d,success:function(b){b.flag&&a&&a(b.data);}});}var h=g+'-add-support-dialog',e=g+'-user-selector',l=g+'-current-year',m=g+'-current-month',n=f(),k=n.year(),o=n.month(),p=a.define(g,function(f){f.activeTeamId=0,f.activeTeamAtIndex=-1,f.$addSupportOpts={dialogId:h,title:'\u6DFB\u52A0\u652F\u6301\u8005',width:600,getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},submit:function(){var g=a.getVm(e),i=g.getSelectedData();b.c2s({url:c.BASE_PATH+'mktTeam/saveSupporter.do',type:'post',contentType:'application/json',data:d.stringify({id:f.activeTeamId,supportList:_.map(i,function(a){return{id:a.id};})}),success:function(b){b.flag&&(j({teamId:f.activeTeamId},function(a){f.teamList.set(f.activeTeamAtIndex,{supportNum:a.length,supportList:_.map(a,function(a){return{id:a.id,supportName:a.userName,position:a.position.positionName};})});}),a.getVm(h).close());}});}},f.$userSelectorOpts={itemselectorId:e,rightTitle:'\u5DF2\u6DFB\u52A0\u7684\u652F\u6301\u8005\uFF080\uFF09',showLeftTitle:!1,showRightFilter:!1,onItemFilter:function(a,b){return b.userName.slice(0,a.length)===a||b.positionName.slice(0,a.length)===a?!0:void 0;}},f.$currentYearOpts={selectId:l,options:_.map(_.range(0,10),function(a){return{text:k-a+'\u5E74',value:k-a};}),onSelect:function(){i();}},f.$currentMonthOpts={selectId:m,options:_.map(_.range(1,13),function(a){return{text:a+'\u6708',value:a};}),onSelect:function(){i();},selectedIndex:o},f.teamList=[],f.clickOddsBtn=function(){var a=this.$vmodel.$model.$index,g=this.$vmodel.$model.el,h=f.teamList[a].oddsState,e,i;if(h==='e'){if(e=_.str.trim($(this).siblings('.odds-editor').val()),!e.length){i=f.teamList[a].odds,f.teamList[a].odds='',f.teamList[a].odds=i,f.teamList[a].oddsState='r',f.teamList[a].oddsBtnText='\u4FEE\u6539';return;}b.c2s({url:c.BASE_PATH+'mktTeam/saveMktTeam.do',type:'post',contentType:'application/json',data:d.stringify({id:g.id,teamOdds:e}),success:function(b){b.flag&&f.teamList.set(a,{oddsState:'r',oddsBtnText:'\u4FEE\u6539',odds:e});}});}else f.teamList.set(a,{oddsState:'e',oddsBtnText:'\u4FDD\u5B58'});},f.clickIncomeBtn=function(){var a=this.$vmodel.$model.$index,g=this.$vmodel.$model.el,h=f.teamList[a].incomeState,e,i;if(h==='e'){if(e=_.str.trim($(this).closest('.income-box').find('.income-editor').val()),!e.length){i=f.teamList[a].income,f.teamList[a].income='',f.teamList[a].income=i,f.teamList[a].incomeState='r',f.teamList[a].incomeBtnText='\u4FEE\u6539';return;}if(!/^-?\d+(\.\d{1,2})?$/.test(e)){b.alert({content:'\u8BF7\u8F93\u5165\u6B63\u786E\u683C\u5F0F\u7684\u6570\u5B57\uFF0C\u6700\u591A\u4FDD\u75592\u4F4D\u5C0F\u6570',iconType:'error'});return;}b.c2s({url:c.BASE_PATH+'mktTeam/saveMktTeam.do',type:'post',contentType:'application/json',data:d.stringify({id:g.id,salesDegrees:e}),success:function(b){b.flag&&f.teamList.set(a,{incomeState:'r',incomeBtnText:'\u4FEE\u6539',income:e});}});}else f.teamList.set(a,{incomeState:'e',incomeBtnText:'\u4FDD\u5B58'});},f.clickSupportVisibleBtn=function(){var a=this.$vmodel.$model.$index,b=this.$vmodel.$model.el,c=f.teamList[a].supportVisibleState;c?f.teamList.set(a,{supportVisibleState:!1,supportVisibleCtrBtnText:'\u67E5\u770B\u652F\u6301\u8005',supportList:[]}):j({teamId:b.id},function(b){f.teamList.set(a,{supportVisibleState:!0,supportVisibleCtrBtnText:'\u6536\u8D77',supportNum:b.length,supportList:_.map(b,function(a){return{id:a.id,supportName:a.userName,position:a.position.positionName};})});});},f.addMoreSupport=function(){var i=a.getVm(h),d=a.getVm(e),g=this.$vmodel.$model.el,j=this.$vmodel.$model.$index,k=this.$vmodel.$model.el.supportList;b.c2s({url:c.BASE_PATH+'mktTeam/listNoChooseSupport.do',type:'get',data:{teamId:g.id},success:function(c){var a,b,e;c.flag&&(a=c.data,b=a.chooseSupportList,e=a.noChooseSupportList,d.store=_.map(b,function(a){return{text:'<div class="fn-clear"><div class="fn-left">'+a.userName+'</div><div class="fn-right">'+a.position.positionName+'</div></div>',visible:!0,selected:!0,preSelected:!1,userName:a.userName,positionName:a.position.positionName,id:a.id};}).concat(_.map(e,function(a){return{text:'<div class="fn-clear"><div class="fn-left">'+a.userName+'</div><div class="fn-right">'+a.position.positionName+'</div></div>',visible:!0,selected:!1,preSelected:!1,userName:a.userName,positionName:a.position.positionName,id:a.id};})),d.rightTitle='\u5DF2\u6DFB\u52A0\u7684\u652F\u6301\u8005\uFF08'+b.length+'\uFF09',f.activeTeamId=g.id,f.activeTeamAtIndex=j,i.open());}});},f.removeSupport=function(){var d=a(this),e=d.data('teamId'),g=d.data('userId'),h=this.$vmodel.$outer.$index;b.c2s({url:c.BASE_PATH+'mktTeam/deleteSupport.do',type:'post',data:{teamId:e,supportId:g},success:function(a){a.flag&&j({teamId:e},function(a){f.teamList.set(h,{supportNum:a.length,supportList:_.map(a,function(a){return{id:a.id,supportName:a.userName,position:a.position.positionName};})});});}});};});a.scan(q[0]),a.getVm(e).$watch('selectedchange',function(){this.rightTitle='\u5DF2\u6DFB\u52A0\u7684\u652F\u6301\u8005\uFF08'+_.filter(this.store.$model,function(a){return a.selected;}).length+'\uFF09';}),i();},$remove:function(g,b){var c=b+'-add-support-dialog',d=b+'-user-selector',e=b+'-current-year',f=b+'-current-month';$(a.getVm(e).widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(c).widgetElement).remove();}}),e;});

//From origin\page\wldh\show\show.js
define('originpagewldhshowshowjs',['avalon','util','moment','json','originwidgetformselectjs'],function(a,f,g,h){var e=this,c=e.erp,d={},b=[];return _.extend(d,{$init:function(l,h){function i(a,b,d){f.c2s({url:c.BASE_PATH+b,type:'post',data:a,success:d});}function j(h){var c;if(h.flag){c=h.data,e.pageData=[];for(var b=0;b<c.length;b++){var a={},d=[];a.id=c[b].id,a.leaderImage=c[b].leaderImage,a.leaderName=c[b].leaderName,a.teamMember=c[b].teamMember,a.teamOdds=c[b].teamOdds,a.salesDegrees=c[b].salesDegrees,a.lold='hide',a.supporters=[],forArr=c[b].supportList;var f=0;for(var g=0;g<forArr.length;g++)f++,d.push(forArr[g].userName),f>=18&&(f=0,a.supporters.push(d),d=[]);d.length&&a.supporters.push(d),e.pageData.push(a);}}}var d=function(c){var a=h+c;return b.push(a),a;},m=c.getAppData('user'),e=a.define(h,function(b){b.pageData=[{id:0,leaderImage:'',leaderName:'',teamMember:'',teamOdds:'',salesDegrees:'',supporters:[],lold:''}],b.loldStatus=function(c){var a=this.$vmodel.$model.el.lold;a=='hide'?b.pageData[c].lold='show':a=='show'&&(b.pageData[c].lold='hide');},b.$yearOpts={selectId:d('yearId'),options:[{text:'2014\u5E74',value:2014}],onSelect:function(){}};var c=new Date(),e=c.getMonth();b.$monthOpts={selectId:d('monthId'),options:[{text:'1\u6708',value:1},{text:'2\u6708',value:2},{text:'3\u6708',value:3},{text:'4\u6708',value:4},{text:'5\u6708',value:5},{text:'6\u6708',value:6},{text:'7\u6708',value:7},{text:'8\u6708',value:8},{text:'9\u6708',value:9},{text:'10\u6708',value:10},{text:'11\u6708',value:11},{text:'12\u6708',value:12}],onSelect:function(){var b=a.getVm(d('yearId')),c=a.getVm(d('monthId')),e=b.selectedValue+'-'+c.selectedValue,f=g(e,'yyyy-M')/1;i({isFromAssiant:!0,date:f},'mktTeam/list.do',j);},selectedIndex:e};});a.scan(l[0]);var k=new Date();i({isFromAssiant:!0,date:k.getTime()},'mktTeam/list.do',j);},$remove:function(c,d){_.each(b,function(c){var b=a.getVm(c);b&&$(b.widgetElement).remove();}),b.length=0;}}),d;});

//From origin\page\work\assign\assign.js
define('originpageworkassignassignjs',['avalon','util','moment','json','originwidgetformformjs','originwidgetformselectjs','originwidgetuploaderuploaderjs','originwidgetcalendarcalendarjs'],function(a,b,d,e){var g=this,c=g.erp,f={};return _.extend(f,{$init:function(r,f,u){function s(){var d=a.getVm(k),f=a.getVm(l),g=a.getVm(h);b.c2s({url:c.BASE_PATH+'group/getSubordinateEmployees.do',type:'post',contentType:'application/json',data:e.stringify({baseUserId:m.id}),success:function(a){var b;a.flag&&(b=a.data,d.setOptions([{text:'\u8BF7\u9009\u62E9',value:-1}].concat(_.map(b,function(a){return{text:a.userName,value:a.id};}))));}}),b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000063',success:function(a){var b;a.flag&&(b=a.data,f.setOptions([{text:'\u8BF7\u9009\u62E9',value:0}].concat(_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}))));}}),b.c2s({url:c.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000064',success:function(a){var b;a.flag&&(b=a.data,g.setOptions([{text:'\u8BF7\u9009\u62E9',value:0}].concat(_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}))));}});}var p=f+'-start-hour',n=f+'-start-minute',j=f+'-project',l=f+'-plan-item-type',h=f+'communication-form-type',g=f+'-attach-uploader',k=f+'-assigner',i=f+'-start-date',o=f+'-form',m=c.getAppData('user'),q=$('.upload-info',r),t=a.define(f,function(f){f.belongToRouteName=u.route.split('/')[1],f.belongToRouteName==='work'?f.navCrumbs=[{text:'\u5DE5\u4F5C\u8BA1\u5212',href:'#/work/plan'},{text:'\u5DE5\u4F5C\u6307\u6D3E'}]:f.belongToRouteName==='frontend'&&(f.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u5DE5\u4F5C\u6307\u6D3E'}]),f.$assignerOpts={selectId:k,options:[],onSelect:function(e){var d=a.getVm(j);d.setOptions([{text:'\u8BF7\u9009\u62E9',value:-1}]),e!==-1&&b.c2s({url:c.BASE_PATH+'synMerchant/getSynMerchantByUserId.do',type:'get',contentType:'application/json',data:{userId:e},success:function(a){var b;a.flag&&(b=a.data,d.setOptions([{text:'\u8BF7\u9009\u62E9',value:-1}].concat(_.map(b,function(a){return{text:a.merchant_name,value:a.merchant_id};})).concat({text:'\u5176\u5B83',value:0})));}});}},f.$startHourOpts={selectId:p,options:_.map(_.range(0,24),function(a){return{text:_.str.lpad(a,2,'0'),value:a};}),selectedIndex:9},f.$startMinuteOpts={selectId:n,options:_.map(_.range(0,60),function(a){return{text:_.str.lpad(a,2,'0'),value:a};})},f.$projectOpts={selectId:j,options:[{text:'\u8BF7\u9009\u62E9',value:-1}]},f.$planItemTypeOpts={selectId:l,options:[]},f.$communicationFormTypeOpts={selectId:h,options:[]},f.$attachUploaderOpts={uploaderId:g,uploadifyOpts:{uploader:c.BASE_PATH+'fesPlan/uploadPlanFiles.do',fileObjName:'myfiles',multi:!0,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',formData:{sessionId:m.sessionId},width:116,height:30},defaultExtKeyData:{originalFileName:'',attachmentName:'',attachmentSize:'',attachmentSuffix:''},onSuccessResponseData:function(d,c){var b=e.parse(d),a={};return b.flag&&(a.originalFileName=b.data[0].originalFileName,a.attachmentName=b.data[0].fileName,a.attachmentSize=c.fileSize+'',a.attachmentSuffix=c.type.slice(1)),a;},removeItem:function(){var b=this.$vmodel.$model,c=b.el.id;a.getVm(g).removeFile(c);}},f.$formOpts={formId:o,field:[{selector:'.assigner',name:'userId',getValue:function(){return a.getVm(k).selectedValue;},rule:function(a){return a===-1?'\u8BF7\u9009\u62E9\u6307\u6D3E\u4EBA':!0;}},{selector:'.start-date',name:'startTime',getValue:function(){var b=_.str.trim($(this).val());return b?d(b+' '+a.getVm(p).selectedValue+':'+a.getVm(n).selectedValue,'YYYY-MM-DD H:m')/1:0;},rule:function(a){return a?!0:'\u8BF7\u8BBE\u7F6E\u5F00\u59CB\u65F6\u95F4';}},{selector:'.project',name:'merchantId',getValue:function(){return a.getVm(j).selectedValue;},rule:function(a){return a===-1?'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u9879\u76EE':!0;}},{selector:'.plan-item-type',name:'planItemType',getValue:function(){return a.getVm(l).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u4E8B\u9879\u7C7B\u578B';}},{selector:'.communication-form-type',name:'communicationFormType',getValue:function(){return a.getVm(h).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u6C9F\u901A\u65B9\u5F0F';}},{selector:'.title',name:'title',rule:['noempty',function(a,b){return b[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':a.length>20?'\u6807\u9898\u4E0D\u80FD\u8D85\u8FC720\u4E2A\u5B57\u7B26':!0;}]},{selector:'.desc',name:'description'},{selector:'.attach-uploader',name:'attachmentList',reset:function(){var b=a.getVm(g);f.formState=='add'&&b.removeAllFile();},getValue:function(){var c=a.getVm(g),d=c.uploadList,b=[];return _.each(d.$model,function(a,c){b[c]={originalFileName:a.name,attachmentName:a.attachmentName,attachmentSize:a.attachmentSize+'',attachmentSuffix:a.attachmentSuffix,attachmentId:a.attachmentId};}),b;}}]},f.startDate='',f.$startDateOpts={calendarId:i,onClickDate:function(a){f.startDate=d(a).format('YYYY-MM-DD'),$(this.widgetElement).hide();}},f.openStartDateCalendar=function(){var g=$(this),e=a.getVm(i),c,h=g.offset();e?c=$(e.widgetElement):(c=$('<div ms-widget="calendar,$,$startDateOpts"></div>'),c.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(c[0],[f]),e=a.getVm(i),b.regGlobalMdExcept({element:c,handler:function(){c.hide();}})),f.startDate?e.focusDate=d(f.startDate,'YYYY-MM-DD')._d:e.focusDate=new Date(),c.css({top:h.top+g.outerHeight()-1,left:h.left}).show();},f.submit=function(){var i=a.getVm(o),h=a.getVm(g),d,j;i.validate()&&(j=function(){d=i.getFormData(),d.endTime=0,d.sponsor=m.id,d.remark='',d.plansSource='2',d.isSendSms=!1,d.isRemind=!1,d.remindTime=0,d.merchantId===0&&(d.merchantId=null),b.c2s({url:c.BASE_PATH+'fesPlan/saveFesPlan.do',type:'post',contentType:'application/json',data:e.stringify(d),success:function(a){a.flag&&b.alert({content:a.message,iconType:'success',onSubmit:function(){f.belongToRouteName==='work'?b.jumpPage('#/work/plan'):f.belongToRouteName==='frontend'&&b.jumpPage('#/frontend/home');}});}});},h.uploading?(b.showGlobalMask(),h.$unwatch('uploading'),h.$watch('uploading',function(a){a||(b.hideGlobalMask(),j(),h.$unwatch('uploading'));})):j());};});a.scan(r[0]),q.removeClass('fn-hide').removeAttr('ms-skip'),a.scan(q[0],[a.getVm(g)]),s();},$remove:function(m,b){var e=b+'-start-hour',f=b+'-start-minute',g=b+'-project',d=b+'-plan-item-type',i=b+'communication-form-type',j=b+'-attach-uploader',k=b+'-form',l=b+'-assigner',h=b+'-start-date',c=a.getVm(h);c&&$(c.widgetElement).remove(),$(a.getVm(j).widgetElement).remove(),$(a.getVm(g).widgetElement).remove(),$(a.getVm(d).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(f).widgetElement).remove(),$(a.getVm(e).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),$(a.getVm(k).widgetElement).remove();}}),f;});

//From origin\page\work\plan\list\list.js
define('originpageworkplanlistlistjs',['avalon','util','moment','json','originwidgetcalendarcalendarjs'],function(b,d,a,f){var g=this,c=g.erp,e={};return _.extend(e,{$init:function(n,j,g){function k(){g.params.id?d.c2s({url:c.BASE_PATH+'fesPlan/queryFesPlanById.do',type:'post',contentType:'application/json',data:f.stringify({planId:g.params.id/1}),success:function(d){var b;d.flag&&(b=d.data,e.planList=[{statusText:l(b.status),status:b.status,dateIndex:a(b.start_time).format('YYYY-MM-DD HH:mm'),sponsor:b.sponsor_name,merchantName:b.merchant_name,title:b.title,description:b.description,explanation:b.explanation,attachmentList:_.map(b.attachmentList,function(a){return a.downloadUrl=c.BASE_PATH+'fesOnlineProcess/download.do?relPath='+b.planFilePath+'/'+a.attachment_name,a;})}]);}}):d.c2s({url:c.BASE_PATH+'fesPlan/queryDailyFesPlanList.do',type:'post',contentType:'application/json',data:f.stringify({userId:m.id,startTime:e.currentDate/1,endTime:a(e.currentDate).add('days',1).subtract('seconds',1)/1}),success:function(b){var d;b.flag&&(d=b.data,e.planList=_.map(d,function(b){return{statusText:l(b.status),status:b.status,dateIndex:a(b.start_time).format('YYYY-MM-DD HH:mm'),sponsor:b.sponsor_name,merchantName:b.merchant_name,title:b.title,description:b.description,explanation:b.explanation,attachmentList:_.map(b.attachmentList,function(a){return a.downloadUrl=c.BASE_PATH+b.planFilePath+'/'+a.attachment_name,a;})};}));}});}function l(b){var a='';switch(b){case'1':a='\u672A\u5B8C\u6210';break;case'2':a='\u5DF2\u5EF6\u671F';break;case'3':a='\u5DF2\u653E\u5F03';break;case'4':a='\u5DF2\u5B8C\u6210';break;case'5':a='\u5DF2\u6C42\u52A9';break;default:break;}return a;}var h=j+'-current-date-calendar',i=new Date(),m=c.getAppData('user'),e=b.define(j,function(c){c.belongToRouteName=g.route.split('/')[1],c.belongToRouteName==='work'?c.navCrumbs=[{text:'\u5DE5\u4F5C\u8BA1\u5212',href:'#/work/plan'},{text:'\u5DE5\u4F5C\u5217\u8868'}]:c.belongToRouteName==='frontend'?c.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u5DE5\u4F5C\u5217\u8868'}]:c.belongToRouteName==='sales'&&(c.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/sales/home'},{text:'\u5DE5\u4F5C\u5217\u8868'}]),c.viewType=g.params.id?'single':'list',c.currentDate=a(g.params.date/1)._d,c.planList=[],c.$currentDateOpts={calendarId:h,onClickDate:function(a){c.currentDate=a,$(this.widgetElement).hide();}},c.openCurrentDateCalendar=function(){var f=$(this),e=b.getVm(h),a,g=f.offset();e?a=$(e.widgetElement):(a=$('<div ms-widget="calendar,$,$currentDateOpts"></div>'),a.css({position:'absolute','z-index':10000}).hide().appendTo('body'),b.scan(a[0],[c]),e=b.getVm(h),d.regGlobalMdExcept({element:a,handler:function(){a.hide();}})),c.currentDate?e.focusDate=c.currentDate:e.focusDate=i,a.css({top:g.top+f.outerHeight()-1,left:g.left-(a.outerWidth()-f.outerWidth())}).show();},c.navPrev=function(){c.currentDate=a(c.currentDate).subtract('days',1)._d;},c.navNext=function(){c.currentDate=a(c.currentDate).add('days',1)._d;},c.navToday=function(){c.currentDate=a(i).hour(0).minute(0).second(0)._d;};});b.scan(n[0]),k(),e.$watch('currentDate',function(){k();});},$remove:function(e,d){var c=d+'-current-date-calendar',a=b.getVm(c);a&&$(a.widget).remove();}}),e;});

//From origin\page\work\plan\plan-add-edit.js
define('originpageworkplanplanaddeditjs',['avalon','util','moment','json','events','originwidgetformformjs','originwidgetformselectjs','originwidgetuploaderuploaderjs','originwidgetcalendarcalendarjs'],function(a,b,c,e,i){var h=this,d=h.erp,g={},f=new i();return _.extend(g,{$init:function(B,g,l){function E(){var c=a.getVm(o),e=a.getVm(p);b.c2s({url:d.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000063',success:function(a){var b;a.flag&&(b=a.data,c.setOptions([{text:'\u8BF7\u9009\u62E9',value:0}].concat(_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}))),s.planItemType=!0,_.every(s,function(a){return a;})&&f.trigger('cptInited'));}}),b.c2s({url:d.BASE_PATH+'dictionary/querySysDictionaryByType.do',type:'post',data:'dictionaryType=00000064',success:function(a){var b;a.flag&&(b=a.data,e.setOptions([{text:'\u8BF7\u9009\u62E9',value:0}].concat(_.map(b,function(a){return{text:a.dictionary_value,value:a.dictionary_key};}))),s.communicationFormType=!0,_.every(s,function(a){return a;})&&f.trigger('cptInited'));}});}function C(c){var e=a.getVm(r);b.c2s({url:d.BASE_PATH+'synMerchant/getSynMerchantByUserId.do',type:'get',contentType:'application/json',data:{userId:h.userId},success:function(a){var b;a.flag&&(b=a.data,e.setOptions([{text:'\u8BF7\u9009\u62E9',value:-1}].concat(_.map(b,function(a){return{text:a.merchant_name,value:a.merchant_id};})).concat({text:'\u5176\u5B83',value:0})),c&&c());}});}function D(f){b.c2s({url:d.BASE_PATH+'fesPlan/queryFesPlanById.do',type:'post',contentType:'application/json',data:e.stringify({planId:l.params.id/1}),success:function(g){var e;g.flag&&(e=g.data,h.userId=e.user_id,h.currentDate=c(e.start_time)._d,h.originCurrentDate=c(e.start_time)._d,a.getVm(v).selectValue(c(e.start_time).hour()),a.getVm(u).selectValue(c(e.start_time).minute()),a.getVm(o).selectValue(e.plan_item_type),a.getVm(p).selectValue(e.communication_form_type),h.title=e.title,h.desc=e.description,h.isRemindOpen=e.is_remind,h.isRemindOpen&&(a.getVm(j).selectValue(c(e.remind_time).hour()),a.getVm(i).remindDate=c(e.remind_time).format('YYYY-MM-DD')),a.getVm(k).uploadList=_.map(e.attachmentList,function(a){return{name:a.original_file_name,attachmentName:a.attachment_name,attachmentSize:a.attachment_size,attachmentSuffix:a.attachment_suffix,attachmentId:a.id,id:b.generateID(),uploaded:!0,downloadUrl:d.BASE_PATH+'fesOnlineProcess/download.do?relPath='+e.planFilePath+'/'+a.attachment_name};}),h.titleReadonly=e.sponsor==m.id?!1:!0,f&&f(e));}});}var v=g+'-start-hour',u=g+'-start-minute',r=g+'-project',o=g+'-plan-item-type',p=g+'communication-form-type',k=g+'-attach-uploader',z=g+'-form',i=g+'-remind-dialog',j=g+'-remind-time-selector',q=g+'-reason-dialog',n=g+'-reason-form',y=g+'-un-complete-selector',w=g+'-expect-date-calendar',A=g+'-expect-time-selector',t=g+'-remind-date-calendar',m=d.getAppData('user'),x=$('.upload-info',B),h=a.define(g,function(f){f.belongToRouteName=l.route.split('/')[1],f.belongToRouteName==='work'?f.navCrumbs=[{text:'\u5DE5\u4F5C\u8BA1\u5212',href:'#/work/plan'},{text:'\u6DFB\u52A0\u8BA1\u5212'}]:f.belongToRouteName==='frontend'?f.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/frontend/home'},{text:'\u6DFB\u52A0\u8BA1\u5212'}]:f.belongToRouteName==='sales'&&(f.navCrumbs=[{text:'\u6211\u7684\u4E3B\u9875',href:'#/sales/home'},{text:'\u6DFB\u52A0\u8BA1\u5212'}]),f.formState=g.split('-').pop(),f.userId=f.formState==='add'?m.id:0,f.isRemindOpen=!1,f.$watch('isRemindOpen',function(d){var b=a.getVm(i),c=a.getVm(j);d?f.remindTime=b.remindDate+' '+c.selectedText:f.remindTime='';}),f.remindTime='',f.currentDate=c(l.params.date/1)._d,f.unCompleteState='view',f.$unCompleteOpts={selectId:y,options:[{text:'\u8BF7\u9009\u62E9',value:''},{text:'\u653E\u5F03',value:'giveup'},{text:'\u5EF6\u65F6',value:'delay'}],onSelect:function(c,d){var b=a.getVm(q);c&&(b.title=d,b.state=c,b.reasonLabel='\u8BF7\u8BF4\u660E'+d+'\u5DE5\u4F5C\u7684\u539F\u56E0',b.open()),f.unCompleteState='view';}},f.$startHourOpts={selectId:v,options:_.map(_.range(0,24),function(a){return{text:_.str.lpad(a,2,'0'),value:a};}),selectedIndex:9,onSelect:function(){f.adjustCurrentDate();}},f.$startMinuteOpts={selectId:u,options:_.map(_.range(0,60),function(a){return{text:_.str.lpad(a,2,'0'),value:a};}),onSelect:function(){f.adjustCurrentDate();}},f.$projectOpts={selectId:r,options:[]},f.$planItemTypeOpts={selectId:o,options:[]},f.$communicationFormTypeOpts={selectId:p,options:[]},f.$attachUploaderOpts={uploaderId:k,uploadifyOpts:{uploader:d.BASE_PATH+'fesPlan/uploadPlanFiles.do',fileObjName:'myfiles',multi:!0,fileTypeDesc:'\u4E0A\u4F20\u9644\u4EF6(*.*)',fileTypeExts:'*.*',fileSizeLimit:'20MB',formData:{sessionId:m.sessionId},width:116,height:30},defaultExtKeyData:{originalFileName:'',attachmentName:'',attachmentSize:'',attachmentSuffix:''},onSuccessResponseData:function(d,c){var b=e.parse(d),a={};return b.flag&&(a.originalFileName=b.data[0].originalFileName,a.attachmentName=b.data[0].fileName,a.attachmentSize=c.fileSize+'',a.attachmentSuffix=c.type.slice(1)),a;},removeItem:function(){var b=this.$vmodel.$model,c=b.el.id;a.getVm(k).removeFile(c);}},f.$formOpts={formId:z,field:[{selector:'.start-time',name:'startTime',getValue:function(){return f.currentDate/1;}},{selector:'.project',name:'merchantId',getValue:function(){return a.getVm(r).selectedValue;},rule:function(a){return a===-1?'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u9879\u76EE':!0;}},{selector:'.plan-item-type',name:'planItemType',getValue:function(){return a.getVm(o).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u4E8B\u9879\u7C7B\u578B';}},{selector:'.communication-form-type',name:'communicationFormType',getValue:function(){return a.getVm(p).selectedValue;},rule:function(a){return a?!0:'\u8BF7\u9009\u62E9\u5BF9\u5E94\u7684\u6C9F\u901A\u65B9\u5F0F';}},{selector:'.title',name:'title',rule:['noempty',function(a,b){return b[0]!==!0?'\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A':a.length>20?'\u6807\u9898\u4E0D\u80FD\u8D85\u8FC720\u4E2A\u5B57\u7B26':!0;}]},{selector:'.desc',name:'description'},{selector:'.attach-uploader',name:'attachmentList',reset:function(){var b=a.getVm(k);f.formState=='add'&&b.removeAllFile();},getValue:function(){var c=a.getVm(k),d=c.uploadList,b=[];return _.each(d.$model,function(a,c){b[c]={originalFileName:a.name,attachmentName:a.attachmentName,attachmentSize:a.attachmentSize+'',attachmentSuffix:a.attachmentSuffix,attachmentId:a.attachmentId};}),b;}}]},f.$remindDialogOpts={dialogId:i,title:'\u63D0\u9192',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){f.isRemindOpen||(a.getVm(j).select(0),a.getVm(i).remindDate=c(f.currentDate).format('YYYY-MM-DD'));},remindDate:c(f.currentDate).format('YYYY-MM-DD'),$remindDateOpts:{calendarId:t,onClickDate:function(e){var b=a.getVm(j),d=new Date();a.getVm(i).remindDate=c(e).format('YYYY-MM-DD'),c(e).isSame(d,'day')?b.setOptions(_.map(_.range(c(d).hour()+1,24),function(a){return{text:_.str.lpad(a,2,'0')+':'+'00',value:a};})):b.setOptions(_.map(_.range(0,24),function(a){return{text:_.str.lpad(a,2,'0')+':'+'00',value:a};})),$(this.widgetElement).hide();}},openRemindCalendar:function(){var g=$(this),d=a.getVm(t),e,j=g.offset(),f=a.getVm(i),k=new Date();d?e=$(d.widgetElement):(e=$('<div ms-widget="calendar,$,$remindDateOpts"></div>'),e.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(e[0],[f]),d=a.getVm(t),b.regGlobalMdExcept({element:e,handler:function(){e.hide();}})),f.remindDate?d.focusDate=c(f.remindDate,'YYYY-MM-DD')._d:d.focusDate=k,d.minDate=k,d.maxDate=h.currentDate,e.css({top:j.top+g.outerHeight()-1,left:j.left}).show();},$remindTimeOpts:{selectId:j,options:_.map(_.range(0,24),function(a){return{text:_.str.lpad(a,2,'0')+':'+'00',value:a};})},submit:function(m){var g=a.getVm(i),k=a.getVm(j),h;f.formState==='add'?(f.isRemindOpen=!0,g.close()):f.formState==='edit'&&(h={},_.extend(h,{planId:l.params.id/1,isRemind:!f.isRemindOpen,isSendSms:!1,remindTime:f.isRemindOpen?0:c(g.remindDate+' '+k.selectedValue,'YYYY-MM-DD H')/1}),b.c2s({url:d.BASE_PATH+'fesPlan/updateRemindFesPlanById.do',type:'post',contentType:'application/json',data:e.stringify(h),success:function(a){a.flag&&(b.alert({content:a.message,iconType:'success'}),f.isRemindOpen=!0,g.close());}}));}},f.$reasonDialogOpts={dialogId:q,title:'',state:'',reasonLabel:'',getTemplate:function(c){var a=c.split('MS_OPTION_FOOTER'),b='<div class="ui-dialog-footer fn-clear"><div class="ui-dialog-btns"><button type="button" class="submit-btn ui-dialog-btn" ms-click="submit">\u786E&nbsp;\u5B9A</button><span class="separation"></span><button type="button" class="cancel-btn ui-dialog-btn" ms-click="close">\u53D6&nbsp;\u6D88</button></div></div>';return a[0]+'MS_OPTION_FOOTER'+b;},onClose:function(){var b=a.getVm(n);b.reset(),b.expectDate='';},submit:function(m){var g=a.getVm(q),j=a.getVm(n),k=a.getVm(A),h,i;j.validate()&&(h=j.getFormData(),g.state==='giveup'?i=d.BASE_PATH+'fesPlan/updateAbandonFesPlanById.do':g.state==='delay'?(i=d.BASE_PATH+'fesPlan/updateDelayFesPlanById.do',_.extend(h,{startTime:c(h.startTime+' '+k.selectedValue,'YYYY-MM-DD H')/1})):g.state=='complete'&&(i=d.BASE_PATH+'fesPlan/updateCompleteFesPlanById.do'),_.extend(h,{planId:l.params.id/1}),b.c2s({url:i,type:'post',contentType:'application/json',data:e.stringify(h),success:function(a){a.flag&&(b.alert({content:a.message,iconType:'success',onSubmit:function(){f.belongToRouteName==='work'?b.jumpPage('#/work/plan'):f.belongToRouteName==='frontend'?b.jumpPage('#/frontend/home'):f.belongToRouteName==='sales'&&b.jumpPage('#/sales/home');}}),g.close());}}));}},f.$reasonFormOpts={formId:n,expectDate:'',$expectDateOpts:{calendarId:w,onClickDate:function(b){a.getVm(n).expectDate=c(b).format('YYYY-MM-DD'),$(this.widgetElement).hide();},minDate:f.currentDate},$expectTimeOpts:{selectId:A,options:_.map(_.range(0,24),function(a){return{text:_.str.lpad(a,2,'0')+':'+'00',value:a};})},openExpectCalendar:function(){var g=$(this),d=a.getVm(w),e,i=g.offset(),f=a.getVm(n);d?e=$(d.widgetElement):(e=$('<div ms-widget="calendar,$,$expectDateOpts"></div>'),e.css({position:'absolute','z-index':10000}).hide().appendTo('body'),a.scan(e[0],[f]),d=a.getVm(w),b.regGlobalMdExcept({element:e,handler:function(){e.hide();}})),f.expectDate?d.focusDate=c(f.expectDate,'YYYY-MM-DD')._d:d.focusDate=new Date(),d.minDate=c(h.currentDate).add('days',1)._d,e.css({top:i.top+g.outerHeight()-1,left:i.left}).show();},field:[{selector:'.reason',name:'explanation',rule:['noempty',function(b,a){return a[0]!==!0?'\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A':!0;}]},{selector:'.expect-date',name:'startTime',rule:['noempty',function(b,a){return a[0]!==!0?'\u9884\u671F\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A':!0;}]}]},f.titleReadonly=!1,f.title='',f.desc='',f.adjustCurrentDate=function(){var b=a.getVm(v).selectedValue,d=a.getVm(u).selectedValue;f.currentDate=c(f.currentDate).hour(b).minute(d)._d;},f.setUnComplete=function(){var b=a.getVm(y);b.select(0),f.unCompleteState='edit',b.open();},f.setComplete=function(){var b=a.getVm(q);f.unCompleteState='view',b.title='\u5B8C\u6210',b.state='complete',b.reasonLabel='\u8BF7\u8BF4\u660E\u5B8C\u6210\u5DE5\u4F5C\u7684\u60C5\u51B5',b.open();},f.clickRemindSetting=function(){var g;f.isRemindOpen?f.formState==='edit'?b.confirm({iconType:'info',content:'\u60A8\u786E\u5B9A\u8981\u5173\u95ED\u5DE5\u4F5C\u8BA1\u5212\u63D0\u9192\u5417\uFF1F',onSubmit:function(){g={planId:l.params.id/1,isRemind:!1,isSendSms:!1,remindTime:0},b.c2s({url:d.BASE_PATH+'fesPlan/updateRemindFesPlanById.do',type:'post',contentType:'application/json',data:e.stringify(g),success:function(d){d.flag&&(b.alert({content:d.message,iconType:'success'}),f.isRemindOpen=!1,a.getVm(i).remindDate=c(f.currentDate).format('YYYY-MM-DD'),a.getVm(j).select(0));}});}}):f.formState==='add'&&(f.isRemindOpen=!1,a.getVm(i).remindDate=c(f.currentDate).format('YYYY-MM-DD'),a.getVm(j).select(0)):a.getVm(i).open();},f.submit=function(){var n=a.getVm(z),q=a.getVm(j),h=a.getVm(k),g,o,p;n.validate()&&(p=function(){g=n.getFormData(),g.isRemind=f.isRemindOpen,f.isRemindOpen?g.remindTime=c(a.getVm(i).remindDate+' '+q.selectedValue,'YYYY-MM-DD H')/1:g.remindTime=0,g.endTime=0,g.sponsor=m.id,g.userId=m.id,g.remark='',g.plansSource='1',g.isSendSms=!1,g.merchantId===0&&(g.merchantId=null),f.formState==='add'?o=d.BASE_PATH+'fesPlan/saveFesPlan.do':f.formState==='edit'&&(o=d.BASE_PATH+'fesPlan/updateFesPlan.do',g.planId=l.params.id/1),b.c2s({url:o,type:'post',contentType:'application/json',data:e.stringify(g),success:function(a){a.flag&&b.alert({content:a.message,iconType:'success',onSubmit:function(){f.belongToRouteName==='work'?b.jumpPage('#/work/plan'):f.belongToRouteName==='frontend'?b.jumpPage('#/frontend/home'):f.belongToRouteName==='sales'&&b.jumpPage('#/sales/home');}});}});},h.uploading?(b.showGlobalMask(),h.$unwatch('uploading'),h.$watch('uploading',function(a){a||(b.hideGlobalMask(),p(),h.$unwatch('uploading'));})):p());};});a.scan(B[0]),x.removeClass('fn-hide').removeAttr('ms-skip'),a.scan(x[0],[a.getVm(k)]);var s={planItemType:!1,communicationFormType:!1};f.on('cptInited',function(){h.formState==='edit'?D(function(b){C(function(){a.getVm(r).selectValue(b.merchant_id);});}):C();}),E();},$remove:function(w,b){var u=b+'-start-hour',v=b+'-start-minute',h=b+'-project',i=b+'-plan-item-type',j=b+'communication-form-type',k=b+'-attach-uploader',l=b+'-form',m=b+'-remind-dialog',n=b+'-remind-time-selector',o=b+'-reason-dialog',p=b+'-reason-form',q=b+'-un-complete-selector',r=b+'-expect-date-calendar',s=b+'-expect-time-selector',t=b+'-remind-date-calendar',e=a.getVm(r),g=a.getVm(s),d=a.getVm(q),c=a.getVm(t);e&&$(e.widgetElement).remove(),g&&$(g.widgetElement).remove(),d&&$(d.widgetElement).remove(),c&&$(c.widgetElement).remove(),$(a.getVm(p).widgetElement).remove(),$(a.getVm(o).widgetElement).remove(),$(a.getVm(n).widgetElement).remove(),$(a.getVm(m).widgetElement).remove(),$(a.getVm(k).widgetElement).remove(),$(a.getVm(h).widgetElement).remove(),$(a.getVm(i).widgetElement).remove(),$(a.getVm(j).widgetElement).remove(),$(a.getVm(v).widgetElement).remove(),$(a.getVm(u).widgetElement).remove(),$(a.getVm(l).widgetElement).remove(),f.off('cptInited');}}),g;});

//From origin\page\work\plan\plan.js
define('originpageworkplanplanjs',['avalon','util','moment','json','originmodulescheduleschedulejs'],function(c,a,b,g){var f=this,d=f.erp,e={};return _.extend(e,{$init:function(j,e){var f=d.getAppData('user'),h=new Date(),i=e+'-schedule',k=c.define(e,function(c){c.$scheduleOpts={scheduleId:i,onFetchPlan:function(c,b){a.c2s({url:d.BASE_PATH+'fesPlan/queryFesPlanList.do',type:'post',contentType:'application/json',data:g.stringify(_.extend({userId:f.id},c)),success:function(a){var c;a.flag?(c=a.data,b(c)):b([]);}});},onClickDateCell:function(f){var e=this.$vmodel.$model,d=e.el.date,c=$(f.target);b(d).isBefore(h,'day')?c.is('.plan-item')?a.jumpPage('#/work/plan/list/'+b(d)/1+'/'+c.data('planId')):a.jumpPage('#/work/plan/list/'+b(d)/1):c.is('.plan-item')?c.data('status')=='3'||c.data('status')=='4'||c.data('status')=='2'||c.data('status')=='5'?a.jumpPage('#/work/plan/list/'+b(d)/1+'/'+c.data('planId')):a.jumpPage('#/work/plan/edit/'+b(d).hour(9)/1+'/'+c.data('planId')):a.jumpPage('#/work/plan/add/'+b(d).hour(9)/1);}};});c.scan(j[0]);},$remove:function(d,b){var a=b+'-schedule';$(c.getVm(a).widgetElement).remove();}}),e;});

